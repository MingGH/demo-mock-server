<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åç›´è§‰æ¦‚ç‡è®º II - æ›´å¤šè®©äººå›°æƒ‘çš„æ¦‚ç‡æ‚–è®º</title>
  <script src="../components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      padding: 20px;
      color: #fff;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .back-link {
      display: inline-block;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      margin-bottom: 15px;
      font-size: 0.9rem;
    }
    .back-link:hover { text-decoration: underline; }
    h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 2rem;
      background: linear-gradient(135deg, #f5af19, #f12711, #f5af19);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 3s ease infinite;
    }
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .subtitle {
      text-align: center;
      color: rgba(255,255,255,0.7);
      margin-bottom: 30px;
      font-size: 1rem;
      line-height: 1.6;
    }
    .nav-tabs {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 25px;
    }
    .nav-tab {
      padding: 10px 20px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 25px;
      color: rgba(255,255,255,0.8);
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.9rem;
    }
    .nav-tab:hover, .nav-tab.active {
      background: linear-gradient(135deg, #f5af19, #f12711);
      border-color: transparent;
      color: white;
      transform: translateY(-2px);
    }
    .card {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 25px;
      border: 1px solid rgba(255,255,255,0.1);
      display: none;
    }
    .card.active { display: block; }
    .card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    .card-icon { font-size: 2.5rem; }
    .card-title {
      font-size: 1.5rem;
      background: linear-gradient(135deg, #f5af19, #f12711);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .card-subtitle {
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      margin-top: 5px;
    }
    .question-box {
      background: linear-gradient(135deg, rgba(245,175,25,0.15), rgba(241,39,17,0.1));
      border-left: 4px solid #f5af19;
      padding: 20px;
      border-radius: 0 15px 15px 0;
      margin-bottom: 25px;
      line-height: 1.8;
    }
    .question-box strong { color: #f5af19; }
    .interactive-area {
      background: rgba(0,0,0,0.2);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
    }
    .btn {
      padding: 12px 28px;
      border: none;
      border-radius: 25px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
    }
    .btn-primary {
      background: linear-gradient(135deg, #f5af19, #f12711);
      color: white;
    }
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(245,175,25,0.3);
    }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-group {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .stat-box {
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      padding: 18px;
      text-align: center;
    }
    .stat-value {
      font-size: 2rem;
      font-weight: bold;
      color: #f5af19;
    }
    .stat-value.green { color: #4ade80; }
    .stat-value.red { color: #f87171; }
    .stat-value.blue { color: #60a5fa; }
    .stat-label {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.5);
      margin-top: 5px;
    }
    .explanation {
      background: rgba(255,255,255,0.03);
      border-radius: 15px;
      padding: 25px;
      margin-top: 25px;
    }
    .explanation h3 {
      color: #f5af19;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .explanation p {
      color: rgba(255,255,255,0.85);
      line-height: 1.9;
      margin-bottom: 12px;
    }
    .formula {
      background: rgba(255,255,255,0.08);
      padding: 15px 20px;
      border-radius: 10px;
      font-family: 'Courier New', monospace;
      margin: 15px 0;
      overflow-x: auto;
      border-left: 3px solid #f5af19;
    }
    .highlight { color: #f87171; font-weight: bold; }
    .success { color: #4ade80; font-weight: bold; }

    /* éª°å­æ ·å¼ */
    .dice-arena {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin: 25px 0;
      flex-wrap: wrap;
    }
    .dice-group {
      text-align: center;
    }
    .dice {
      width: 80px;
      height: 80px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: bold;
      margin: 10px auto;
      transition: all 0.3s;
      cursor: pointer;
    }
    .dice-a { background: linear-gradient(135deg, #ef4444, #dc2626); }
    .dice-b { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .dice-c { background: linear-gradient(135deg, #22c55e, #16a34a); }
    .dice-label { font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-top: 5px; }
    .dice-faces { font-size: 0.75rem; color: rgba(255,255,255,0.5); }
    .vs-text { font-size: 1.5rem; color: #f5af19; align-self: center; font-weight: bold; }

    /* å®¶åº­æ¨¡æ‹Ÿ */
    .family-display {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    .child-icon {
      font-size: 2.5rem;
      padding: 10px;
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      min-width: 60px;
      text-align: center;
    }

    /* æ£€æµ‹æ‚–è®º */
    .population-grid {
      display: grid;
      grid-template-columns: repeat(20, 1fr);
      gap: 3px;
      margin: 20px 0;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
    .person-dot {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      transition: all 0.3s;
    }
    .person-dot.sick { background: #ef4444; }
    .person-dot.false-positive { background: #f59e0b; }
    .person-dot.true-negative { background: #22c55e; }

    /* é›†é½é—®é¢˜ */
    .coupon-display {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    .coupon {
      width: 50px;
      height: 50px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: all 0.3s;
      background: rgba(255,255,255,0.08);
      border: 2px solid rgba(255,255,255,0.1);
    }
    .coupon.collected {
      background: linear-gradient(135deg, #f5af19, #f12711);
      border-color: transparent;
      transform: scale(1.1);
    }

    /* ç¡ç¾äºº */
    .timeline {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .timeline-node {
      padding: 10px 15px;
      border-radius: 10px;
      font-size: 0.85rem;
      text-align: center;
      min-width: 80px;
    }
    .timeline-arrow {
      color: rgba(255,255,255,0.4);
      font-size: 1.2rem;
    }
    .timeline-node.coin { background: rgba(245,175,25,0.3); border: 1px solid #f5af19; }
    .timeline-node.wake { background: rgba(96,165,250,0.3); border: 1px solid #60a5fa; }
    .timeline-node.sleep { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); }

    .conclusion-box {
      background: linear-gradient(135deg, rgba(245,175,25,0.15), rgba(241,39,17,0.1));
      border: 2px solid rgba(245,175,25,0.3);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      margin-top: 25px;
    }
    .conclusion-box h3 { color: #f5af19; margin-bottom: 15px; }
    .conclusion-box p { color: rgba(255,255,255,0.9); line-height: 1.8; }

    @media (max-width: 600px) {
      .card { padding: 20px; }
      .card-title { font-size: 1.2rem; }
      .dice-arena { gap: 15px; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .population-grid { grid-template-columns: repeat(10, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-link"><i class="ti ti-arrow-left"></i> è¿”å›é¦–é¡µ</a>
    <h1><i class="ti ti-brain"></i> åç›´è§‰æ¦‚ç‡è®º II</h1>
    <p class="subtitle">äº”ä¸ªæ–°çš„æ¦‚ç‡æ‚–è®ºï¼Œæ¯ä¸€ä¸ªéƒ½ä¼šè®©ä½ æ€€ç–‘è‡ªå·±çš„ç›´è§‰<br>å…¨éƒ¨é…æœ‰äº¤äº’å¼æ¨¡æ‹Ÿï¼Œçœ¼è§ä¸ºå®</p>

    <div class="nav-tabs">
      <div class="nav-tab active" data-tab="nontransitive"><i class="ti ti-dice-3"></i> éä¼ é€’éª°å­</div>
      <div class="nav-tab" data-tab="boyorgirl"><i class="ti ti-gender-bigender"></i> ç”·å­©å¥³å­©æ‚–è®º</div>
      <div class="nav-tab" data-tab="falsepositive"><i class="ti ti-test-pipe"></i> æ£€æµ‹æ‚–è®º</div>
      <div class="nav-tab" data-tab="coupon"><i class="ti ti-ticket"></i> é›†é½é—®é¢˜</div>
      <div class="nav-tab" data-tab="sleepingbeauty"><i class="ti ti-moon-stars"></i> ç¡ç¾äººé—®é¢˜</div>
    </div>

    <!-- 1. éä¼ é€’éª°å­ -->
    <div class="card active" id="nontransitive">
      <div class="card-header">
        <div class="card-icon"><i class="ti ti-dice-3"></i></div>
        <div>
          <div class="card-title">éä¼ é€’éª°å­</div>
          <div class="card-subtitle">Aèµ¢Bï¼ŒBèµ¢Cï¼ŒCå´èµ¢A â€” çŸ³å¤´å‰ªåˆ€å¸ƒçš„æ¦‚ç‡ç‰ˆ</div>
        </div>
      </div>

      <div class="question-box">
        <strong>è®¾å®šï¼š</strong>ä¸‰é¢—ç‰¹æ®Šéª°å­ï¼š<br>
        éª°å­Aï¼šé¢å€¼ [2, 2, 4, 4, 9, 9]<br>
        éª°å­Bï¼šé¢å€¼ [1, 1, 6, 6, 8, 8]<br>
        éª°å­Cï¼šé¢å€¼ [3, 3, 5, 5, 7, 7]<br><br>
        <strong>ç›´è§‰ï¼š</strong>å¦‚æœAèµ¢Bï¼ŒBèµ¢Cï¼Œé‚£Aåº”è¯¥èµ¢Cå§ï¼Ÿ<br>
        <strong>çœŸç›¸ï¼š</strong>Aèµ¢Bï¼ˆ5/9ï¼‰ï¼ŒBèµ¢Cï¼ˆ5/9ï¼‰ï¼Œä½† <span class="highlight">Cèµ¢Aï¼ˆ5/9ï¼‰</span>ï¼
      </div>

      <div class="interactive-area">
        <div class="dice-arena">
          <div class="dice-group">
            <div class="dice dice-a" id="diceADisplay">?</div>
            <div class="dice-label">éª°å­A</div>
            <div class="dice-faces">[2,2,4,4,9,9]</div>
          </div>
          <div class="vs-text">VS</div>
          <div class="dice-group">
            <div class="dice dice-b" id="diceBDisplay">?</div>
            <div class="dice-label">éª°å­B</div>
            <div class="dice-faces">[1,1,6,6,8,8]</div>
          </div>
          <div class="vs-text">VS</div>
          <div class="dice-group">
            <div class="dice dice-c" id="diceCDisplay">?</div>
            <div class="dice-label">éª°å­C</div>
            <div class="dice-faces">[3,3,5,5,7,7]</div>
          </div>
        </div>

        <div style="text-align:center;margin-bottom:15px;">
          <label style="color:rgba(255,255,255,0.7);">å¯¹å†³ï¼š</label>
          <select id="diceMatchup" style="padding:8px 15px;border-radius:8px;background:rgba(0,0,0,0.3);color:white;border:1px solid rgba(255,255,255,0.2);">
            <option value="ab">A vs B</option>
            <option value="bc">B vs C</option>
            <option value="ca">C vs A</option>
          </select>
        </div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="diceTotal">0</div>
            <div class="stat-label">æ€»å¯¹å±€</div>
          </div>
          <div class="stat-box">
            <div class="stat-value green" id="diceLeftWin">0</div>
            <div class="stat-label" id="diceLeftLabel">Aèƒœ</div>
          </div>
          <div class="stat-box">
            <div class="stat-value red" id="diceRightWin">0</div>
            <div class="stat-label" id="diceRightLabel">Bèƒœ</div>
          </div>
          <div class="stat-box">
            <div class="stat-value blue" id="diceWinRate">-</div>
            <div class="stat-label" id="diceWinRateLabel">Aèƒœç‡</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="rollDice()"><i class="ti ti-dice-3"></i> æ·ä¸€æ¬¡</button>
          <button class="btn btn-secondary" onclick="rollDiceMany(1000)"><i class="ti ti-bolt"></i> æ·1000æ¬¡</button>
          <button class="btn btn-secondary" onclick="resetDice()"><i class="ti ti-refresh"></i> é‡ç½®</button>
        </div>
      </div>

      <div class="explanation">
        <h3><i class="ti ti-bulb"></i> ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</h3>
        <p>è¿™å«<span class="success">éä¼ é€’æ€§</span>ï¼ˆNontransitivityï¼‰ã€‚åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œ"æ¯”è¾ƒ"é€šå¸¸æ˜¯ä¼ é€’çš„ï¼šå¦‚æœå°æ˜æ¯”å°çº¢é«˜ï¼Œå°çº¢æ¯”å°åˆšé«˜ï¼Œé‚£å°æ˜ä¸€å®šæ¯”å°åˆšé«˜ã€‚</p>
        <p>ä½†éª°å­æ¯”å¤§å°ä¸æ˜¯å•ä¸€ç»´åº¦çš„æ¯”è¾ƒï¼Œæ¯é¢—éª°å­çš„é¢å€¼åˆ†å¸ƒä¸åŒï¼Œå¯¼è‡´äº†å¾ªç¯å…‹åˆ¶å…³ç³»ã€‚</p>
        <div class="formula">
A vs B: Açš„9èƒ½èµ¢Bæ‰€æœ‰é¢ï¼ŒAçš„4èƒ½èµ¢Bçš„1 â†’ Aèµ¢çš„æ¦‚ç‡ = 5/9<br>
B vs C: Bçš„8èƒ½èµ¢Cçš„3,5,7ä¸­çš„ä¸¤ä¸ª... â†’ Bèµ¢çš„æ¦‚ç‡ = 5/9<br>
C vs A: Cçš„7èƒ½èµ¢Açš„2,4ï¼ŒCçš„5èƒ½èµ¢Açš„2,4 â†’ Cèµ¢çš„æ¦‚ç‡ = 5/9
        </div>
        <p><span class="highlight">æ²ƒä¼¦Â·å·´è²ç‰¹</span>æ›¾ç”¨éä¼ é€’éª°å­å’Œæ¯”å°”Â·ç›–èŒ¨ç©æ¸¸æˆï¼Œè®©ç›–èŒ¨å…ˆé€‰éª°å­ã€‚ç›–èŒ¨ç ”ç©¶äº†ä¸€ä¼šå„¿åè¯´ï¼š"ä½ å…ˆé€‰ã€‚"</p>
      </div>
    </div>

    <!-- 2. ç”·å­©å¥³å­©æ‚–è®º -->
    <div class="card" id="boyorgirl">
      <div class="card-header">
        <div class="card-icon"><i class="ti ti-gender-bigender"></i></div>
        <div>
          <div class="card-title">ç”·å­©å¥³å­©æ‚–è®º</div>
          <div class="card-subtitle">åŒæ ·æ˜¯"æœ‰ä¸€ä¸ªç”·å­©"ï¼Œæ¦‚ç‡å´ä¸åŒ</div>
        </div>
      </div>

      <div class="question-box">
        <strong>é—®é¢˜Aï¼š</strong>ä¸€ä¸ªå®¶åº­æœ‰ä¸¤ä¸ªå­©å­ï¼Œå·²çŸ¥<strong>è€å¤§æ˜¯ç”·å­©</strong>ï¼Œè€äºŒä¹Ÿæ˜¯ç”·å­©çš„æ¦‚ç‡ï¼Ÿ<br>
        <strong>ç­”æ¡ˆAï¼š</strong><span class="success">1/2</span>ï¼ˆå¾ˆç›´è§‚ï¼‰<br><br>
        <strong>é—®é¢˜Bï¼š</strong>ä¸€ä¸ªå®¶åº­æœ‰ä¸¤ä¸ªå­©å­ï¼Œå·²çŸ¥<strong>è‡³å°‘æœ‰ä¸€ä¸ªç”·å­©</strong>ï¼Œä¸¤ä¸ªéƒ½æ˜¯ç”·å­©çš„æ¦‚ç‡ï¼Ÿ<br>
        <strong>ç­”æ¡ˆBï¼š</strong><span class="highlight">1/3</span>ï¼ˆåç›´è§‰ï¼ï¼‰
      </div>

      <div class="interactive-area">
        <div style="text-align:center;margin-bottom:15px;">
          <label style="color:rgba(255,255,255,0.7);">æ¡ä»¶ï¼š</label>
          <select id="boygirlCondition" style="padding:8px 15px;border-radius:8px;background:rgba(0,0,0,0.3);color:white;border:1px solid rgba(255,255,255,0.2);" onchange="resetBoyGirl()">
            <option value="elder">è€å¤§æ˜¯ç”·å­©</option>
            <option value="atleast">è‡³å°‘æœ‰ä¸€ä¸ªç”·å­©</option>
          </select>
        </div>

        <div class="family-display" id="familyDisplay">
          <div class="child-icon">?</div>
          <div class="child-icon">?</div>
        </div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="bgTotal">0</div>
            <div class="stat-label">ç¬¦åˆæ¡ä»¶çš„å®¶åº­</div>
          </div>
          <div class="stat-box">
            <div class="stat-value green" id="bgBothBoys">0</div>
            <div class="stat-label">ä¸¤ä¸ªéƒ½æ˜¯ç”·å­©</div>
          </div>
          <div class="stat-box">
            <div class="stat-value blue" id="bgRate">-</div>
            <div class="stat-label">åŒç”·å­©æ¦‚ç‡</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="bgTheory">1/2</div>
            <div class="stat-label">ç†è®ºå€¼</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="simBoyGirl()"><i class="ti ti-dice-3"></i> æ¨¡æ‹Ÿä¸€æ¬¡</button>
          <button class="btn btn-secondary" onclick="simBoyGirlMany(5000)"><i class="ti ti-bolt"></i> æ¨¡æ‹Ÿ5000æ¬¡</button>
          <button class="btn btn-secondary" onclick="resetBoyGirl()"><i class="ti ti-refresh"></i> é‡ç½®</button>
        </div>
      </div>

      <div class="explanation">
        <h3><i class="ti ti-bulb"></i> ä¸ºä»€ä¹ˆ"è‡³å°‘ä¸€ä¸ªç”·å­©"å˜æˆäº†1/3ï¼Ÿ</h3>
        <p>ä¸¤ä¸ªå­©å­çš„æ‰€æœ‰å¯èƒ½ç»„åˆï¼ˆç­‰æ¦‚ç‡ï¼‰ï¼š</p>
        <div class="formula">
(ç”·,ç”·)  (ç”·,å¥³)  (å¥³,ç”·)  (å¥³,å¥³)
        </div>
        <p><strong>æ¡ä»¶A "è€å¤§æ˜¯ç”·å­©"ï¼š</strong>æ’é™¤åä¸¤ç§ â†’ å‰© (ç”·,ç”·)(ç”·,å¥³) â†’ åŒç”·æ¦‚ç‡ = 1/2</p>
        <p><strong>æ¡ä»¶B "è‡³å°‘ä¸€ä¸ªç”·å­©"ï¼š</strong>åªæ’é™¤(å¥³,å¥³) â†’ å‰© (ç”·,ç”·)(ç”·,å¥³)(å¥³,ç”·) â†’ åŒç”·æ¦‚ç‡ = <span class="highlight">1/3</span></p>
        <p>å…³é”®åŒºåˆ«ï¼šæ¡ä»¶Bä¿ç•™äº†æ›´å¤šçš„æ ·æœ¬ç©ºé—´ã€‚"è‡³å°‘ä¸€ä¸ªç”·å­©"æ˜¯æ¯”"è€å¤§æ˜¯ç”·å­©"æ›´å¼±çš„æ¡ä»¶ï¼Œæ‰€ä»¥åŒç”·å­©çš„æ¯”ä¾‹æ›´ä½ã€‚</p>
      </div>
    </div>

    <!-- 3. å‡é˜³æ€§æ‚–è®º -->
    <div class="card" id="falsepositive">
      <div class="card-header">
        <div class="card-icon"><i class="ti ti-test-pipe"></i></div>
        <div>
          <div class="card-title">å‡é˜³æ€§æ‚–è®ºï¼ˆæ£€æµ‹æ‚–è®ºï¼‰</div>
          <div class="card-subtitle">99%å‡†ç¡®ç‡çš„æ£€æµ‹ï¼Œé˜³æ€§ç»“æœå¯èƒ½åªæœ‰50%å¯ä¿¡</div>
        </div>
      </div>

      <div class="question-box">
        <strong>åœºæ™¯ï¼š</strong>æŸç½•è§ç—…å‘ç—…ç‡ 1%ã€‚æ£€æµ‹å‡†ç¡®ç‡ 99%ï¼ˆçµæ•åº¦99%ï¼Œç‰¹å¼‚åº¦99%ï¼‰ã€‚<br>
        ä½ æ£€æµ‹å‘ˆé˜³æ€§ï¼Œä½ çœŸçš„å¾—ç—…çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ<br><br>
        <strong>ç›´è§‰ç­”æ¡ˆï¼š</strong>99%ï¼Ÿ<br>
        <strong>çœŸå®ç­”æ¡ˆï¼š</strong><span class="highlight">åªæœ‰ 50%</span>ï¼
      </div>

      <div class="interactive-area">
        <div style="display:flex;gap:20px;flex-wrap:wrap;justify-content:center;margin-bottom:20px;">
          <div>
            <label style="color:rgba(255,255,255,0.7);font-size:0.9rem;">å‘ç—…ç‡</label><br>
            <input type="range" id="prevalence" min="0.1" max="10" step="0.1" value="1" style="width:150px;" oninput="updateFPDisplay()">
            <span id="prevalenceDisplay" style="color:#f5af19;font-weight:bold;">1%</span>
          </div>
          <div>
            <label style="color:rgba(255,255,255,0.7);font-size:0.9rem;">çµæ•åº¦</label><br>
            <input type="range" id="sensitivity" min="80" max="99.9" step="0.1" value="99" style="width:150px;" oninput="updateFPDisplay()">
            <span id="sensitivityDisplay" style="color:#4ade80;font-weight:bold;">99%</span>
          </div>
          <div>
            <label style="color:rgba(255,255,255,0.7);font-size:0.9rem;">ç‰¹å¼‚åº¦</label><br>
            <input type="range" id="specificity" min="80" max="99.9" step="0.1" value="99" style="width:150px;" oninput="updateFPDisplay()">
            <span id="specificityDisplay" style="color:#60a5fa;font-weight:bold;">99%</span>
          </div>
        </div>

        <div class="population-grid" id="populationGrid"></div>
        <div style="text-align:center;margin:10px 0;font-size:0.8rem;color:rgba(255,255,255,0.5);">
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#ef4444;margin-right:3px;vertical-align:middle;"></span>çœŸé˜³æ€§
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#f59e0b;margin:0 3px 0 15px;vertical-align:middle;"></span>å‡é˜³æ€§
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#22c55e;margin:0 3px 0 15px;vertical-align:middle;"></span>çœŸé˜´æ€§
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,0.15);margin:0 3px 0 15px;vertical-align:middle;"></span>æœªæ£€æµ‹
        </div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value red" id="fpTruePositive">-</div>
            <div class="stat-label">çœŸé˜³æ€§</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" style="color:#f59e0b;" id="fpFalsePositive">-</div>
            <div class="stat-label">å‡é˜³æ€§</div>
          </div>
          <div class="stat-box">
            <div class="stat-value blue" id="fpPPV">-</div>
            <div class="stat-label">é˜³æ€§é¢„æµ‹å€¼</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="simulateFP()"><i class="ti ti-test-pipe"></i> æ¨¡æ‹Ÿæ£€æµ‹</button>
          <button class="btn btn-secondary" onclick="simulateFPMany(10000)"><i class="ti ti-bolt"></i> æ£€æµ‹10000äºº</button>
          <button class="btn btn-secondary" onclick="resetFP()"><i class="ti ti-refresh"></i> é‡ç½®</button>
        </div>
      </div>

      <div class="explanation">
        <h3><i class="ti ti-bulb"></i> è´å¶æ–¯å®šç†çš„å¨åŠ›</h3>
        <p>å‡è®¾10000äººæ¥å—æ£€æµ‹ï¼š</p>
        <div class="formula">
çœŸæ­£æ‚£ç—…ï¼š10000 Ã— 1% = 100äºº<br>
å…¶ä¸­æ£€æµ‹é˜³æ€§ï¼ˆçœŸé˜³æ€§ï¼‰ï¼š100 Ã— 99% = 99äºº<br><br>
æ²¡æœ‰æ‚£ç—…ï¼š10000 Ã— 99% = 9900äºº<br>
å…¶ä¸­æ£€æµ‹é˜³æ€§ï¼ˆå‡é˜³æ€§ï¼‰ï¼š9900 Ã— 1% = <span class="highlight">99äºº</span><br><br>
æ€»é˜³æ€§ = 99 + 99 = 198äºº<br>
é˜³æ€§ä¸­çœŸæ­£æ‚£ç—… = 99 / 198 = <span class="highlight">50%</span>
        </div>
        <p>å…³é”®æ´å¯Ÿï¼šå½“ç–¾ç—…å¾ˆç½•è§æ—¶ï¼Œå¥åº·äººçš„åŸºæ•°è¿œå¤§äºæ‚£ç—…äººæ•°ã€‚å³ä½¿å‡é˜³æ€§ç‡å¾ˆä½ï¼ˆ1%ï¼‰ï¼Œä¹˜ä»¥å·¨å¤§çš„å¥åº·äººåŸºæ•°ï¼Œå‡é˜³æ€§çš„ç»å¯¹æ•°é‡ä¹Ÿå¾ˆå¤§ã€‚</p>
        <p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŒ»ç”Ÿé€šå¸¸ä¸å»ºè®®å¯¹ä½é£é™©äººç¾¤åšç½•è§ç—…ç­›æŸ¥ã€‚</p>
      </div>
    </div>

    <!-- 4. é›†é½é—®é¢˜ -->
    <div class="card" id="coupon">
      <div class="card-header">
        <div class="card-icon"><i class="ti ti-ticket"></i></div>
        <div>
          <div class="card-title">é›†é½ä¼˜æƒ åˆ¸é—®é¢˜</div>
          <div class="card-subtitle">é›†é½5ç§å¡ç‰‡å¹³å‡è¦ä¹°å¤šå°‘åŒ…ï¼Ÿç­”æ¡ˆæ¯”ä½ æƒ³çš„å¤šå¾—å¤š</div>
        </div>
      </div>

      <div class="question-box">
        <strong>é—®é¢˜ï¼š</strong>å¹²è„†é¢é‡Œæœ‰5ç§å¡ç‰‡ï¼Œæ¯åŒ…éšæœºä¸€å¼ ã€‚é›†é½æ‰€æœ‰5ç§å¹³å‡è¦ä¹°å¤šå°‘åŒ…ï¼Ÿ<br><br>
        <strong>ç›´è§‰ç­”æ¡ˆï¼š</strong>5åŒ…ï¼Ÿ10åŒ…ï¼Ÿ<br>
        <strong>çœŸå®ç­”æ¡ˆï¼š</strong><span class="highlight">çº¦ 11.42 åŒ…</span>ï¼
      </div>

      <div class="interactive-area">
        <div style="text-align:center;margin-bottom:15px;">
          <label style="color:rgba(255,255,255,0.7);">å¡ç‰‡ç§ç±»æ•°ï¼š</label>
          <input type="range" id="couponTypes" min="3" max="20" value="5" style="width:200px;vertical-align:middle;" oninput="updateCouponTheory()">
          <span id="couponTypesDisplay" style="font-size:1.5rem;font-weight:bold;color:#f5af19;margin-left:10px;">5</span>
        </div>

        <div class="coupon-display" id="couponDisplay"></div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="couponBought">0</div>
            <div class="stat-label">å·²è´­ä¹°</div>
          </div>
          <div class="stat-box">
            <div class="stat-value green" id="couponCollected">0</div>
            <div class="stat-label">å·²é›†é½</div>
          </div>
          <div class="stat-box">
            <div class="stat-value blue" id="couponAvg">-</div>
            <div class="stat-label">å¹³å‡è´­ä¹°æ•°</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="couponTheory">11.42</div>
            <div class="stat-label">ç†è®ºæœŸæœ›</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="buyCoupon()"><i class="ti ti-shopping-cart"></i> ä¹°ä¸€åŒ…</button>
          <button class="btn btn-secondary" onclick="collectAll()"><i class="ti ti-bolt"></i> é›†é½ä¸€æ¬¡</button>
          <button class="btn btn-secondary" onclick="collectAllMany(1000)"><i class="ti ti-bolt"></i> æ¨¡æ‹Ÿ1000æ¬¡</button>
          <button class="btn btn-secondary" onclick="resetCoupon()"><i class="ti ti-refresh"></i> é‡ç½®</button>
        </div>
      </div>

      <div class="explanation">
        <h3><i class="ti ti-bulb"></i> ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šï¼Ÿ</h3>
        <p>è¿™æ˜¯ç»å…¸çš„<span class="success">ä¼˜æƒ åˆ¸æ”¶é›†é—®é¢˜</span>ï¼ˆCoupon Collector's Problemï¼‰ã€‚</p>
        <p>å…³é”®åœ¨äºï¼šé›†é½æœ€åå‡ å¼ çš„éš¾åº¦è¿œå¤§äºå‰å‡ å¼ ã€‚</p>
        <div class="formula">
å·²æœ‰0å¼  â†’ ä¸‹ä¸€å¼ æ–°çš„æ¦‚ç‡ = 5/5 = 100%ï¼ŒæœŸæœ› 1 åŒ…<br>
å·²æœ‰1å¼  â†’ ä¸‹ä¸€å¼ æ–°çš„æ¦‚ç‡ = 4/5 = 80%ï¼ŒæœŸæœ› 1.25 åŒ…<br>
å·²æœ‰2å¼  â†’ ä¸‹ä¸€å¼ æ–°çš„æ¦‚ç‡ = 3/5 = 60%ï¼ŒæœŸæœ› 1.67 åŒ…<br>
å·²æœ‰3å¼  â†’ ä¸‹ä¸€å¼ æ–°çš„æ¦‚ç‡ = 2/5 = 40%ï¼ŒæœŸæœ› 2.5 åŒ…<br>
å·²æœ‰4å¼  â†’ ä¸‹ä¸€å¼ æ–°çš„æ¦‚ç‡ = 1/5 = 20%ï¼ŒæœŸæœ› <span class="highlight">5 åŒ…</span><br><br>
æ€»æœŸæœ› = 5Ã—(1/5 + 1/4 + 1/3 + 1/2 + 1/1) = 5 Ã— 2.283 â‰ˆ <span class="success">11.42 åŒ…</span>
        </div>
        <p>ä¸€èˆ¬å…¬å¼ï¼šnç§å¡ç‰‡çš„æœŸæœ›è´­ä¹°æ•° = n Ã— H(n)ï¼Œå…¶ä¸­ H(n) = 1 + 1/2 + 1/3 + ... + 1/n æ˜¯è°ƒå’Œçº§æ•°ã€‚</p>
        <p>å¦‚æœæ˜¯é›†é½<strong>108å¼ æ°´æµ’å¡</strong>ï¼ŸæœŸæœ›è¦ä¹°çº¦ <span class="highlight">569åŒ…</span>ã€‚</p>
      </div>
    </div>

    <!-- 5. ç¡ç¾äººé—®é¢˜ -->
    <div class="card" id="sleepingbeauty">
      <div class="card-header">
        <div class="card-icon"><i class="ti ti-moon-stars"></i></div>
        <div>
          <div class="card-title">ç¡ç¾äººé—®é¢˜</div>
          <div class="card-subtitle">å“²å­¦å®¶è‡³ä»Šäº‰è®ºä¸ä¼‘çš„æ¦‚ç‡éš¾é¢˜</div>
        </div>
      </div>

      <div class="question-box">
        <strong>å®éªŒï¼š</strong>å‘¨æ—¥æŠ›ä¸€æšå…¬å¹³ç¡¬å¸ã€‚<br>
        - å¦‚æœæ­£é¢ï¼šå‘¨ä¸€å«é†’ç¡ç¾äººï¼Œå®éªŒç»“æŸã€‚<br>
        - å¦‚æœåé¢ï¼šå‘¨ä¸€å«é†’å¥¹ï¼Œç»™å¥¹åƒé—å¿˜è¯ï¼Œå‘¨äºŒå†å«é†’å¥¹ã€‚<br><br>
        æ¯æ¬¡è¢«å«é†’æ—¶ï¼Œç¡ç¾äººä¸çŸ¥é“ä»Šå¤©æ˜¯å‘¨å‡ ã€‚<br>
        <strong>é—®é¢˜ï¼š</strong>è¢«å«é†’æ—¶ï¼Œå¥¹è®¤ä¸ºç¡¬å¸æ­£é¢æœä¸Šçš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ<br><br>
        <strong>1/2æ´¾ï¼š</strong>ç¡¬å¸æ˜¯å…¬å¹³çš„ï¼Œå½“ç„¶æ˜¯1/2ã€‚<br>
        <strong>1/3æ´¾ï¼š</strong>ä¸‰æ¬¡é†’æ¥ä¸­åªæœ‰ä¸€æ¬¡æ˜¯æ­£é¢ï¼Œæ‰€ä»¥æ˜¯1/3ã€‚
      </div>

      <div class="interactive-area">
        <div class="timeline">
          <div class="timeline-node coin" id="sbCoin">æŠ›ç¡¬å¸<br><span style="font-size:1.5rem;">ğŸª™</span></div>
          <div class="timeline-arrow">â†’</div>
          <div class="timeline-node wake" id="sbMon">å‘¨ä¸€é†’æ¥<br><span style="font-size:1.2rem;" id="sbMonIcon">ğŸ˜´</span></div>
          <div class="timeline-arrow" id="sbArrow2">â†’</div>
          <div class="timeline-node sleep" id="sbTue">å‘¨äºŒ<br><span style="font-size:1.2rem;" id="sbTueIcon">?</span></div>
        </div>

        <div style="text-align:center;min-height:40px;margin:15px 0;" id="sbMessage">ç‚¹å‡»æ¨¡æ‹Ÿå¼€å§‹å®éªŒ</div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="sbExperiments">0</div>
            <div class="stat-label">å®éªŒæ¬¡æ•°</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="sbWakeups">0</div>
            <div class="stat-label">æ€»é†’æ¥æ¬¡æ•°</div>
          </div>
          <div class="stat-box">
            <div class="stat-value green" id="sbHeadsWake">0</div>
            <div class="stat-label">æ­£é¢æ—¶é†’æ¥</div>
          </div>
          <div class="stat-box">
            <div class="stat-value blue" id="sbRatio">-</div>
            <div class="stat-label">æ­£é¢é†’æ¥å æ¯”</div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="simSleepingBeauty()"><i class="ti ti-zzz"></i> åšä¸€æ¬¡å®éªŒ</button>
          <button class="btn btn-secondary" onclick="simSleepingBeautyMany(1000)"><i class="ti ti-bolt"></i> åš1000æ¬¡</button>
          <button class="btn btn-secondary" onclick="resetSleepingBeauty()"><i class="ti ti-refresh"></i> é‡ç½®</button>
        </div>
      </div>

      <div class="explanation">
        <h3><i class="ti ti-bulb"></i> ä¸ºä»€ä¹ˆä¸¤ä¸ªç­”æ¡ˆéƒ½"å¯¹"ï¼Ÿ</h3>
        <p>è¿™å–å†³äºä½ æ€ä¹ˆç†è§£"æ¦‚ç‡"ï¼š</p>
        <div class="formula">
<span class="success">1/2æ´¾ï¼ˆHalferï¼‰ï¼š</span><br>
ç¡¬å¸æ˜¯å…¬å¹³çš„ï¼Œæ²¡æœ‰æ–°ä¿¡æ¯æ”¹å˜è¿™ä¸ªäº‹å®ã€‚<br>
"è¢«å«é†’"ä¸æ˜¯æ–°è¯æ®ï¼Œå› ä¸ºæ— è®ºæ­£åé¢éƒ½ä¼šè¢«å«é†’ã€‚<br>
æ‰€ä»¥æ¦‚ç‡ä»ç„¶æ˜¯ 1/2ã€‚<br><br>
<span class="highlight">1/3æ´¾ï¼ˆThirderï¼‰ï¼š</span><br>
ä¸‰ç§ç­‰å¯èƒ½çš„é†’æ¥æƒ…å†µï¼š<br>
â‘  æ­£é¢ + å‘¨ä¸€ï¼ˆæ¦‚ç‡1/2 Ã— 1 = 1/2ï¼‰<br>
â‘¡ åé¢ + å‘¨ä¸€ï¼ˆæ¦‚ç‡1/2 Ã— 1/2 = 1/4ï¼‰<br>
â‘¢ åé¢ + å‘¨äºŒï¼ˆæ¦‚ç‡1/2 Ã— 1/2 = 1/4ï¼‰<br>
ä½†ä»"é†’æ¥æ¬¡æ•°"è§’åº¦ï¼šæ­£é¢1æ¬¡ï¼Œåé¢2æ¬¡ â†’ 1/3
        </div>
        <p>æ¨¡æ‹Ÿç»“æœæ”¯æŒ1/3æ´¾ï¼šå¦‚æœä½ ç»Ÿè®¡æ‰€æœ‰é†’æ¥æ—¶åˆ»ï¼Œæ­£é¢åªå 1/3ã€‚</p>
        <p>ä½†1/2æ´¾è®¤ä¸ºè¿™æ˜¯åœ¨å·æ¢æ¦‚å¿µâ€”â€”æŠŠ"å®éªŒæ¬¡æ•°"å’Œ"é†’æ¥æ¬¡æ•°"æ··æ·†äº†ã€‚</p>
        <p><span class="highlight">è¿™ä¸ªé—®é¢˜è‡³ä»Šæ²¡æœ‰å…¬è®¤çš„æ­£ç¡®ç­”æ¡ˆ</span>ï¼Œå®ƒè§¦åŠäº†æ¦‚ç‡è®ºçš„å“²å­¦åŸºç¡€ã€‚</p>
      </div>
    </div>

    <!-- æ€»ç»“ -->
    <div class="conclusion-box">
      <h3><i class="ti ti-sparkles"></i> æ¦‚ç‡çš„ä¸–ç•Œæ²¡æœ‰"æ˜¾ç„¶"</h3>
      <p>
        éä¼ é€’éª°å­å‘Šè¯‰æˆ‘ä»¬ï¼š<strong>ä¼˜åŠ¿ä¸å¯ä¼ é€’</strong><br>
        ç”·å­©å¥³å­©æ‚–è®ºå‘Šè¯‰æˆ‘ä»¬ï¼š<strong>æ¡ä»¶ä¸åŒï¼Œæ¦‚ç‡ä¸åŒ</strong><br>
        å‡é˜³æ€§æ‚–è®ºå‘Šè¯‰æˆ‘ä»¬ï¼š<strong>åŸºæ•°æ¯”å‡†ç¡®ç‡æ›´é‡è¦</strong><br>
        é›†é½é—®é¢˜å‘Šè¯‰æˆ‘ä»¬ï¼š<strong>æœ€åä¸€æ­¥æ°¸è¿œæœ€éš¾</strong><br>
        ç¡ç¾äººé—®é¢˜å‘Šè¯‰æˆ‘ä»¬ï¼š<strong>"æ¦‚ç‡"æœ¬èº«çš„å®šä¹‰å°±æœ‰äº‰è®®</strong><br><br>
        <span style="color: #f5af19;">å½“ä½ è§‰å¾—ä¸€ä¸ªæ¦‚ç‡é—®é¢˜"æ˜¾ç„¶"æ—¶ï¼Œå¤šæƒ³ä¸‰ç§’é’Ÿã€‚</span>
      </p>
    </div>
  </div>

  <script>
    // ========== æ ‡ç­¾åˆ‡æ¢ ==========
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // ========== 1. éä¼ é€’éª°å­ ==========
    const DICE = {
      A: [2, 2, 4, 4, 9, 9],
      B: [1, 1, 6, 6, 8, 8],
      C: [3, 3, 5, 5, 7, 7]
    };
    let diceStats = { total: 0, leftWin: 0 };

    function getMatchup() {
      const m = document.getElementById('diceMatchup').value;
      if (m === 'ab') return ['A', 'B'];
      if (m === 'bc') return ['B', 'C'];
      return ['C', 'A'];
    }

    function rollOneDie(faces) {
      return faces[Math.floor(Math.random() * faces.length)];
    }

    function rollDice(animate) {
      const [left, right] = getMatchup();
      const lv = rollOneDie(DICE[left]);
      const rv = rollOneDie(DICE[right]);
      diceStats.total++;
      if (lv > rv) diceStats.leftWin++;

      if (animate !== false) {
        document.getElementById('diceADisplay').textContent = left === 'A' || right === 'A' ? (left === 'A' ? lv : rv) : 'Â·';
        document.getElementById('diceBDisplay').textContent = left === 'B' || right === 'B' ? (left === 'B' ? lv : rv) : 'Â·';
        document.getElementById('diceCDisplay').textContent = left === 'C' || right === 'C' ? (left === 'C' ? lv : rv) : 'Â·';
      }
      updateDiceStats(left, right);
    }

    function rollDiceMany(n) {
      for (let i = 0; i < n; i++) rollDice(false);
      const [left, right] = getMatchup();
      updateDiceStats(left, right);
    }

    function updateDiceStats(left, right) {
      document.getElementById('diceTotal').textContent = diceStats.total;
      document.getElementById('diceLeftWin').textContent = diceStats.leftWin;
      document.getElementById('diceRightWin').textContent = diceStats.total - diceStats.leftWin;
      document.getElementById('diceLeftLabel').textContent = left + 'èƒœ';
      document.getElementById('diceRightLabel').textContent = right + 'èƒœ';
      document.getElementById('diceWinRateLabel').textContent = left + 'èƒœç‡';
      if (diceStats.total > 0) {
        document.getElementById('diceWinRate').textContent = (diceStats.leftWin / diceStats.total * 100).toFixed(1) + '%';
      }
    }

    function resetDice() {
      diceStats = { total: 0, leftWin: 0 };
      document.getElementById('diceTotal').textContent = '0';
      document.getElementById('diceLeftWin').textContent = '0';
      document.getElementById('diceRightWin').textContent = '0';
      document.getElementById('diceWinRate').textContent = '-';
      document.getElementById('diceADisplay').textContent = '?';
      document.getElementById('diceBDisplay').textContent = '?';
      document.getElementById('diceCDisplay').textContent = '?';
    }

    document.getElementById('diceMatchup').addEventListener('change', resetDice);

    // ========== 2. ç”·å­©å¥³å­©æ‚–è®º ==========
    let bgStats = { total: 0, bothBoys: 0 };

    function simBoyGirl(animate) {
      const condition = document.getElementById('boygirlCondition').value;
      let child1, child2;
      // ä¸æ–­ç”Ÿæˆç›´åˆ°æ»¡è¶³æ¡ä»¶
      while (true) {
        child1 = Math.random() < 0.5 ? 'boy' : 'girl';
        child2 = Math.random() < 0.5 ? 'boy' : 'girl';
        if (condition === 'elder' && child1 === 'boy') break;
        if (condition === 'atleast' && (child1 === 'boy' || child2 === 'boy')) break;
      }
      bgStats.total++;
      if (child1 === 'boy' && child2 === 'boy') bgStats.bothBoys++;

      if (animate !== false) {
        const display = document.getElementById('familyDisplay');
        display.innerHTML = `
          <div class="child-icon">${child1 === 'boy' ? 'ğŸ‘¦' : 'ğŸ‘§'}<br><span style="font-size:0.7rem;color:rgba(255,255,255,0.5);">è€å¤§</span></div>
          <div class="child-icon">${child2 === 'boy' ? 'ğŸ‘¦' : 'ğŸ‘§'}<br><span style="font-size:0.7rem;color:rgba(255,255,255,0.5);">è€äºŒ</span></div>
        `;
      }
      updateBGStats();
    }

    function simBoyGirlMany(n) {
      for (let i = 0; i < n; i++) simBoyGirl(false);
      updateBGStats();
    }

    function updateBGStats() {
      document.getElementById('bgTotal').textContent = bgStats.total;
      document.getElementById('bgBothBoys').textContent = bgStats.bothBoys;
      if (bgStats.total > 0) {
        document.getElementById('bgRate').textContent = (bgStats.bothBoys / bgStats.total * 100).toFixed(1) + '%';
      }
      const condition = document.getElementById('boygirlCondition').value;
      document.getElementById('bgTheory').textContent = condition === 'elder' ? '1/2' : '1/3';
    }

    function resetBoyGirl() {
      bgStats = { total: 0, bothBoys: 0 };
      document.getElementById('bgTotal').textContent = '0';
      document.getElementById('bgBothBoys').textContent = '0';
      document.getElementById('bgRate').textContent = '-';
      document.getElementById('familyDisplay').innerHTML = '<div class="child-icon">?</div><div class="child-icon">?</div>';
      const condition = document.getElementById('boygirlCondition').value;
      document.getElementById('bgTheory').textContent = condition === 'elder' ? '1/2' : '1/3';
    }

    // ========== 3. å‡é˜³æ€§æ‚–è®º ==========
    let fpStats = { truePos: 0, falsePos: 0, total: 0 };

    function getFPParams() {
      return {
        prevalence: parseFloat(document.getElementById('prevalence').value) / 100,
        sensitivity: parseFloat(document.getElementById('sensitivity').value) / 100,
        specificity: parseFloat(document.getElementById('specificity').value) / 100
      };
    }

    function updateFPDisplay() {
      document.getElementById('prevalenceDisplay').textContent = document.getElementById('prevalence').value + '%';
      document.getElementById('sensitivityDisplay').textContent = document.getElementById('sensitivity').value + '%';
      document.getElementById('specificityDisplay').textContent = document.getElementById('specificity').value + '%';
    }

    function simulateFP() {
      const { prevalence, sensitivity, specificity } = getFPParams();
      const isSick = Math.random() < prevalence;
      let testPositive;
      if (isSick) {
        testPositive = Math.random() < sensitivity;
      } else {
        testPositive = Math.random() > specificity;
      }
      if (testPositive) {
        fpStats.total++;
        if (isSick) fpStats.truePos++;
        else fpStats.falsePos++;
      }
      updateFPStats();
    }

    function simulateFPMany(n) {
      const { prevalence, sensitivity, specificity } = getFPParams();
      for (let i = 0; i < n; i++) {
        const isSick = Math.random() < prevalence;
        let testPositive;
        if (isSick) {
          testPositive = Math.random() < sensitivity;
        } else {
          testPositive = Math.random() > specificity;
        }
        if (testPositive) {
          fpStats.total++;
          if (isSick) fpStats.truePos++;
          else fpStats.falsePos++;
        }
      }
      updateFPStats();
      renderPopulationGrid();
    }

    function updateFPStats() {
      document.getElementById('fpTruePositive').textContent = fpStats.truePos;
      document.getElementById('fpFalsePositive').textContent = fpStats.falsePos;
      if (fpStats.total > 0) {
        document.getElementById('fpPPV').textContent = (fpStats.truePos / fpStats.total * 100).toFixed(1) + '%';
      }
    }

    function renderPopulationGrid() {
      const grid = document.getElementById('populationGrid');
      const { prevalence, sensitivity, specificity } = getFPParams();
      const total = 200;
      grid.innerHTML = '';
      for (let i = 0; i < total; i++) {
        const dot = document.createElement('div');
        dot.className = 'person-dot';
        const isSick = Math.random() < prevalence;
        if (isSick) {
          const detected = Math.random() < sensitivity;
          if (detected) dot.classList.add('sick');
        } else {
          const falseAlarm = Math.random() > specificity;
          if (falseAlarm) dot.classList.add('false-positive');
          else dot.classList.add('true-negative');
        }
        grid.appendChild(dot);
      }
    }

    function resetFP() {
      fpStats = { truePos: 0, falsePos: 0, total: 0 };
      document.getElementById('fpTruePositive').textContent = '-';
      document.getElementById('fpFalsePositive').textContent = '-';
      document.getElementById('fpPPV').textContent = '-';
      document.getElementById('populationGrid').innerHTML = '';
    }

    // ========== 4. é›†é½ä¼˜æƒ åˆ¸é—®é¢˜ ==========
    let couponState = { collected: new Set(), bought: 0, rounds: 0, totalBought: 0 };
    const COUPON_ICONS = ['ğŸ‰', 'ğŸ…', 'ğŸ’', 'ğŸ', 'ğŸ', 'ğŸ“', 'ğŸ•', 'ğŸ–', 'ğŸ€', 'ğŸ‚', 'ğŸ‡', 'ğŸ‘', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¦', 'ğŸ§', 'ğŸ¦…', 'ğŸ¬', 'ğŸ¦„'];

    function getCouponCount() {
      return parseInt(document.getElementById('couponTypes').value);
    }

    function couponExpected(n) {
      let sum = 0;
      for (let i = 1; i <= n; i++) sum += 1 / i;
      return n * sum;
    }

    function updateCouponTheory() {
      const n = getCouponCount();
      document.getElementById('couponTypesDisplay').textContent = n;
      document.getElementById('couponTheory').textContent = couponExpected(n).toFixed(2);
      resetCoupon();
    }

    function renderCoupons() {
      const n = getCouponCount();
      const display = document.getElementById('couponDisplay');
      display.innerHTML = '';
      for (let i = 0; i < n; i++) {
        const c = document.createElement('div');
        c.className = 'coupon' + (couponState.collected.has(i) ? ' collected' : '');
        c.textContent = couponState.collected.has(i) ? COUPON_ICONS[i % COUPON_ICONS.length] : '?';
        display.appendChild(c);
      }
    }

    function buyCoupon() {
      const n = getCouponCount();
      if (couponState.collected.size >= n) return;
      const card = Math.floor(Math.random() * n);
      couponState.collected.add(card);
      couponState.bought++;
      renderCoupons();
      document.getElementById('couponBought').textContent = couponState.bought;
      document.getElementById('couponCollected').textContent = couponState.collected.size + '/' + n;
      if (couponState.collected.size >= n) {
        couponState.rounds++;
        couponState.totalBought += couponState.bought;
        document.getElementById('couponAvg').textContent = (couponState.totalBought / couponState.rounds).toFixed(1);
      }
    }

    function collectAll() {
      const n = getCouponCount();
      couponState.collected = new Set();
      couponState.bought = 0;
      while (couponState.collected.size < n) {
        couponState.collected.add(Math.floor(Math.random() * n));
        couponState.bought++;
      }
      couponState.rounds++;
      couponState.totalBought += couponState.bought;
      renderCoupons();
      document.getElementById('couponBought').textContent = couponState.bought;
      document.getElementById('couponCollected').textContent = n + '/' + n;
      document.getElementById('couponAvg').textContent = (couponState.totalBought / couponState.rounds).toFixed(1);
    }

    function collectAllMany(times) {
      const n = getCouponCount();
      for (let t = 0; t < times; t++) {
        const s = new Set();
        let b = 0;
        while (s.size < n) {
          s.add(Math.floor(Math.random() * n));
          b++;
        }
        couponState.rounds++;
        couponState.totalBought += b;
      }
      document.getElementById('couponAvg').textContent = (couponState.totalBought / couponState.rounds).toFixed(1);
      document.getElementById('couponBought').textContent = 'æ‰¹é‡';
      document.getElementById('couponCollected').textContent = `${times}è½®å®Œæˆ`;
    }

    function resetCoupon() {
      couponState = { collected: new Set(), bought: 0, rounds: 0, totalBought: 0 };
      renderCoupons();
      document.getElementById('couponBought').textContent = '0';
      document.getElementById('couponCollected').textContent = '0';
      document.getElementById('couponAvg').textContent = '-';
    }

    // ========== 5. ç¡ç¾äººé—®é¢˜ ==========
    let sbStats = { experiments: 0, wakeups: 0, headsWake: 0 };

    function simSleepingBeauty(animate) {
      const isHeads = Math.random() < 0.5;
      sbStats.experiments++;
      if (isHeads) {
        sbStats.wakeups += 1;
        sbStats.headsWake += 1;
      } else {
        sbStats.wakeups += 2;
      }

      if (animate !== false) {
        document.getElementById('sbCoin').innerHTML = 'æŠ›ç¡¬å¸<br><span style="font-size:1.5rem;">' + (isHeads ? 'ğŸŒŸæ­£é¢' : 'ğŸŒ‘åé¢') + '</span>';
        document.getElementById('sbMonIcon').textContent = 'ğŸ˜ƒ';
        if (isHeads) {
          document.getElementById('sbTue').style.opacity = '0.3';
          document.getElementById('sbTueIcon').textContent = 'ğŸ’¤';
          document.getElementById('sbMessage').innerHTML = '<span style="color:#4ade80;">æ­£é¢</span> â†’ å‘¨ä¸€é†’æ¥1æ¬¡ï¼Œå®éªŒç»“æŸ';
        } else {
          document.getElementById('sbTue').style.opacity = '1';
          document.getElementById('sbTueIcon').textContent = 'ğŸ˜ƒ';
          document.getElementById('sbMessage').innerHTML = '<span style="color:#f87171;">åé¢</span> â†’ å‘¨ä¸€é†’æ¥ + é—å¿˜è¯ + å‘¨äºŒå†é†’æ¥ï¼Œå…±2æ¬¡';
        }
      }
      updateSBStats();
    }

    function simSleepingBeautyMany(n) {
      for (let i = 0; i < n; i++) simSleepingBeauty(false);
      updateSBStats();
    }

    function updateSBStats() {
      document.getElementById('sbExperiments').textContent = sbStats.experiments;
      document.getElementById('sbWakeups').textContent = sbStats.wakeups;
      document.getElementById('sbHeadsWake').textContent = sbStats.headsWake;
      if (sbStats.wakeups > 0) {
        document.getElementById('sbRatio').textContent = (sbStats.headsWake / sbStats.wakeups * 100).toFixed(1) + '%';
      }
    }

    function resetSleepingBeauty() {
      sbStats = { experiments: 0, wakeups: 0, headsWake: 0 };
      document.getElementById('sbExperiments').textContent = '0';
      document.getElementById('sbWakeups').textContent = '0';
      document.getElementById('sbHeadsWake').textContent = '0';
      document.getElementById('sbRatio').textContent = '-';
      document.getElementById('sbCoin').innerHTML = 'æŠ›ç¡¬å¸<br><span style="font-size:1.5rem;">ğŸª™</span>';
      document.getElementById('sbMonIcon').textContent = 'ğŸ˜´';
      document.getElementById('sbTueIcon').textContent = '?';
      document.getElementById('sbTue').style.opacity = '1';
      document.getElementById('sbMessage').textContent = 'ç‚¹å‡»æ¨¡æ‹Ÿå¼€å§‹å®éªŒ';
    }

    // ========== åˆå§‹åŒ– ==========
    renderCoupons();
    updateCouponTheory();
  </script>
</body>
</html>
