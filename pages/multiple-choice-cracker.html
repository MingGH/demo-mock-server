<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é€‰æ‹©é¢˜ç ´è§£å™¨ - 100é“é¢˜ä¸€é¢˜ä¸ä¼šï¼Œå¦‚ä½•æœ€å¿«å…¨å¯¹ï¼Ÿ</title>
  <script src="../components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', -apple-system, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #0d1b2a 100%);
      min-height: 100vh;
      color: #e4e4e4;
      padding: 30px 20px;
    }

    .container { max-width: 1000px; margin: 0 auto; }

    .header { text-align: center; margin: 20px 0 40px; }
    .header h1 {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(90deg, #00d4ff, #7c3aed, #00d4ff);
      background-size: 200% 100%;
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s ease infinite;
    }
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .header p { color: rgba(255,255,255,0.6); margin-top: 12px; font-size: 15px; line-height: 1.6; }

    /* æ§åˆ¶é¢æ¿ */
    .control-panel {
      background: rgba(255,255,255,0.03);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 25px;
      margin-bottom: 25px;
    }
    .control-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
      justify-content: center;
    }
    .control-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .control-group label {
      color: rgba(255,255,255,0.7);
      font-size: 14px;
    }
    .control-group input, .control-group select {
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 10px 15px;
      color: white;
      font-size: 14px;
      width: 100px;
    }
    .control-group select { width: 150px; }
    .control-group select option { background: #1a1a2e; }

    .btn {
      padding: 12px 30px;
      font-size: 15px;
      font-weight: 600;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #00d4ff, #7c3aed);
      color: white;
    }
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .btn:hover:not(:disabled) { transform: translateY(-2px); opacity: 0.9; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }

    /* çŠ¶æ€æ˜¾ç¤º */
    .status-panel {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    .status-card {
      background: rgba(255,255,255,0.03);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 20px;
      text-align: center;
    }
    .status-label { color: rgba(255,255,255,0.5); font-size: 12px; margin-bottom: 8px; }
    .status-value { font-size: 1.8rem; font-weight: 700; color: #00d4ff; }
    .status-value.highlight { color: #ffd700; }
    .status-value.success { color: #4ade80; }

    /* ç­”é¢˜åŒºåŸŸ */
    .quiz-section {
      background: rgba(255,255,255,0.03);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 25px;
      margin-bottom: 25px;
    }
    .section-title {
      color: #00d4ff;
      font-size: 16px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* é¢˜ç›®ç½‘æ ¼ */
    .questions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 8px;
      margin-bottom: 20px;
      max-height: 300px;
      overflow-y: auto;
      padding: 10px;
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
    }
    .question-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      color: rgba(255,255,255,0.4);
      border: 2px solid transparent;
      transition: all 0.2s;
    }
    .question-cell.known {
      background: rgba(74,222,128,0.2);
      border-color: #4ade80;
      color: #4ade80;
    }
    .question-cell.testing {
      background: rgba(255,215,0,0.2);
      border-color: #ffd700;
      color: #ffd700;
    }
    .question-cell.current {
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* æ—¥å¿—åŒºåŸŸ */
    .log-section {
      background: rgba(255,255,255,0.03);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 25px;
      margin-bottom: 25px;
    }
    .log-container {
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
      padding: 15px;
      max-height: 250px;
      overflow-y: auto;
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 13px;
      line-height: 1.8;
    }
    .log-entry { margin-bottom: 5px; }
    .log-entry.submit { color: #00d4ff; }
    .log-entry.result { color: #ffd700; }
    .log-entry.found { color: #4ade80; }
    .log-entry.info { color: rgba(255,255,255,0.6); }

    /* ç­–ç•¥è¯´æ˜ */
    .strategy-section {
      background: rgba(255,255,255,0.03);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 25px;
    }
    .strategy-content {
      color: rgba(255,255,255,0.7);
      line-height: 1.8;
      font-size: 14px;
    }
    .strategy-content h4 {
      color: #00d4ff;
      margin: 20px 0 10px;
      font-size: 15px;
    }
    .strategy-content h4:first-child { margin-top: 0; }
    .strategy-content p { margin-bottom: 12px; }
    .strategy-content .formula {
      background: rgba(0,0,0,0.3);
      padding: 15px;
      border-radius: 10px;
      font-family: 'Monaco', 'Consolas', monospace;
      margin: 15px 0;
      text-align: center;
      color: #ffd700;
    }
    .strategy-content .highlight-box {
      background: rgba(124,58,237,0.1);
      border-left: 3px solid #7c3aed;
      padding: 15px;
      margin: 15px 0;
      border-radius: 0 10px 10px 0;
    }

    /* è¿›åº¦æ¡ */
    .progress-bar {
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 15px;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00d4ff, #4ade80);
      border-radius: 4px;
      transition: width 0.3s;
    }

    @media (max-width: 600px) {
      .header h1 { font-size: 1.5rem; }
      .control-row { flex-direction: column; }
      .questions-grid { grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ğŸ¯ é€‰æ‹©é¢˜ç ´è§£å™¨</h1>
    <p>100é“4é€‰1å•é€‰é¢˜ï¼Œä¸€é¢˜ä¸ä¼šï¼Œåªèƒ½çœ‹æ€»åˆ†ã€‚<br>å¦‚ä½•ç”¨æœ€å°‘çš„æäº¤æ¬¡æ•°æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®ç­”æ¡ˆï¼Ÿ</p>
  </div>

  <!-- æ§åˆ¶é¢æ¿ -->
  <div class="control-panel">
    <div class="control-row">
      <div class="control-group">
        <label>é¢˜ç›®æ•°é‡ï¼š</label>
        <input type="number" id="questionCount" value="100" min="1" max="200">
      </div>
      <div class="control-group">
        <label>é€‰é¡¹æ•°é‡ï¼š</label>
        <select id="optionCount">
          <option value="2">2é€‰1</option>
          <option value="3">3é€‰1</option>
          <option value="4" selected>4é€‰1</option>
          <option value="5">5é€‰1</option>
        </select>
      </div>
      <div class="control-group">
        <label>ç­–ç•¥ï¼š</label>
        <select id="strategy">
          <option value="binary">äºŒåˆ†æ³•</option>
          <option value="sequential">é€é¢˜æ³•</option>
        </select>
      </div>
      <div class="control-group">
        <label>é€Ÿåº¦ï¼š</label>
        <select id="speed">
          <option value="100">æ…¢é€Ÿ</option>
          <option value="30" selected>æ­£å¸¸</option>
          <option value="5">å¿«é€Ÿ</option>
          <option value="0">æé€Ÿ</option>
        </select>
      </div>
      <button class="btn btn-primary" id="startBtn" onclick="startSimulation()">ğŸš€ å¼€å§‹ç ´è§£</button>
      <button class="btn btn-secondary" id="resetBtn" onclick="resetSimulation()">ğŸ”„ é‡ç½®</button>
    </div>
  </div>

  <!-- çŠ¶æ€é¢æ¿ -->
  <div class="status-panel">
    <div class="status-card">
      <div class="status-label">æäº¤æ¬¡æ•°</div>
      <div class="status-value" id="submitCount">0</div>
    </div>
    <div class="status-card">
      <div class="status-label">å·²ç¡®å®šç­”æ¡ˆ</div>
      <div class="status-value highlight" id="knownCount">0</div>
    </div>
    <div class="status-card">
      <div class="status-label">å½“å‰å¾—åˆ†</div>
      <div class="status-value" id="currentScore">-</div>
    </div>
    <div class="status-card">
      <div class="status-label">çŠ¶æ€</div>
      <div class="status-value success" id="statusText">å°±ç»ª</div>
    </div>
  </div>

  <!-- ç­”é¢˜åŒºåŸŸ -->
  <div class="quiz-section">
    <div class="section-title">ğŸ“‹ é¢˜ç›®çŠ¶æ€ï¼ˆç»¿è‰²=å·²ç¡®å®šï¼Œé»„è‰²=æµ‹è¯•ä¸­ï¼‰</div>
    <div class="questions-grid" id="questionsGrid"></div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width: 0%"></div>
    </div>
  </div>

  <!-- æ—¥å¿—åŒºåŸŸ -->
  <div class="log-section">
    <div class="section-title">ğŸ“ æ“ä½œæ—¥å¿—</div>
    <div class="log-container" id="logContainer">
      <div class="log-entry info">ç­‰å¾…å¼€å§‹...</div>
    </div>
  </div>

  <!-- ç­–ç•¥è¯´æ˜ -->
  <div class="strategy-section">
    <div class="section-title">ğŸ’¡ ç­–ç•¥åŸç†</div>
    <div class="strategy-content">
      <h4>é—®é¢˜æœ¬è´¨</h4>
      <p>è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æœç´¢é—®é¢˜ã€‚100é“4é€‰1é¢˜ï¼Œå…±æœ‰ 4<sup>100</sup> ç§å¯èƒ½çš„ç­”æ¡ˆç»„åˆï¼ˆçº¦ 10<sup>60</sup>ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡"æäº¤ååªè¿”å›æ­£ç¡®æ•°é‡"è¿™ä¸ªåé¦ˆæ¥å®šä½å”¯ä¸€æ­£ç¡®ç­”æ¡ˆã€‚</p>
      
      <h4>äºŒåˆ†æ³•ç­–ç•¥ï¼ˆæœ€ä¼˜ï¼‰</h4>
      <p>æ ¸å¿ƒæ€æƒ³ï¼šæ¯æ¬¡æäº¤å°½å¯èƒ½è·å–æœ€å¤šçš„ä¿¡æ¯ã€‚</p>
      <p><strong>ç¬¬ä¸€é˜¶æ®µï¼šå»ºç«‹åŸºå‡†</strong></p>
      <p>å…ˆæäº¤ä¸€ä»½å…¨Açš„ç­”å·ï¼Œå¾—åˆ°åŸºå‡†åˆ†æ•° Sâ‚€ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬æœ‰å¤šå°‘é¢˜çš„æ­£ç¡®ç­”æ¡ˆæ˜¯Aã€‚</p>
      
      <p><strong>ç¬¬äºŒé˜¶æ®µï¼šé€é¢˜ç¡®å®š</strong></p>
      <p>å¯¹äºæ¯é“é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå®ƒçš„æ­£ç¡®ç­”æ¡ˆæ˜¯A/B/C/Dä¸­çš„å“ªä¸€ä¸ªã€‚</p>
      <p>å‡è®¾å½“å‰ç¬¬ié¢˜æˆ‘ä»¬å¡«çš„æ˜¯Aï¼Œå…¶ä»–é¢˜ä¿æŒä¸å˜ï¼š</p>
      <ul style="margin-left: 20px; margin-bottom: 12px;">
        <li>æŠŠç¬¬ié¢˜æ”¹æˆBï¼Œæäº¤ï¼Œå¾—åˆ†å˜åŒ– Î”</li>
        <li>å¦‚æœ Î” = +1ï¼Œè¯´æ˜Bæ˜¯æ­£ç¡®ç­”æ¡ˆ</li>
        <li>å¦‚æœ Î” = -1ï¼Œè¯´æ˜Aæ˜¯æ­£ç¡®ç­”æ¡ˆ</li>
        <li>å¦‚æœ Î” = 0ï¼Œè¯´æ˜Aå’ŒBéƒ½ä¸å¯¹ï¼Œç»§ç»­æµ‹è¯•C</li>
      </ul>
      
      <div class="highlight-box">
        <strong>æœ€åæƒ…å†µåˆ†æï¼š</strong><br>
        æ¯é“é¢˜æœ€å¤šéœ€è¦æµ‹è¯•3æ¬¡ï¼ˆæµ‹è¯•Bã€Cã€Dï¼Œå¦‚æœéƒ½ä¸å¯¹åˆ™ç­”æ¡ˆæ˜¯Aï¼‰ã€‚<br>
        ä½†å®é™…ä¸Šï¼Œé€šè¿‡åˆ†ç»„ç­–ç•¥å¯ä»¥å¤§å¹…å‡å°‘æäº¤æ¬¡æ•°ã€‚
      </div>

      <h4>åˆ†ç»„ä¼˜åŒ–</h4>
      <p>å°†é¢˜ç›®åˆ†æˆè‹¥å¹²ç»„ï¼ŒåŒæ—¶æ”¹å˜ä¸€ç»„é¢˜çš„ç­”æ¡ˆã€‚é€šè¿‡åˆ†æ•°å˜åŒ–å¯ä»¥æ¨æ–­å‡ºè¿™ç»„é¢˜ä¸­æœ‰å¤šå°‘é¢˜çš„ç­”æ¡ˆè¢«æ”¹å¯¹/æ”¹é”™äº†ã€‚</p>
      
      <div class="formula">
        ç†è®ºæœ€ä¼˜ï¼šO(n Ã— logâ‚‚(k)) æ¬¡æäº¤<br>
        n=100, k=4 æ—¶çº¦ 200 æ¬¡
      </div>

      <h4>é€é¢˜æ³•ï¼ˆå¯¹ç…§ç»„ï¼‰</h4>
      <p>æœ€æœ´ç´ çš„æ–¹æ³•ï¼šå¯¹æ¯é“é¢˜ä¾æ¬¡å°è¯•æ¯ä¸ªé€‰é¡¹ï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®ç­”æ¡ˆã€‚</p>
      <p>æœ€åæƒ…å†µï¼šæ¯é¢˜éœ€è¦ k-1 æ¬¡å°è¯•ï¼Œå…± nÃ—(k-1) = 300 æ¬¡ã€‚</p>
    </div>
  </div>
</div>

<script>
// å…¨å±€çŠ¶æ€
let state = {
  n: 100,           // é¢˜ç›®æ•°é‡
  k: 4,             // é€‰é¡¹æ•°é‡
  correctAnswers: [],  // æ­£ç¡®ç­”æ¡ˆï¼ˆ0åˆ°k-1ï¼‰
  currentAnswers: [],  // å½“å‰ç­”å·
  knownAnswers: [],    // å·²ç¡®å®šçš„ç­”æ¡ˆï¼ˆ-1è¡¨ç¤ºæœªçŸ¥ï¼‰
  submitCount: 0,
  running: false,
  speed: 50          // åŠ¨ç”»é€Ÿåº¦ï¼ˆmsï¼‰
};

// åˆå§‹åŒ–é¢˜ç›®ç½‘æ ¼
function initGrid() {
  const grid = document.getElementById('questionsGrid');
  grid.innerHTML = '';
  for (let i = 0; i < state.n; i++) {
    const cell = document.createElement('div');
    cell.className = 'question-cell';
    cell.id = `q${i}`;
    cell.textContent = i + 1;
    grid.appendChild(cell);
  }
}

// ç”Ÿæˆéšæœºæ­£ç¡®ç­”æ¡ˆ
function generateCorrectAnswers() {
  state.correctAnswers = [];
  for (let i = 0; i < state.n; i++) {
    state.correctAnswers.push(Math.floor(Math.random() * state.k));
  }
}

// æäº¤ç­”å·ï¼Œè¿”å›å¾—åˆ†
function submit(answers) {
  state.submitCount++;
  let score = 0;
  for (let i = 0; i < state.n; i++) {
    if (answers[i] === state.correctAnswers[i]) {
      score++;
    }
  }
  updateDisplay();
  return score;
}

// æ›´æ–°æ˜¾ç¤º
function updateDisplay() {
  document.getElementById('submitCount').textContent = state.submitCount;
  const knownCount = state.knownAnswers.filter(a => a !== -1).length;
  document.getElementById('knownCount').textContent = knownCount;
  document.getElementById('progressFill').style.width = (knownCount / state.n * 100) + '%';
  
  // æ›´æ–°é¢˜ç›®ç½‘æ ¼
  for (let i = 0; i < state.n; i++) {
    const cell = document.getElementById(`q${i}`);
    cell.className = 'question-cell';
    if (state.knownAnswers[i] !== -1) {
      cell.classList.add('known');
      cell.textContent = String.fromCharCode(65 + state.knownAnswers[i]);
    } else {
      cell.textContent = i + 1;
    }
  }
}

// æ·»åŠ æ—¥å¿—
function log(message, type = 'info') {
  const container = document.getElementById('logContainer');
  const entry = document.createElement('div');
  entry.className = `log-entry ${type}`;
  entry.textContent = message;
  container.appendChild(entry);
  container.scrollTop = container.scrollHeight;
}

// æ¸…ç©ºæ—¥å¿—
function clearLog() {
  document.getElementById('logContainer').innerHTML = '';
}

// å»¶è¿Ÿå‡½æ•°
function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// äºŒåˆ†æ³•ç­–ç•¥ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
async function binaryStrategy() {
  const optionChar = (i) => String.fromCharCode(65 + i);
  
  // åˆå§‹åŒ–ï¼šå…¨éƒ¨å¡«A
  state.currentAnswers = new Array(state.n).fill(0);
  state.knownAnswers = new Array(state.n).fill(-1);
  
  log('=== å¼€å§‹äºŒåˆ†æ³•ç ´è§£ ===', 'info');
  log(`é¢˜ç›®æ•°é‡: ${state.n}, é€‰é¡¹æ•°é‡: ${state.k}`, 'info');
  
  // ç¬¬ä¸€æ­¥ï¼šæäº¤å…¨Aï¼Œè·å–åŸºå‡†åˆ†
  log('ğŸ“¤ æäº¤å…¨Aç­”å·å»ºç«‹åŸºå‡†...', 'submit');
  let baseScore = submit([...state.currentAnswers]);
  log(`ğŸ“Š åŸºå‡†å¾—åˆ†: ${baseScore} (æœ‰${baseScore}é¢˜ç­”æ¡ˆæ˜¯A)`, 'result');
  document.getElementById('currentScore').textContent = baseScore;
  
  await delay(state.speed);
  
  // å¯¹æ¯é“é¢˜é€ä¸€ç¡®å®šç­”æ¡ˆ
  for (let i = 0; i < state.n; i++) {
    if (!state.running) break;
    
    // æ ‡è®°å½“å‰æµ‹è¯•çš„é¢˜ç›®
    const cell = document.getElementById(`q${i}`);
    cell.classList.add('testing', 'current');
    
    let found = false;
    
    // å°è¯•B, C, D...ï¼ˆè·³è¿‡å½“å‰é€‰é¡¹ï¼‰
    for (let opt = 1; opt < state.k && !found; opt++) {
      if (!state.running) break;
      
      // æŠŠç¬¬ié¢˜æ”¹æˆopt
      const testAnswers = [...state.currentAnswers];
      testAnswers[i] = opt;
      
      log(`ğŸ” ç¬¬${i+1}é¢˜: Aâ†’${optionChar(opt)}`, 'submit');
      const newScore = submit(testAnswers);
      const delta = newScore - baseScore;
      
      if (delta === 1) {
        // æ”¹å¯¹äº†ï¼Œoptæ˜¯æ­£ç¡®ç­”æ¡ˆ
        state.knownAnswers[i] = opt;
        state.currentAnswers[i] = opt;
        baseScore = newScore;  // æ›´æ–°åŸºå‡†åˆ†
        log(`âœ… ç¬¬${i+1}é¢˜: ${optionChar(opt)} (å¾—åˆ†â†‘)`, 'found');
        found = true;
      } else if (delta === -1) {
        // æ”¹é”™äº†ï¼ŒåŸæ¥çš„ç­”æ¡ˆAæ˜¯å¯¹çš„
        state.knownAnswers[i] = 0;  // A
        log(`âœ… ç¬¬${i+1}é¢˜: A (å¾—åˆ†â†“)`, 'found');
        found = true;
      } else {
        // å¾—åˆ†ä¸å˜ï¼Œä¸¤ä¸ªéƒ½ä¸å¯¹ï¼Œç»§ç»­æµ‹è¯•
        log(`âŒ ${optionChar(opt)}ä¸å¯¹`, 'info');
      }
      
      await delay(state.speed);
    }
    
    // å¦‚æœæµ‹è¯•å®Œæ‰€æœ‰é€‰é¡¹éƒ½æ²¡æ‰¾åˆ°ï¼Œè¯´æ˜æœ€åä¸€ä¸ªé€‰é¡¹æ˜¯å¯¹çš„
    if (!found) {
      state.knownAnswers[i] = state.k - 1;
      state.currentAnswers[i] = state.k - 1;
      baseScore++;  // æ›´æ–°åŸºå‡†åˆ†
      log(`âœ… ç¬¬${i+1}é¢˜: ${optionChar(state.k - 1)} (æ’é™¤æ³•)`, 'found');
    }
    
    cell.classList.remove('current');
    updateDisplay();
    document.getElementById('currentScore').textContent = baseScore;
    await delay(state.speed);
  }
  
  // å®Œæˆ
  if (state.running) {
    log('ğŸ‰ === ç ´è§£å®Œæˆï¼===', 'found');
    log(`ğŸ“Š æ€»æäº¤æ¬¡æ•°: ${state.submitCount}`, 'result');
    const theoretical = state.n * (state.k - 1);
    log(`ğŸ“ˆ æ•ˆç‡: ${(theoretical / state.submitCount * 100).toFixed(1)}% (ç›¸æ¯”æœ€åæƒ…å†µ${theoretical}æ¬¡)`, 'result');
    document.getElementById('statusText').textContent = 'å®Œæˆ!';
  }
}

// é€é¢˜æ³•ç­–ç•¥ï¼ˆå¯¹ç…§ç»„ - æ›´ç®€æ´çš„å®ç°ï¼‰
async function sequentialStrategy() {
  const optionChar = (i) => String.fromCharCode(65 + i);
  
  state.currentAnswers = new Array(state.n).fill(0);
  state.knownAnswers = new Array(state.n).fill(-1);
  
  log('=== å¼€å§‹é€é¢˜æ³•ç ´è§£ ===', 'info');
  log(`é¢˜ç›®æ•°é‡: ${state.n}, é€‰é¡¹æ•°é‡: ${state.k}`, 'info');
  log('âš ï¸ è¿™æ˜¯æœ€æœ´ç´ çš„æ–¹æ³•ï¼Œæ•ˆç‡è¾ƒä½', 'info');
  
  // å…ˆæäº¤ä¸€æ¬¡è·å–åˆå§‹åˆ†æ•°
  let baseScore = submit([...state.currentAnswers]);
  log(`ğŸ“Š åˆå§‹å¾—åˆ†: ${baseScore}`, 'result');
  document.getElementById('currentScore').textContent = baseScore;
  
  await delay(state.speed);
  
  for (let i = 0; i < state.n; i++) {
    if (!state.running) break;
    
    const cell = document.getElementById(`q${i}`);
    cell.classList.add('testing', 'current');
    
    let found = false;
    
    // ä¾æ¬¡å°è¯•æ¯ä¸ªé€‰é¡¹
    for (let opt = 0; opt < state.k && !found; opt++) {
      if (!state.running) break;
      
      if (opt === state.currentAnswers[i]) continue;  // è·³è¿‡å½“å‰é€‰é¡¹
      
      const testAnswers = [...state.currentAnswers];
      testAnswers[i] = opt;
      
      log(`ğŸ” ç¬¬${i+1}é¢˜: æµ‹è¯•${optionChar(opt)}`, 'submit');
      const newScore = submit(testAnswers);
      const delta = newScore - baseScore;
      
      if (delta === 1) {
        // æ‰¾åˆ°æ­£ç¡®ç­”æ¡ˆ
        state.knownAnswers[i] = opt;
        state.currentAnswers[i] = opt;
        baseScore = newScore;
        log(`âœ… ç¬¬${i+1}é¢˜: ${optionChar(opt)}`, 'found');
        found = true;
      } else if (delta === -1) {
        // åŸæ¥çš„æ˜¯å¯¹çš„
        state.knownAnswers[i] = state.currentAnswers[i];
        log(`âœ… ç¬¬${i+1}é¢˜: ${optionChar(state.currentAnswers[i])}`, 'found');
        found = true;
      }
      
      await delay(state.speed);
    }
    
    if (!found) {
      // æ’é™¤æ³•ç¡®å®šæœ€åä¸€ä¸ª
      state.knownAnswers[i] = state.currentAnswers[i];
      log(`âœ… ç¬¬${i+1}é¢˜: ${optionChar(state.currentAnswers[i])} (æ’é™¤æ³•)`, 'found');
    }
    
    cell.classList.remove('current');
    updateDisplay();
    document.getElementById('currentScore').textContent = baseScore;
    await delay(state.speed);
  }
  
  if (state.running) {
    log('ğŸ‰ === ç ´è§£å®Œæˆï¼===', 'found');
    log(`ğŸ“Š æ€»æäº¤æ¬¡æ•°: ${state.submitCount}`, 'result');
    document.getElementById('statusText').textContent = 'å®Œæˆ!';
  }
}

// å¼€å§‹æ¨¡æ‹Ÿ
async function startSimulation() {
  if (state.running) return;
  
  state.n = parseInt(document.getElementById('questionCount').value) || 100;
  state.k = parseInt(document.getElementById('optionCount').value) || 4;
  state.speed = parseInt(document.getElementById('speed').value) || 30;
  state.submitCount = 0;
  state.running = true;
  
  document.getElementById('startBtn').disabled = true;
  document.getElementById('statusText').textContent = 'è¿è¡Œä¸­';
  
  initGrid();
  generateCorrectAnswers();
  clearLog();
  updateDisplay();
  
  const strategy = document.getElementById('strategy').value;
  
  if (strategy === 'binary') {
    await binaryStrategy();
  } else {
    await sequentialStrategy();
  }
  
  state.running = false;
  document.getElementById('startBtn').disabled = false;
}

// é‡ç½®
function resetSimulation() {
  state.running = false;
  state.submitCount = 0;
  state.knownAnswers = [];
  state.currentAnswers = [];
  
  document.getElementById('startBtn').disabled = false;
  document.getElementById('submitCount').textContent = '0';
  document.getElementById('knownCount').textContent = '0';
  document.getElementById('currentScore').textContent = '-';
  document.getElementById('statusText').textContent = 'å°±ç»ª';
  document.getElementById('progressFill').style.width = '0%';
  
  initGrid();
  clearLog();
  log('å·²é‡ç½®ï¼Œç­‰å¾…å¼€å§‹...', 'info');
}

// åˆå§‹åŒ–
initGrid();
</script>

</body>
</html>
