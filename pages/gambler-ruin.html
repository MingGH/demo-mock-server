<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èµŒå¾’ç ´äº§æ‚–è®º - 50%æ¦‚ç‡ä¸ºä½•å¿…è¾“</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="../components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      padding: 20px;
      color: #fff;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .back-link {
      display: inline-block;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      margin-bottom: 15px;
      font-size: 0.9rem;
    }
    .back-link:hover { text-decoration: underline; }
    h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1.8rem;
      background: linear-gradient(135deg, #ff6b6b, #ffd93d);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle {
      text-align: center;
      color: rgba(255,255,255,0.7);
      margin-bottom: 25px;
      font-size: 0.95rem;
    }
    .card {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .question-box {
      background: linear-gradient(135deg, rgba(255,107,107,0.2), rgba(255,217,61,0.1));
      border-left: 4px solid #ff6b6b;
      padding: 15px 20px;
      border-radius: 0 12px 12px 0;
      margin-bottom: 20px;
      font-size: 1.05rem;
      line-height: 1.8;
    }
    .question-box strong { color: #ffd93d; }
    
    /* æ¸¸æˆåŒºåŸŸ */
    .game-area {
      text-align: center;
      padding: 20px 0;
    }
    .game-info {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .info-box {
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      padding: 15px 25px;
      min-width: 120px;
    }
    .info-box .label {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.5);
      margin-bottom: 5px;
    }
    .info-box .value {
      font-size: 1.6rem;
      font-weight: bold;
    }
    .info-box .value.money { color: #ffd93d; }
    .info-box .value.round { color: #4ade80; }
    .info-box .value.negative { color: #ff6b6b; }
    
    /* èµŒæ¡Œ */
    .betting-table {
      background: linear-gradient(135deg, #1e5631 0%, #2d7a46 100%);
      border-radius: 20px;
      padding: 30px;
      margin: 20px 0;
      border: 8px solid #8b4513;
      box-shadow: inset 0 0 50px rgba(0,0,0,0.3);
    }
    .coin-flip {
      font-size: 80px;
      margin: 20px 0;
      transition: transform 0.5s;
    }
    .coin-flip.flipping {
      animation: flip 0.5s ease-in-out;
    }
    @keyframes flip {
      0% { transform: rotateY(0deg); }
      100% { transform: rotateY(720deg); }
    }
    .result-text {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 15px 0;
      min-height: 40px;
    }
    .result-text.win { color: #4ade80; }
    .result-text.lose { color: #ff6b6b; }
    
    /* æŒ‰é’® */
    .game-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .game-btn {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }
    .game-btn.bet {
      background: linear-gradient(135deg, #ffd93d, #f0c000);
      color: #333;
    }
    .game-btn.auto {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      color: white;
    }
    .game-btn.reset {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .game-btn:hover {
      transform: translateY(-2px);
    }
    .game-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    /* è¾“å…¥åŒº */
    .input-row {
      display: flex;
      gap: 15px;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .input-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .input-group label {
      color: rgba(255,255,255,0.7);
      font-size: 0.9rem;
    }
    .input-group input, .input-group select {
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      background: rgba(0,0,0,0.3);
      color: white;
      font-size: 1rem;
    }
    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: #ffd93d;
    }
    
    /* å›¾è¡¨ */
    .chart-container {
      position: relative;
      height: 250px;
      margin-top: 20px;
    }
    
    /* å†å²è®°å½• */
    .history-section {
      margin-top: 20px;
    }
    .history-section h4 {
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    .history-list {
      max-height: 120px;
      overflow-y: auto;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 10px;
    }
    .history-item {
      display: flex;
      justify-content: space-between;
      padding: 6px 10px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      font-size: 0.85rem;
    }
    .history-item:last-child { border-bottom: none; }
    .history-item.win { color: #4ade80; }
    .history-item.lose { color: #ff6b6b; }
    
    /* æ‰¹é‡æ¨¡æ‹Ÿç»“æœ */
    .batch-results {
      display: none;
      margin-top: 20px;
    }
    .batch-results.show { display: block; }
    .result-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }
    @media (max-width: 500px) {
      .result-grid { grid-template-columns: 1fr; }
    }
    .result-card {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    .result-card h4 {
      color: rgba(255,255,255,0.6);
      font-size: 0.85rem;
      margin-bottom: 10px;
    }
    .result-card .big-num {
      font-size: 2.2rem;
      font-weight: bold;
    }
    .result-card .big-num.red { color: #ff6b6b; }
    .result-card .big-num.green { color: #4ade80; }
    .result-card .big-num.gold { color: #ffd93d; }
    
    /* åˆ†æåŒº */
    .analysis {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 22px;
      margin-top: 20px;
    }
    .analysis h3 {
      color: #ffd93d;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .analysis p {
      color: rgba(255,255,255,0.85);
      line-height: 1.85;
      margin-bottom: 14px;
    }
    .analysis .formula {
      background: rgba(255,255,255,0.08);
      padding: 12px 16px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      margin: 14px 0;
      overflow-x: auto;
    }
    .analysis .highlight { color: #ff6b6b; font-weight: bold; }
    .analysis .safe { color: #4ade80; font-weight: bold; }
    
    /* éšæœºæ¸¸èµ°å¯è§†åŒ– */
    .walk-visual {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2px;
      flex-wrap: wrap;
      margin: 15px 0;
      padding: 15px;
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
    }
    .walk-step {
      width: 8px;
      height: 20px;
      border-radius: 2px;
      transition: all 0.1s;
    }
    .walk-step.up { background: #4ade80; }
    .walk-step.down { background: #ff6b6b; }
    
    /* ç»“è®º */
    .conclusion {
      background: linear-gradient(135deg, rgba(255,107,107,0.15), rgba(255,217,61,0.1));
      border: 2px solid #ffd93d;
      border-radius: 16px;
      padding: 25px;
      text-align: center;
      margin-top: 20px;
    }
    .conclusion h3 {
      font-size: 1.4rem;
      margin-bottom: 15px;
      color: #ff6b6b;
    }
    .conclusion p {
      color: rgba(255,255,255,0.9);
      line-height: 1.85;
    }
    
    /* æ¸¸æˆç»“æŸå¼¹çª— */
    .game-over-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.85);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
    }
    .game-over-modal.show {
      display: flex;
      animation: modalFadeIn 0.5s ease;
    }
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .game-over-content {
      text-align: center;
      padding: 40px;
      max-width: 500px;
    }
    .game-over-skull {
      font-size: 100px;
      animation: skullBounce 0.6s ease infinite alternate;
    }
    @keyframes skullBounce {
      from { transform: scale(1) rotate(-5deg); }
      to { transform: scale(1.1) rotate(5deg); }
    }
    .game-over-title {
      font-size: 2.5rem;
      font-weight: bold;
      background: linear-gradient(135deg, #ff6b6b, #ffd93d);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 20px 0;
    }
    .game-over-message {
      color: rgba(255,255,255,0.7);
      font-size: 1.1rem;
      line-height: 1.8;
      margin: 20px 0;
    }
    .game-over-btn {
      background: linear-gradient(135deg, #ff6b6b, #ffd93d);
      border: none;
      border-radius: 30px;
      padding: 15px 40px;
      font-size: 1.1rem;
      font-weight: bold;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 20px;
    }
    .game-over-btn:hover {
      transform: translateY(-3px) scale(1.05);
    }
    
    /* åˆ†äº«æŒ‰é’® */
    .share-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 15px 0;
    }
    .share-btn {
      padding: 10px 20px;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .share-btn:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-2px);
    }
    .share-btn.wechat {
      background: rgba(7, 193, 96, 0.3);
      border-color: #07c160;
    }
    
    /* æ¸¸æˆç»“æŸç»Ÿè®¡ */
    .game-over-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 20px 0;
    }
    .game-over-stat {
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      padding: 12px;
    }
    .game-over-stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #ffd93d;
    }
    .game-over-stat-value.negative { color: #ff6b6b; }
    .game-over-stat-value.positive { color: #4ade80; }
    .game-over-stat-label {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      margin-top: 3px;
    }
    
    /* Toast æç¤º */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      font-size: 0.9rem;
      opacity: 0;
      transition: all 0.3s;
      z-index: 10000;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
    <h1>ğŸ° èµŒå¾’ç ´äº§æ‚–è®º</h1>
    <p class="subtitle">50%æ¦‚ç‡ï¼Œä¸ºä»€ä¹ˆèµŒä¹…å¿…è¾“ï¼Ÿ</p>
    
    <div class="card">
      <div class="question-box">
        <strong>é—®é¢˜ï¼š</strong>å‡è®¾èµŒåšè¾“èµ¢æ¦‚ç‡éƒ½æ˜¯ <strong>50%</strong>ï¼Œå’ŒæŠ›ç¡¬å¸ä¸€æ ·å…¬å¹³ã€‚<br>
        æŠ›ç¡¬å¸æ¬¡æ•°å¤šäº†ï¼Œæ­£åé¢æ¯”ç‡åŸºæœ¬ç›¸åŒã€‚<br>
        é‚£ä¸ºä»€ä¹ˆé•¿æœŸèµŒåšçš„äººï¼Œæœ€ç»ˆå¾€å¾€æ˜¯<strong>å€¾å®¶è¡äº§</strong>è€Œä¸æ˜¯æ”¶ç›Šå‡è¡¡ï¼Ÿ
      </div>
      
      <div class="input-row">
        <div class="input-group">
          <label>åˆå§‹èµ„é‡‘ï¼š</label>
          <input type="number" id="initialMoney" value="1000" min="100">
          <span style="color: rgba(255,255,255,0.5);">å…ƒ</span>
        </div>
        <div class="input-group">
          <label>æ¯æ¬¡ä¸‹æ³¨ï¼š</label>
          <input type="number" id="betAmount" value="100" min="10">
          <span style="color: rgba(255,255,255,0.5);">å…ƒ</span>
        </div>
        <div class="input-group">
          <label>ç›®æ ‡é‡‘é¢ï¼š</label>
          <input type="number" id="targetMoney" value="2000" min="100">
          <span style="color: rgba(255,255,255,0.5);">å…ƒ</span>
        </div>
      </div>
      
      <div class="game-area">
        <div class="game-info">
          <div class="info-box">
            <div class="label">å½“å‰èµ„é‡‘</div>
            <div class="value money" id="currentMoney">Â¥1,000</div>
          </div>
          <div class="info-box">
            <div class="label">ä¸‹æ³¨æ¬¡æ•°</div>
            <div class="value round" id="betCount">0</div>
          </div>
          <div class="info-box">
            <div class="label">èƒœç‡</div>
            <div class="value" id="winRate" style="color: #4ade80;">-</div>
          </div>
        </div>
        
        <div class="betting-table">
          <div class="coin-flip" id="coinFlip">ğŸª™</div>
          <div class="result-text" id="resultText">ç‚¹å‡»ä¸‹æ³¨å¼€å§‹æ¸¸æˆ</div>
        </div>
        
        <div class="game-buttons">
          <button class="game-btn bet" id="betBtn" onclick="placeBet()">ğŸ’° ä¸‹æ³¨ 100å…ƒ</button>
          <button class="game-btn auto" id="autoBtn" onclick="autoBet(100)">âš¡ è‡ªåŠ¨100å±€</button>
          <button class="game-btn auto" id="autoUntilBtn" onclick="autoBetUntilEnd()">ğŸ¯ èµŒåˆ°ç»“æŸ</button>
          <button class="game-btn reset" onclick="resetGame()">ğŸ”„ é‡ç½®</button>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas id="moneyChart"></canvas>
      </div>
      
      <div class="history-section">
        <h4>ğŸ“œ æœ€è¿‘è®°å½•</h4>
        <div class="history-list" id="historyList">
          <div style="color: rgba(255,255,255,0.5); text-align: center;">ç­‰å¾…å¼€å§‹...</div>
        </div>
      </div>
    </div>
    
    <!-- æ‰¹é‡æ¨¡æ‹Ÿ -->
    <div class="card">
      <h2 style="margin-bottom: 15px; color: #ffd93d;">ğŸ² è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿï¼š1000ä¸ªèµŒå¾’çš„å‘½è¿</h2>
      <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
        æ¨¡æ‹Ÿ1000ä¸ªäººï¼Œæ¯äºº1000å…ƒæœ¬é‡‘ï¼Œæ¯æ¬¡ä¸‹æ³¨100å…ƒï¼Œ50%æ¦‚ç‡èµ¢/è¾“ã€‚<br>
        ç›®æ ‡ï¼šç¿»å€åˆ°2000å…ƒã€‚çœ‹çœ‹æœ€ç»ˆæœ‰å¤šå°‘äººèƒ½è¾¾æˆç›®æ ‡ï¼Ÿ
      </p>
      
      <div style="text-align: center; margin-bottom: 20px;">
        <button class="game-btn auto" onclick="runMassSimulation()" id="massSimBtn">ğŸš€ è¿è¡Œæ¨¡æ‹Ÿ</button>
      </div>
      
      <div class="batch-results" id="batchResults">
        <div class="result-grid">
          <div class="result-card">
            <h4>ğŸ’€ ç ´äº§äººæ•°</h4>
            <div class="big-num red" id="bankruptCount">-</div>
            <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;">èµ„é‡‘å½’é›¶</div>
          </div>
          <div class="result-card">
            <h4>ğŸ¯ è¾¾æˆç›®æ ‡</h4>
            <div class="big-num green" id="successCount">-</div>
            <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;">ç¿»å€æˆåŠŸ</div>
          </div>
          <div class="result-card">
            <h4>ğŸ“Š å¹³å‡ä¸‹æ³¨æ¬¡æ•°</h4>
            <div class="big-num gold" id="avgBets">-</div>
            <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;">åˆ°è¾¾ç»ˆç‚¹å‰</div>
          </div>
          <div class="result-card">
            <h4>â±ï¸ æœ€é•¿å­˜æ´»</h4>
            <div class="big-num gold" id="maxBets">-</div>
            <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;">ä¸‹æ³¨æ¬¡æ•°</div>
          </div>
        </div>
        
        <div class="chart-container" style="height: 200px; margin-top: 20px;">
          <canvas id="distributionChart"></canvas>
        </div>
      </div>
    </div>
    
    <!-- éšæœºæ¸¸èµ°å¯è§†åŒ– -->
    <div class="card">
      <h2 style="margin-bottom: 15px; color: #ffd93d;">ğŸ“ˆ éšæœºæ¸¸èµ°ï¼šçœ‹çœ‹ä½ çš„èµ„é‡‘è½¨è¿¹</h2>
      <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
        æ¯ä¸€æ¡ç«–çº¿ä»£è¡¨ä¸€æ¬¡ä¸‹æ³¨ï¼š<span style="color: #4ade80;">ç»¿è‰²=èµ¢</span>ï¼Œ<span style="color: #ff6b6b;">çº¢è‰²=è¾“</span>
      </p>
      <div class="walk-visual" id="walkVisual">
        <div style="color: rgba(255,255,255,0.5);">å¼€å§‹ä¸‹æ³¨åæ˜¾ç¤º...</div>
      </div>
      <p style="color: rgba(255,255,255,0.5); font-size: 0.85rem; text-align: center;">
        æ³¨æ„è§‚å¯Ÿï¼šå³ä½¿èµ¢è¾“æ¬¡æ•°ç›¸è¿‘ï¼Œèµ„é‡‘ä¹Ÿå¯èƒ½è§¦åŠè¾¹ç•Œï¼ˆ0æˆ–ç›®æ ‡ï¼‰
      </p>
    </div>
    
    <!-- æ•°å­¦åˆ†æ -->
    <div class="card analysis">
      <h3>ğŸ“ æ•°å­¦è§£é‡Šï¼šä¸ºä»€ä¹ˆ50%æ¦‚ç‡ä¹Ÿä¼šè¾“å…‰</h3>
      
      <p><strong>1. è¿™ä¸æ˜¯æ¦‚ç‡é—®é¢˜ï¼Œæ˜¯ã€Œè¾¹ç•Œå¸æ”¶ã€é—®é¢˜</strong></p>
      <p>
        æŠ›ç¡¬å¸ç¡®å®æ˜¯50%ï¼Œä½†èµŒåšæœ‰ä¸€ä¸ªç¡¬å¸æ²¡æœ‰çš„ä¸œè¥¿ï¼š<span class="highlight">è¾¹ç•Œ</span>ã€‚<br>
        ä½ çš„é’±å¯ä»¥æ— é™å¢é•¿ï¼Œä½†ä¸èƒ½ä½äº0ã€‚ä¸€æ—¦å½’é›¶ï¼Œæ¸¸æˆç»“æŸã€‚
      </p>
      
      <p><strong>2. éšæœºæ¸¸èµ°çš„å¿…ç„¶å½’å®¿</strong></p>
      <p>
        æ•°å­¦ä¸Šï¼Œè¿™å«ã€Œå¸¦å¸æ”¶å£çš„éšæœºæ¸¸èµ°ã€ã€‚æœ‰ä¸€ä¸ªå®šç†ï¼š
      </p>
      <div class="formula">
        åœ¨å…¬å¹³èµŒåšï¼ˆ50%æ¦‚ç‡ï¼‰ä¸­ï¼Œä»ä»»æ„æ­£æ•´æ•°å‡ºå‘çš„éšæœºæ¸¸èµ°ï¼Œ<br>
        <span class="highlight">æœ€ç»ˆå¿…ç„¶ä¼šåˆ°è¾¾0</span>ï¼ˆæ¦‚ç‡ä¸º1ï¼‰
      </div>
      <p>
        æ¢å¥è¯è¯´ï¼šåªè¦ä½ ä¸€ç›´èµŒä¸‹å»ï¼Œç ´äº§æ˜¯<span class="highlight">æ•°å­¦ä¸Šçš„å¿…ç„¶</span>ï¼Œä¸æ˜¯è¿æ°”é—®é¢˜ã€‚
      </p>
      
      <p><strong>3. ã€ŒèµŒå¾’ç ´äº§é—®é¢˜ã€çš„ç»å…¸å…¬å¼</strong></p>
      <p>
        å‡è®¾ä½ æœ‰ n å…ƒï¼Œç›®æ ‡æ˜¯èµ¢åˆ° N å…ƒï¼Œæ¯æ¬¡ä¸‹æ³¨ 1 å…ƒï¼Œ50%æ¦‚ç‡èµ¢/è¾“ï¼š
      </p>
      <div class="formula">
        ç ´äº§æ¦‚ç‡ = (N - n) / N<br>
        æˆåŠŸæ¦‚ç‡ = n / N
      </div>
      <p>
        ä¾‹å¦‚ï¼š1000å…ƒæƒ³ç¿»å€åˆ°2000å…ƒ<br>
        æˆåŠŸæ¦‚ç‡ = 1000/2000 = <span class="safe">50%</span><br>
        ç ´äº§æ¦‚ç‡ = 1000/2000 = <span class="highlight">50%</span>
      </p>
      <p>
        çœ‹èµ·æ¥å…¬å¹³ï¼Ÿä½†é—®é¢˜æ˜¯ï¼š<span class="highlight">ä½ ä¼šä¸€ç›´èµŒä¸‹å»å—ï¼Ÿ</span>
      </p>
      
      <p><strong>4. çœŸæ­£çš„é™·é˜±ï¼šæ— é™æ¸¸æˆ</strong></p>
      <p>
        å¦‚æœä½ çš„ç›®æ ‡æ˜¯ã€Œèµšåˆ°è¶³å¤Ÿå¤šå°±æ”¶æ‰‹ã€ï¼Œé‚£ç¡®å®æœ‰50%æˆåŠŸç‡ã€‚<br>
        ä½†å¤§å¤šæ•°èµŒå¾’çš„å¿ƒæ€æ˜¯ï¼šã€Œèµ¢äº†è¿˜æƒ³èµ¢ï¼Œè¾“äº†æƒ³å›æœ¬ã€ã€‚<br>
        è¿™å°±å˜æˆäº†<span class="highlight">æ— é™æ¸¸æˆ</span>â€”â€”è€Œæ— é™æ¸¸æˆçš„ç»“å±€åªæœ‰ä¸€ä¸ªï¼š
      </p>
      <div class="formula">
        lim(nâ†’âˆ) P(ç ´äº§) = <span class="highlight">100%</span>
      </div>
    </div>
    
    <!-- ä¸ºä»€ä¹ˆæŠ›ç¡¬å¸ä¸ä¼š"ç ´äº§" -->
    <div class="card analysis">
      <h3>ğŸª™ ä¸ºä»€ä¹ˆæŠ›ç¡¬å¸ä¸ä¼š"ç ´äº§"ï¼Ÿ</h3>
      
      <p><strong>å…³é”®åŒºåˆ«ï¼šæŠ›ç¡¬å¸æ²¡æœ‰ã€Œç»ˆæ­¢æ¡ä»¶ã€</strong></p>
      <p>
        æŠ›ç¡¬å¸æ—¶ï¼Œä½ åªæ˜¯åœ¨è®°å½•æ­£åé¢æ¬¡æ•°ï¼Œæ²¡æœ‰ã€Œå½’é›¶å°±åœæ­¢ã€çš„è§„åˆ™ã€‚<br>
        æ‰€ä»¥ä½ å¯ä»¥ä¸€ç›´æŠ›ä¸‹å»ï¼Œå¤§æ•°å®šå¾‹ä¿è¯æ­£åé¢è¶‹è¿‘50%ã€‚
      </p>
      
      <p><strong>ä½†èµŒåšæœ‰ã€Œå¸æ”¶æ€ã€</strong></p>
      <p>
        èµŒåšä¸­ï¼Œã€Œé’±=0ã€æ˜¯ä¸€ä¸ª<span class="highlight">å¸æ”¶æ€</span>â€”â€”ä¸€æ—¦è¿›å…¥ï¼Œæ°¸è¿œæ— æ³•ç¦»å¼€ã€‚<br>
        è¿™å°±åƒä¸€ä¸ªæœ‰é»‘æ´çš„å®‡å®™ï¼šä½ å¯ä»¥åœ¨é‡Œé¢éšæœºæ¸¸èµ°å¾ˆä¹…ï¼Œä½†åªè¦ç¢°åˆ°é»‘æ´ä¸€æ¬¡ï¼Œæ¸¸æˆå°±ç»“æŸäº†ã€‚
      </p>
      
      <p><strong>ç±»æ¯”ï¼šé†‰æ±‰èµ°è·¯</strong></p>
      <p>
        æƒ³è±¡ä¸€ä¸ªé†‰æ±‰åœ¨æ‚¬å´–è¾¹éšæœºèµ°åŠ¨ï¼Œæ¯ä¸€æ­¥50%å‘å‰ã€50%å‘åã€‚<br>
        é—®ï¼šä»–æœ€ç»ˆä¼šæ‰ä¸‹æ‚¬å´–å—ï¼Ÿ<br>
        ç­”ï¼š<span class="highlight">ä¸€å®šä¼š</span>ã€‚åªæ˜¯æ—¶é—´é—®é¢˜ã€‚
      </p>
    </div>
    
    <!-- å…¨çƒç»Ÿè®¡ -->
    <div class="card" style="background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(168, 85, 247, 0.1)); border: 1px solid rgba(0, 212, 255, 0.2);">
      <h2 style="margin-bottom: 20px; color: #00d4ff; text-align: center;">ğŸŒ å…¨çƒèµŒå¾’ç»Ÿè®¡</h2>
      <div class="result-grid">
        <div class="result-card" style="border-top: 3px solid #00d4ff;">
          <h4>ğŸ‘¥ å‚ä¸äººæ•°</h4>
          <div class="big-num gold" id="globalPlayers">-</div>
        </div>
        <div class="result-card" style="border-top: 3px solid #ff6b6b;">
          <h4>ğŸ’€ ç ´äº§äººæ•°</h4>
          <div class="big-num red" id="globalBankrupt">-</div>
          <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;" id="bankruptRate">-</div>
        </div>
        <div class="result-card" style="border-top: 3px solid #4ade80;">
          <h4>ğŸ¯ è¾¾æˆç›®æ ‡</h4>
          <div class="big-num green" id="globalSuccess">-</div>
          <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;" id="successRate">-</div>
        </div>
        <div class="result-card" style="border-top: 3px solid #ffd93d;">
          <h4>ğŸ† æœ€é•¿å­˜æ´»</h4>
          <div class="big-num gold" id="globalMaxBets">-</div>
          <div style="color: rgba(255,255,255,0.5); font-size: 0.8rem; margin-top: 5px;">ä¸‹æ³¨æ¬¡æ•°</div>
        </div>
      </div>
      <p style="text-align: center; color: rgba(255,255,255,0.4); font-size: 0.8rem; margin-top: 15px;">
        å®æ—¶ç»Ÿè®¡ï¼Œçœ‹çœ‹ä½ æ˜¯å¹¸è¿å„¿è¿˜æ˜¯å¤§å¤šæ•°
      </p>
    </div>

    <!-- ç»“è®º -->
    <div class="card conclusion">
      <h3>ğŸ’¡ ç»“è®ºï¼š50%æ¦‚ç‡ â‰  å…¬å¹³æ¸¸æˆ</h3>
      <p>
        èµŒåšçš„ã€Œå…¬å¹³ã€æ˜¯ä¸€ä¸ªå¹»è§‰ã€‚<br><br>
        å³ä½¿æ¯ä¸€å±€éƒ½æ˜¯50%ï¼Œä½†å› ä¸ºå­˜åœ¨<strong>ã€Œå½’é›¶å³å‡ºå±€ã€</strong>çš„è§„åˆ™ï¼Œ<br>
        é•¿æœŸæ¥çœ‹ï¼ŒèµŒå¾’çš„å‘½è¿åªæœ‰ä¸€ä¸ªï¼š<span style="color: #ff6b6b;">ç ´äº§</span>ã€‚<br><br>
        è¿™ä¸æ˜¯è¿æ°”é—®é¢˜ï¼Œæ˜¯<strong>æ•°å­¦å¿…ç„¶</strong>ã€‚<br><br>
        <span style="color: #ffd93d;">ã€Œä¹…èµŒå¿…è¾“ã€ä¸æ˜¯è¿·ä¿¡ï¼Œæ˜¯å®šç†ã€‚</span><br>
        <span style="color: rgba(255,255,255,0.6);">
          å”¯ä¸€çš„èµ¢æ³•æ˜¯ï¼šä¸å‚ä¸ã€‚
        </span>
      </p>
    </div>
  </div>
  
  <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
  <div class="game-over-modal" id="gameOverModal">
    <div class="game-over-content">
      <div class="game-over-skull" id="gameOverIcon">ğŸ’€</div>
      <h2 class="game-over-title" id="gameOverTitle">GAME OVER</h2>
      <div class="game-over-stats">
        <div class="game-over-stat">
          <div class="game-over-stat-value" id="finalBets">-</div>
          <div class="game-over-stat-label">ä¸‹æ³¨æ¬¡æ•°</div>
        </div>
        <div class="game-over-stat">
          <div class="game-over-stat-value" id="finalWinRate">-</div>
          <div class="game-over-stat-label">å®é™…èƒœç‡</div>
        </div>
        <div class="game-over-stat">
          <div class="game-over-stat-value" id="finalPeakMoney">-</div>
          <div class="game-over-stat-label">æœ€é«˜èµ„é‡‘</div>
        </div>
        <div class="game-over-stat">
          <div class="game-over-stat-value" id="finalResult">-</div>
          <div class="game-over-stat-label">æœ€ç»ˆç»“æœ</div>
        </div>
      </div>
      <p class="game-over-message" id="gameOverMessage">
        ä½ çš„èµ„é‡‘å·²ç»å½’é›¶ï¼Œæ— æ³•ç»§ç»­æ¸¸æˆã€‚
      </p>
      <div class="share-buttons">
        <button class="share-btn" onclick="shareToWeibo()">ğŸ“¢ åˆ†äº«åˆ°å¾®åš</button>
        <button class="share-btn wechat" onclick="copyShareText()">ğŸ“‹ å¤åˆ¶æˆ˜ç»©</button>
      </div>
      <button class="game-over-btn" onclick="closeModalAndReset()">ğŸ”„ å†æ¥ä¸€å±€</button>
    </div>
  </div>
  
  <!-- å¤åˆ¶æˆåŠŸæç¤º -->
  <div class="toast" id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>

  <script>
    let money = 1000;
    let initialMoney = 1000;
    let betAmount = 100;
    let targetMoney = 2000;
    let betCount = 0;
    let winCount = 0;
    let peakMoney = 1000;
    let history = [];
    let moneyHistory = [1000];
    let walkHistory = [];
    let chart = null;
    let distributionChart = null;
    let hasRecordedPlayer = false;
    
    // ç»Ÿè®¡ API
    const STATS_API = 'https://demo-api-mockserver.runnable.run/stats';
    const STATS_KEYS = {
      players: 'gambler-ruin-players',
      bankrupt: 'gambler-ruin-bankrupt',
      success: 'gambler-ruin-success',
      maxBets: 'gambler-ruin-max-bets'
    };
    
    // åŠ è½½å…¨çƒç»Ÿè®¡
    async function loadGlobalStats() {
      try {
        const results = await Promise.all([
          fetch(`${STATS_API}?action=get&key=${STATS_KEYS.players}`).then(r => r.json()),
          fetch(`${STATS_API}?action=get&key=${STATS_KEYS.bankrupt}`).then(r => r.json()),
          fetch(`${STATS_API}?action=get&key=${STATS_KEYS.success}`).then(r => r.json()),
          fetch(`${STATS_API}?action=get&key=${STATS_KEYS.maxBets}`).then(r => r.json())
        ]);
        
        const players = results[0].data || 0;
        const bankrupt = results[1].data || 0;
        const success = results[2].data || 0;
        const maxBets = results[3].data || 0;
        
        document.getElementById('globalPlayers').textContent = players.toLocaleString();
        document.getElementById('globalBankrupt').textContent = bankrupt.toLocaleString();
        document.getElementById('globalSuccess').textContent = success.toLocaleString();
        document.getElementById('globalMaxBets').textContent = maxBets.toLocaleString();
        
        if (players > 0) {
          document.getElementById('bankruptRate').textContent = `ç ´äº§ç‡ ${(bankrupt/players*100).toFixed(1)}%`;
          document.getElementById('successRate').textContent = `æˆåŠŸç‡ ${(success/players*100).toFixed(1)}%`;
        }
      } catch (e) {
        console.log('Stats load failed:', e);
      }
    }
    
    // è®°å½•ç©å®¶
    async function recordPlayer() {
      if (hasRecordedPlayer) return;
      hasRecordedPlayer = true;
      try {
        await fetch(`${STATS_API}?action=incr&key=${STATS_KEYS.players}`);
        loadGlobalStats();
      } catch (e) {}
    }
    
    // è®°å½•ç ´äº§
    async function recordBankrupt() {
      try {
        await fetch(`${STATS_API}?action=incr&key=${STATS_KEYS.bankrupt}`);
        // æ£€æŸ¥æ˜¯å¦ç ´çºªå½•
        const res = await fetch(`${STATS_API}?action=get&key=${STATS_KEYS.maxBets}`).then(r => r.json());
        if (betCount > (res.data || 0)) {
          await fetch(`${STATS_API}?action=incr&key=${STATS_KEYS.maxBets}&n=${betCount - (res.data || 0)}`);
        }
        loadGlobalStats();
      } catch (e) {}
    }
    
    // è®°å½•æˆåŠŸ
    async function recordSuccess() {
      try {
        await fetch(`${STATS_API}?action=incr&key=${STATS_KEYS.success}`);
        loadGlobalStats();
      } catch (e) {}
    }
    
    function formatMoney(num) {
      return 'Â¥' + num.toLocaleString();
    }
    
    function updateDisplay() {
      const moneyEl = document.getElementById('currentMoney');
      moneyEl.textContent = formatMoney(money);
      moneyEl.classList.toggle('negative', money < initialMoney);
      
      document.getElementById('betCount').textContent = betCount;
      document.getElementById('winRate').textContent = betCount > 0 
        ? (winCount / betCount * 100).toFixed(1) + '%' 
        : '-';
      
      document.getElementById('betBtn').textContent = `ğŸ’° ä¸‹æ³¨ ${betAmount}å…ƒ`;
      
      // æ›´æ–°å³°å€¼
      if (money > peakMoney) peakMoney = money;
      
      updateChart();
      updateWalkVisual();
    }
    
    function placeBet() {
      if (money <= 0 || money >= targetMoney) return false;
      
      // é¦–æ¬¡ä¸‹æ³¨è®°å½•ç©å®¶
      if (betCount === 0) {
        recordPlayer();
      }
      
      const bet = Math.min(betAmount, money);
      const win = Math.random() < 0.5;
      const coinEl = document.getElementById('coinFlip');
      const resultEl = document.getElementById('resultText');
      
      // ç¡¬å¸åŠ¨ç”»
      coinEl.classList.add('flipping');
      setTimeout(() => coinEl.classList.remove('flipping'), 500);
      
      if (win) {
        money += bet;
        winCount++;
        walkHistory.push(true);
        history.unshift({ win: true, amount: bet, balance: money, round: betCount + 1 });
        resultEl.textContent = `ğŸ‰ èµ¢äº† +${bet}å…ƒï¼`;
        resultEl.className = 'result-text win';
        coinEl.textContent = 'ğŸŸ¡';
      } else {
        money -= bet;
        walkHistory.push(false);
        history.unshift({ win: false, amount: bet, balance: money, round: betCount + 1 });
        resultEl.textContent = `ğŸ’€ è¾“äº† -${bet}å…ƒ`;
        resultEl.className = 'result-text lose';
        coinEl.textContent = 'âš«';
      }
      
      betCount++;
      moneyHistory.push(money);
      
      updateDisplay();
      renderHistory();
      
      // æ£€æŸ¥æ¸¸æˆç»“æŸ
      if (money <= 0) {
        showGameOver(false);
        return false;
      }
      if (money >= targetMoney) {
        showGameOver(true);
        return false;
      }
      
      return true;
    }
    
    function autoBet(times) {
      let count = 0;
      const interval = setInterval(() => {
        if (count >= times || !placeBet()) {
          clearInterval(interval);
        }
        count++;
      }, 30);
    }
    
    function autoBetUntilEnd() {
      const interval = setInterval(() => {
        if (!placeBet()) {
          clearInterval(interval);
        }
      }, 10);
    }
    
    function showGameOver(success) {
      const modal = document.getElementById('gameOverModal');
      const icon = document.getElementById('gameOverIcon');
      const title = document.getElementById('gameOverTitle');
      const message = document.getElementById('gameOverMessage');
      
      // æ›´æ–°ç»Ÿè®¡æ•°æ®
      document.getElementById('finalBets').textContent = betCount;
      document.getElementById('finalWinRate').textContent = (winCount/betCount*100).toFixed(1) + '%';
      document.getElementById('finalPeakMoney').textContent = formatMoney(peakMoney);
      
      if (success) {
        icon.textContent = 'ğŸ‰';
        title.textContent = 'æ­å–œè¾¾æˆç›®æ ‡ï¼';
        title.style.background = 'linear-gradient(135deg, #4ade80, #ffd93d)';
        title.style.webkitBackgroundClip = 'text';
        document.getElementById('finalResult').textContent = 'ç¿»å€æˆåŠŸ';
        document.getElementById('finalResult').className = 'game-over-stat-value positive';
        message.innerHTML = `
          ä½ æˆåŠŸä» ${formatMoney(initialMoney)} èµ¢åˆ°äº† ${formatMoney(money)}ï¼<br>
          <span style="color: #ffd93d;">ä½†è®°ä½ï¼šè¿™åªæ˜¯è¿æ°”ã€‚å†æ¥ä¸€æ¬¡ï¼Œç»“æœå¯èƒ½å®Œå…¨ä¸åŒã€‚</span>
        `;
        recordSuccess();
      } else {
        icon.textContent = 'ğŸ’€';
        title.textContent = 'ç ´äº§äº†ï¼';
        title.style.background = 'linear-gradient(135deg, #ff6b6b, #ffd93d)';
        title.style.webkitBackgroundClip = 'text';
        document.getElementById('finalResult').textContent = 'ç ´äº§';
        document.getElementById('finalResult').className = 'game-over-stat-value negative';
        message.innerHTML = `
          å³ä½¿èƒœç‡æ¥è¿‘50%ï¼Œä½ è¿˜æ˜¯è¾“å…‰äº†ã€‚<br>
          <span style="color: #ff6b6b;">è¿™å°±æ˜¯ã€ŒèµŒå¾’ç ´äº§ã€å®šç†çš„æ®‹é…·ç°å®ã€‚</span>
        `;
        recordBankrupt();
      }
      
      modal.classList.add('show');
      
      document.getElementById('betBtn').disabled = true;
      document.getElementById('autoBtn').disabled = true;
      document.getElementById('autoUntilBtn').disabled = true;
    }
    
    // ç”Ÿæˆåˆ†äº«æ–‡æ¡ˆ
    function getShareText() {
      const result = money >= targetMoney ? 'ç¿»å€æˆåŠŸ ğŸ‰' : 'ç ´äº§äº† ğŸ’€';
      const winRateText = (winCount/betCount*100).toFixed(1);
      return `ã€èµŒå¾’ç ´äº§æ¨¡æ‹Ÿå™¨ã€‘
æˆ‘åœ¨50%æ¦‚ç‡çš„"å…¬å¹³"èµŒåšä¸­æ’‘äº† ${betCount} å±€
èƒœç‡ ${winRateText}%ï¼Œæœ€é«˜èµ„é‡‘ ${formatMoney(peakMoney)}
æœ€ç»ˆç»“æœï¼š${result}

å³ä½¿èƒœç‡æ¥è¿‘50%ï¼Œä¹…èµŒå¿…è¾“æ˜¯æ•°å­¦å®šç†ã€‚
æ¥è¯•è¯•ä½ èƒ½æ’‘å‡ å±€ï¼ŸğŸ‘‰ `;
    }
    
    // åˆ†äº«åˆ°å¾®åš
    function shareToWeibo() {
      const text = encodeURIComponent(getShareText() + window.location.href);
      window.open(`https://service.weibo.com/share/share.php?title=${text}`, '_blank');
    }
    
    // å¤åˆ¶åˆ†äº«æ–‡æ¡ˆ
    function copyShareText() {
      const text = getShareText() + window.location.href;
      navigator.clipboard.writeText(text).then(() => {
        showToast();
      });
    }
    
    // æ˜¾ç¤º toast
    function showToast() {
      const toast = document.getElementById('toast');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }
    
    function closeModalAndReset() {
      document.getElementById('gameOverModal').classList.remove('show');
      resetGame();
    }
    
    function renderHistory() {
      const container = document.getElementById('historyList');
      if (history.length === 0) {
        container.innerHTML = '<div style="color: rgba(255,255,255,0.5); text-align: center;">ç­‰å¾…å¼€å§‹...</div>';
        return;
      }
      
      container.innerHTML = history.slice(0, 15).map(h => `
        <div class="history-item ${h.win ? 'win' : 'lose'}">
          <span>ç¬¬${h.round}æ¬¡ï¼š${h.win ? 'èµ¢ +' : 'è¾“ -'}${h.amount}å…ƒ</span>
          <span>ä½™é¢ï¼š${formatMoney(h.balance)}</span>
        </div>
      `).join('');
    }
    
    function updateChart() {
      const ctx = document.getElementById('moneyChart').getContext('2d');
      
      if (chart) chart.destroy();
      
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: moneyHistory.map((_, i) => i),
          datasets: [{
            label: 'èµ„é‡‘',
            data: moneyHistory,
            borderColor: '#ffd93d',
            backgroundColor: 'rgba(255, 217, 61, 0.1)',
            fill: true,
            tension: 0.1,
            pointRadius: moneyHistory.length > 50 ? 0 : 3
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            annotation: {
              annotations: {
                targetLine: {
                  type: 'line',
                  yMin: targetMoney,
                  yMax: targetMoney,
                  borderColor: '#4ade80',
                  borderWidth: 2,
                  borderDash: [5, 5]
                },
                zeroLine: {
                  type: 'line',
                  yMin: 0,
                  yMax: 0,
                  borderColor: '#ff6b6b',
                  borderWidth: 2,
                  borderDash: [5, 5]
                }
              }
            }
          },
          scales: {
            x: {
              title: { display: true, text: 'ä¸‹æ³¨æ¬¡æ•°', color: 'rgba(255,255,255,0.5)' },
              grid: { color: 'rgba(255,255,255,0.05)' },
              ticks: { color: 'rgba(255,255,255,0.4)' }
            },
            y: {
              title: { display: true, text: 'èµ„é‡‘', color: 'rgba(255,255,255,0.5)' },
              grid: { color: 'rgba(255,255,255,0.05)' },
              ticks: { 
                color: 'rgba(255,255,255,0.4)',
                callback: v => formatMoney(v)
              },
              min: 0,
              max: Math.max(targetMoney, Math.max(...moneyHistory) * 1.1)
            }
          }
        }
      });
    }
    
    function updateWalkVisual() {
      const container = document.getElementById('walkVisual');
      if (walkHistory.length === 0) {
        container.innerHTML = '<div style="color: rgba(255,255,255,0.5);">å¼€å§‹ä¸‹æ³¨åæ˜¾ç¤º...</div>';
        return;
      }
      
      const maxShow = 200;
      const toShow = walkHistory.slice(-maxShow);
      container.innerHTML = toShow.map(win => 
        `<div class="walk-step ${win ? 'up' : 'down'}"></div>`
      ).join('');
    }
    
    function resetGame() {
      initialMoney = parseInt(document.getElementById('initialMoney').value) || 1000;
      betAmount = parseInt(document.getElementById('betAmount').value) || 100;
      targetMoney = parseInt(document.getElementById('targetMoney').value) || 2000;
      
      money = initialMoney;
      betCount = 0;
      winCount = 0;
      peakMoney = initialMoney;
      history = [];
      moneyHistory = [initialMoney];
      walkHistory = [];
      hasRecordedPlayer = false;
      
      document.getElementById('betBtn').disabled = false;
      document.getElementById('autoBtn').disabled = false;
      document.getElementById('autoUntilBtn').disabled = false;
      document.getElementById('resultText').textContent = 'ç‚¹å‡»ä¸‹æ³¨å¼€å§‹æ¸¸æˆ';
      document.getElementById('resultText').className = 'result-text';
      document.getElementById('coinFlip').textContent = 'ğŸª™';
      
      updateDisplay();
      renderHistory();
    }
    
    // æ‰¹é‡æ¨¡æ‹Ÿ
    function runMassSimulation() {
      const btn = document.getElementById('massSimBtn');
      btn.disabled = true;
      btn.textContent = 'æ¨¡æ‹Ÿä¸­...';
      
      setTimeout(() => {
        const people = 1000;
        const initial = 1000;
        const bet = 100;
        const target = 2000;
        
        let bankruptCount = 0;
        let successCount = 0;
        let totalBets = 0;
        let maxBets = 0;
        const finalMoneys = [];
        
        for (let i = 0; i < people; i++) {
          let m = initial;
          let bets = 0;
          
          while (m > 0 && m < target) {
            const b = Math.min(bet, m);
            if (Math.random() < 0.5) {
              m += b;
            } else {
              m -= b;
            }
            bets++;
            
            // é˜²æ­¢æ— é™å¾ªç¯
            if (bets > 100000) break;
          }
          
          if (m <= 0) bankruptCount++;
          if (m >= target) successCount++;
          totalBets += bets;
          maxBets = Math.max(maxBets, bets);
          finalMoneys.push(m);
        }
        
        document.getElementById('bankruptCount').textContent = bankruptCount + ' (' + (bankruptCount/10).toFixed(1) + '%)';
        document.getElementById('successCount').textContent = successCount + ' (' + (successCount/10).toFixed(1) + '%)';
        document.getElementById('avgBets').textContent = Math.round(totalBets / people);
        document.getElementById('maxBets').textContent = maxBets;
        
        document.getElementById('batchResults').classList.add('show');
        
        drawDistribution(finalMoneys, target);
        
        btn.disabled = false;
        btn.textContent = 'ğŸš€ é‡æ–°æ¨¡æ‹Ÿ';
      }, 100);
    }
    
    function drawDistribution(moneys, target) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      
      if (distributionChart) distributionChart.destroy();
      
      const bankruptCount = moneys.filter(m => m <= 0).length;
      const successCount = moneys.filter(m => m >= target).length;
      
      distributionChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['ç ´äº§ (Â¥0)', 'è¾¾æˆç›®æ ‡ (Â¥' + target + ')'],
          datasets: [{
            data: [bankruptCount, successCount],
            backgroundColor: ['rgba(255, 107, 107, 0.7)', 'rgba(74, 222, 128, 0.7)'],
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            x: {
              grid: { display: false },
              ticks: { color: 'rgba(255,255,255,0.6)' }
            },
            y: {
              grid: { color: 'rgba(255,255,255,0.05)' },
              ticks: { color: 'rgba(255,255,255,0.5)' },
              max: 600
            }
          }
        }
      });
    }
    
    // åˆå§‹åŒ–
    updateDisplay();
    renderHistory();
    loadGlobalStats();
    
    // ç›‘å¬è¾“å…¥å˜åŒ–
    document.getElementById('initialMoney').addEventListener('change', resetGame);
    document.getElementById('betAmount').addEventListener('change', resetGame);
    document.getElementById('targetMoney').addEventListener('change', resetGame);
  </script>
</body>
</html>