<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åŸºé‡‘å®šæŠ•æ¨¡æ‹Ÿå™¨ - å®šæŠ•ä¸€å®šèµšé’±å—ï¼Ÿ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', -apple-system, sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      min-height: 100vh;
      color: #e4e4e4;
      padding: 30px 20px;
    }

    .container { max-width: 1000px; margin: 0 auto; }

    .header { text-align: center; margin: 20px 0 40px; }
    .header h1 {
      font-size: 2.2rem;
      font-weight: 700;
      background: linear-gradient(90deg, #10b981, #3b82f6, #10b981);
      background-size: 200% 100%;
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s ease infinite;
    }
    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .header p { color: rgba(255,255,255,0.5); margin-top: 12px; font-size: 15px; }

    .section-title {
      color: rgba(255,255,255,0.6);
      font-size: 14px;
      margin-bottom: 15px;
      padding-left: 10px;
      border-left: 3px solid #10b981;
    }

    .input-section {
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 25px;
      margin-bottom: 25px;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .input-item label {
      display: block;
      color: rgba(255,255,255,0.5);
      font-size: 13px;
      margin-bottom: 8px;
    }
    .input-item input, .input-item select {
      width: 100%;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 12px 15px;
      color: white;
      font-size: 16px;
      font-weight: 600;
    }
    .input-item input:focus, .input-item select:focus {
      outline: none;
      border-color: #10b981;
    }
    .input-item select option { background: #1e293b; }
    .input-item .hint { color: rgba(255,255,255,0.3); font-size: 11px; margin-top: 5px; }

    .controls {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    .btn {
      padding: 14px 35px;
      font-size: 15px;
      font-weight: 600;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #10b981, #3b82f6);
      color: white;
    }
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .btn:hover { transform: translateY(-2px); }

    .results { display: none; }
    .results.show { display: block; }

    /* ç»“æœå¡ç‰‡ */
    .result-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    .result-card {
      background: rgba(255,255,255,0.03);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 20px;
      text-align: center;
    }
    .result-card .label { color: rgba(255,255,255,0.5); font-size: 12px; margin-bottom: 8px; }
    .result-card .value { font-size: 1.8rem; font-weight: 700; }
    .result-card.profit .value { color: #10b981; }
    .result-card.loss .value { color: #ef4444; }
    .result-card.neutral .value { color: #3b82f6; }
    .result-card .sub { color: rgba(255,255,255,0.4); font-size: 12px; margin-top: 5px; }

    /* å›¾è¡¨ */
    .chart-section {
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 25px;
      margin-bottom: 25px;
    }
    .chart-section h3 {
      color: rgba(255,255,255,0.6);
      font-size: 14px;
      margin-bottom: 20px;
      text-align: center;
    }
    .chart-container { position: relative; height: 300px; }

    /* åœºæ™¯å¯¹æ¯” */
    .scenarios {
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 25px;
      margin-bottom: 25px;
    }
    .scenarios h3 {
      color: rgba(255,255,255,0.6);
      font-size: 14px;
      margin-bottom: 20px;
      text-align: center;
    }
    .scenario-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
    }
    .scenario-card {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 20px;
      border-left: 4px solid;
    }
    .scenario-card.win { border-color: #10b981; }
    .scenario-card.lose { border-color: #ef4444; }
    .scenario-card .name { font-weight: 600; margin-bottom: 10px; }
    .scenario-card.win .name { color: #10b981; }
    .scenario-card.lose .name { color: #ef4444; }
    .scenario-card .desc { font-size: 13px; color: rgba(255,255,255,0.5); margin-bottom: 10px; line-height: 1.5; }
    .scenario-card .result { font-size: 18px; font-weight: 700; }
    .scenario-card.win .result { color: #10b981; }
    .scenario-card.lose .result { color: #ef4444; }

    /* ç»“è®º */
    .conclusion {
      background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(59,130,246,0.1));
      border-radius: 16px;
      border: 1px solid rgba(16,185,129,0.2);
      padding: 25px;
      margin-bottom: 25px;
    }
    .conclusion h3 { color: #10b981; font-size: 16px; margin-bottom: 15px; }
    .conclusion p {
      color: rgba(255,255,255,0.7);
      font-size: 14px;
      line-height: 1.8;
      margin-bottom: 10px;
    }
    .conclusion .key-point {
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
    }
    .conclusion .key-point strong { color: #fbbf24; }

    /* åŸç†è¯´æ˜ */
    .explanation {
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 25px;
    }
    .explanation h3 { color: #3b82f6; font-size: 16px; margin-bottom: 15px; }
    .explanation p {
      color: rgba(255,255,255,0.6);
      font-size: 14px;
      line-height: 1.8;
      margin-bottom: 12px;
    }
    .explanation ul {
      list-style: none;
      margin: 15px 0;
    }
    .explanation li {
      padding: 8px 0;
      padding-left: 25px;
      position: relative;
      color: rgba(255,255,255,0.6);
      font-size: 14px;
    }
    .explanation li::before {
      content: 'â€¢';
      position: absolute;
      left: 8px;
      color: #10b981;
    }

    @media (max-width: 600px) {
      .header h1 { font-size: 1.6rem; }
      .result-card .value { font-size: 1.4rem; }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ğŸ“ˆ åŸºé‡‘å®šæŠ•æ¨¡æ‹Ÿå™¨</h1>
    <p>å®šæŠ•ä¸€å®šèµšé’±å—ï¼Ÿç”¨æ•°æ®è¯´è¯</p>
  </div>

  <div class="input-section">
    <div class="section-title">ğŸ’° å®šæŠ•å‚æ•°è®¾ç½®</div>
    <div class="input-grid">
      <div class="input-item">
        <label>æ¯æœˆå®šæŠ•é‡‘é¢</label>
        <input type="number" id="monthlyAmount" value="1000" min="100" step="100">
        <div class="hint">å…ƒ/æœˆ</div>
      </div>
      <div class="input-item">
        <label>å®šæŠ•å¹´é™</label>
        <select id="years">
          <option value="1">1å¹´</option>
          <option value="3" selected>3å¹´</option>
          <option value="5">5å¹´</option>
          <option value="10">10å¹´</option>
          <option value="20">20å¹´</option>
        </select>
      </div>
      <div class="input-item">
        <label>å¸‚åœºèµ°åŠ¿æ¨¡å¼</label>
        <select id="marketPattern">
          <option value="smile">ğŸ˜Š å¾®ç¬‘æ›²çº¿ï¼ˆå…ˆè·Œåæ¶¨ï¼‰</option>
          <option value="frown">ğŸ˜¢ å“­æ³£æ›²çº¿ï¼ˆå…ˆæ¶¨åè·Œï¼‰</option>
          <option value="bull">ğŸ‚ æŒç»­ä¸Šæ¶¨</option>
          <option value="bear">ğŸ» æŒç»­ä¸‹è·Œ</option>
          <option value="volatile">ğŸ¢ å‰§çƒˆéœ‡è¡</option>
          <option value="flat">ğŸ˜ æ¨ªç›˜éœ‡è¡</option>
        </select>
      </div>
      <div class="input-item">
        <label>æ³¢åŠ¨å¹…åº¦</label>
        <select id="volatility">
          <option value="0.1">ä½ï¼ˆÂ±10%ï¼‰</option>
          <option value="0.3" selected>ä¸­ï¼ˆÂ±30%ï¼‰</option>
          <option value="0.5">é«˜ï¼ˆÂ±50%ï¼‰</option>
        </select>
      </div>
    </div>
  </div>

  <div class="controls">
    <button class="btn btn-primary" onclick="runSimulation()">ğŸš€ å¼€å§‹æ¨¡æ‹Ÿ</button>
    <button class="btn btn-secondary" onclick="runAllScenarios()">ğŸ“Š å¯¹æ¯”æ‰€æœ‰åœºæ™¯</button>
  </div>

  <div class="results" id="results">
    <div class="result-cards">
      <div class="result-card neutral">
        <div class="label">æ€»æŠ•å…¥</div>
        <div class="value" id="totalInvest">-</div>
        <div class="sub">æœ¬é‡‘</div>
      </div>
      <div class="result-card" id="finalCard">
        <div class="label">æœ€ç»ˆå¸‚å€¼</div>
        <div class="value" id="finalValue">-</div>
        <div class="sub" id="finalSub">-</div>
      </div>
      <div class="result-card" id="returnCard">
        <div class="label">æ€»æ”¶ç›Šç‡</div>
        <div class="value" id="totalReturn">-</div>
        <div class="sub" id="returnSub">-</div>
      </div>
      <div class="result-card neutral">
        <div class="label">æŒæœ‰ä»½é¢</div>
        <div class="value" id="totalShares">-</div>
        <div class="sub">å¹³å‡æˆæœ¬ <span id="avgCost">-</span></div>
      </div>
    </div>

    <div class="chart-section">
      <h3>ğŸ“ˆ å‡€å€¼èµ°åŠ¿ vs å®šæŠ•æˆæœ¬çº¿</h3>
      <div class="chart-container">
        <canvas id="mainChart"></canvas>
      </div>
    </div>

    <div class="scenarios" id="scenariosSection" style="display:none;">
      <h3>ğŸ­ ä¸åŒå¸‚åœºèµ°åŠ¿ä¸‹çš„å®šæŠ•ç»“æœ</h3>
      <div class="scenario-grid" id="scenarioGrid"></div>
    </div>

    <div class="conclusion" id="conclusion"></div>

    <div class="explanation">
      <h3>ğŸ¤” å®šæŠ•çš„æ ¸å¿ƒé€»è¾‘</h3>
      <p><strong>å®šæŠ•ä¸æ˜¯ç¨³èµšä¸èµ”çš„é­”æ³•</strong>ï¼Œå®ƒçš„æœ¬è´¨æ˜¯"å¹³å‡æˆæœ¬æ³•"ï¼š</p>
      <ul>
        <li>å‡€å€¼ä½æ—¶ï¼ŒåŒæ ·çš„é’±ä¹°æ›´å¤šä»½é¢</li>
        <li>å‡€å€¼é«˜æ—¶ï¼ŒåŒæ ·çš„é’±ä¹°æ›´å°‘ä»½é¢</li>
        <li>é•¿æœŸä¸‹æ¥ï¼ŒæŒä»“æˆæœ¬è¶‹å‘äºå¹³å‡å€¼</li>
      </ul>
      
      <p><strong>å®šæŠ•èµšé’±çš„å‰ææ˜¯ï¼š</strong></p>
      <ul>
        <li>æœ€ç»ˆå–å‡ºæ—¶çš„å‡€å€¼ > ä½ çš„å¹³å‡æˆæœ¬</li>
        <li>å¸‚åœºé•¿æœŸå‘ä¸Šï¼ˆæˆ–è‡³å°‘å›åˆ°èµ·ç‚¹ä»¥ä¸Šï¼‰</li>
        <li>ä½ èƒ½åšæŒåˆ°"å¾®ç¬‘æ›²çº¿"çš„å³åŠè¾¹</li>
      </ul>
      
      <p><strong>å®šæŠ•äºé’±çš„æƒ…å†µï¼š</strong></p>
      <ul>
        <li>æŒç»­ä¸‹è·Œä¸”ä¸åå¼¹ï¼ˆå¦‚æ—¥æœ¬è‚¡å¸‚å¤±è½çš„30å¹´ï¼‰</li>
        <li>å…ˆæ¶¨åè·Œï¼Œé«˜ä½å…¥åœºä½ä½ç¦»åœº</li>
        <li>ä¸­é€”æ”¾å¼ƒï¼Œæ²¡ç­‰åˆ°åå¼¹å°±å‰²è‚‰</li>
      </ul>
      
      <p style="color:#fbbf24; margin-top:15px;">
        ğŸ’¡ å®šæŠ•æ˜¯ä¸€ç§çºªå¾‹æ€§æŠ•èµ„ç­–ç•¥ï¼Œä¸æ˜¯æ”¶ç›Šä¿è¯ã€‚é€‰å¯¹æ ‡çš„ã€åšæŒé•¿æœŸã€åˆç†æ­¢ç›ˆï¼Œæ‰æ˜¯å…³é”®ã€‚
      </p>
    </div>
  </div>
</div>

<script>
let mainChart = null;

// ç”Ÿæˆä¸åŒæ¨¡å¼çš„å‡€å€¼æ›²çº¿
function generateNavCurve(months, pattern, volatility) {
  const nav = [1]; // èµ·å§‹å‡€å€¼ä¸º1
  
  for (let i = 1; i <= months; i++) {
    const progress = i / months;
    let trend = 0;
    
    switch (pattern) {
      case 'smile': // å¾®ç¬‘æ›²çº¿ï¼šå…ˆè·Œåæ¶¨
        trend = -volatility * Math.sin(Math.PI * progress) + volatility * 0.3 * progress;
        break;
      case 'frown': // å“­æ³£æ›²çº¿ï¼šå…ˆæ¶¨åè·Œ
        trend = volatility * Math.sin(Math.PI * progress) - volatility * 0.3 * progress;
        break;
      case 'bull': // æŒç»­ä¸Šæ¶¨
        trend = volatility * progress;
        break;
      case 'bear': // æŒç»­ä¸‹è·Œ
        trend = -volatility * progress;
        break;
      case 'volatile': // å‰§çƒˆéœ‡è¡
        trend = volatility * 0.5 * Math.sin(6 * Math.PI * progress);
        break;
      case 'flat': // æ¨ªç›˜éœ‡è¡
        trend = volatility * 0.2 * Math.sin(8 * Math.PI * progress);
        break;
    }
    
    // æ·»åŠ éšæœºå™ªå£°
    const noise = (Math.random() - 0.5) * volatility * 0.1;
    const newNav = Math.max(0.1, nav[nav.length - 1] * (1 + trend / months + noise));
    nav.push(newNav);
  }
  
  return nav;
}

// è®¡ç®—å®šæŠ•ç»“æœ
function calculateDCA(monthlyAmount, navCurve) {
  let totalShares = 0;
  let totalInvest = 0;
  const costLine = [];
  const valueHistory = [];
  
  for (let i = 0; i < navCurve.length; i++) {
    if (i > 0) {
      // æ¯æœˆå®šæŠ•
      const shares = monthlyAmount / navCurve[i];
      totalShares += shares;
      totalInvest += monthlyAmount;
    }
    
    const avgCost = totalShares > 0 ? totalInvest / totalShares : navCurve[0];
    costLine.push(avgCost);
    valueHistory.push(totalShares * navCurve[i]);
  }
  
  const finalValue = totalShares * navCurve[navCurve.length - 1];
  const totalReturn = totalInvest > 0 ? (finalValue - totalInvest) / totalInvest * 100 : 0;
  const avgCost = totalInvest / totalShares;
  
  return {
    totalInvest,
    totalShares,
    finalValue,
    totalReturn,
    avgCost,
    costLine,
    valueHistory
  };
}

function runSimulation() {
  const monthlyAmount = parseFloat(document.getElementById('monthlyAmount').value) || 1000;
  const years = parseInt(document.getElementById('years').value);
  const pattern = document.getElementById('marketPattern').value;
  const volatility = parseFloat(document.getElementById('volatility').value);
  
  const months = years * 12;
  const navCurve = generateNavCurve(months, pattern, volatility);
  const result = calculateDCA(monthlyAmount, navCurve);
  
  // æ˜¾ç¤ºç»“æœ
  document.getElementById('results').classList.add('show');
  document.getElementById('scenariosSection').style.display = 'none';
  
  document.getElementById('totalInvest').textContent = formatMoney(result.totalInvest);
  document.getElementById('finalValue').textContent = formatMoney(result.finalValue);
  document.getElementById('totalShares').textContent = result.totalShares.toFixed(2);
  document.getElementById('avgCost').textContent = result.avgCost.toFixed(4);
  
  const profit = result.finalValue - result.totalInvest;
  document.getElementById('finalSub').textContent = (profit >= 0 ? '+' : '') + formatMoney(profit);
  document.getElementById('totalReturn').textContent = (result.totalReturn >= 0 ? '+' : '') + result.totalReturn.toFixed(2) + '%';
  
  // è®¾ç½®é¢œè‰²
  const isProfit = result.totalReturn >= 0;
  document.getElementById('finalCard').className = 'result-card ' + (isProfit ? 'profit' : 'loss');
  document.getElementById('returnCard').className = 'result-card ' + (isProfit ? 'profit' : 'loss');
  document.getElementById('returnSub').textContent = isProfit ? 'ç›ˆåˆ©' : 'äºæŸ';
  
  // ç»˜åˆ¶å›¾è¡¨
  drawChart(navCurve, result.costLine, months);
  
  // ç”Ÿæˆç»“è®º
  generateConclusion(pattern, result.totalReturn, years);
  
  document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
}

function runAllScenarios() {
  const monthlyAmount = parseFloat(document.getElementById('monthlyAmount').value) || 1000;
  const years = parseInt(document.getElementById('years').value);
  const volatility = parseFloat(document.getElementById('volatility').value);
  const months = years * 12;
  
  const patterns = [
    { id: 'smile', name: 'ğŸ˜Š å¾®ç¬‘æ›²çº¿', desc: 'å…ˆè·Œåæ¶¨ï¼Œå®šæŠ•æœ€çˆ±' },
    { id: 'frown', name: 'ğŸ˜¢ å“­æ³£æ›²çº¿', desc: 'å…ˆæ¶¨åè·Œï¼Œå®šæŠ•å™©æ¢¦' },
    { id: 'bull', name: 'ğŸ‚ æŒç»­ä¸Šæ¶¨', desc: 'ç‰›å¸‚è¡Œæƒ…' },
    { id: 'bear', name: 'ğŸ» æŒç»­ä¸‹è·Œ', desc: 'ç†Šå¸‚è¡Œæƒ…' },
    { id: 'volatile', name: 'ğŸ¢ å‰§çƒˆéœ‡è¡', desc: 'è¿‡å±±è½¦è¡Œæƒ…' },
    { id: 'flat', name: 'ğŸ˜ æ¨ªç›˜éœ‡è¡', desc: 'ç£¨äººè¡Œæƒ…' }
  ];
  
  const results = patterns.map(p => {
    const navCurve = generateNavCurve(months, p.id, volatility);
    const result = calculateDCA(monthlyAmount, navCurve);
    return { ...p, ...result };
  });
  
  // æ˜¾ç¤ºç»“æœ
  document.getElementById('results').classList.add('show');
  document.getElementById('scenariosSection').style.display = 'block';
  
  // ç”¨ç¬¬ä¸€ä¸ªåœºæ™¯çš„æ•°æ®å¡«å……ä¸»å¡ç‰‡
  const first = results[0];
  document.getElementById('totalInvest').textContent = formatMoney(first.totalInvest);
  document.getElementById('finalValue').textContent = '-';
  document.getElementById('totalShares').textContent = '-';
  document.getElementById('avgCost').textContent = '-';
  document.getElementById('totalReturn').textContent = '-';
  document.getElementById('finalSub').textContent = 'è§ä¸‹æ–¹å¯¹æ¯”';
  document.getElementById('returnSub').textContent = '';
  document.getElementById('finalCard').className = 'result-card neutral';
  document.getElementById('returnCard').className = 'result-card neutral';
  
  // æ¸²æŸ“åœºæ™¯å¯¹æ¯”
  const grid = document.getElementById('scenarioGrid');
  grid.innerHTML = results.map(r => {
    const isWin = r.totalReturn >= 0;
    return `
      <div class="scenario-card ${isWin ? 'win' : 'lose'}">
        <div class="name">${r.name}</div>
        <div class="desc">${r.desc}</div>
        <div class="result">${isWin ? '+' : ''}${r.totalReturn.toFixed(2)}%</div>
      </div>
    `;
  }).join('');
  
  // éšè—å›¾è¡¨ï¼Œæ˜¾ç¤ºå¯¹æ¯”ç»“è®º
  document.querySelector('.chart-section').style.display = 'none';
  
  const winCount = results.filter(r => r.totalReturn >= 0).length;
  document.getElementById('conclusion').innerHTML = `
    <h3>ğŸ“Š åœºæ™¯å¯¹æ¯”ç»“è®º</h3>
    <p>åœ¨ ${years} å¹´å®šæŠ•å‘¨æœŸã€${volatility * 100}% æ³¢åŠ¨å¹…åº¦ä¸‹ï¼š</p>
    <p><strong>${winCount} / 6</strong> ç§å¸‚åœºèµ°åŠ¿èƒ½è®©å®šæŠ•ç›ˆåˆ©ã€‚</p>
    <div class="key-point">
      <strong>å…³é”®å‘ç°ï¼š</strong><br>
      â€¢ å¾®ç¬‘æ›²çº¿ï¼ˆå…ˆè·Œåæ¶¨ï¼‰æ˜¯å®šæŠ•æœ€ç†æƒ³çš„åœºæ™¯<br>
      â€¢ å“­æ³£æ›²çº¿ï¼ˆå…ˆæ¶¨åè·Œï¼‰æ˜¯å®šæŠ•æœ€ç³Ÿç³•çš„åœºæ™¯<br>
      â€¢ æŒç»­ä¸‹è·Œä¸åå¼¹ = å¿…äº<br>
      â€¢ å®šæŠ•ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒåªæ˜¯é™ä½äº†æ‹©æ—¶é£é™©
    </div>
  `;
  
  document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
}

function drawChart(navCurve, costLine, months) {
  document.querySelector('.chart-section').style.display = 'block';
  const ctx = document.getElementById('mainChart').getContext('2d');
  
  if (mainChart) mainChart.destroy();
  
  const labels = Array.from({ length: months + 1 }, (_, i) => {
    if (i === 0) return 'å¼€å§‹';
    if (i % 12 === 0) return `${i/12}å¹´`;
    return '';
  });
  
  mainChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        {
          label: 'åŸºé‡‘å‡€å€¼',
          data: navCurve,
          borderColor: '#3b82f6',
          backgroundColor: 'rgba(59,130,246,0.1)',
          fill: true,
          tension: 0.3,
          pointRadius: 0
        },
        {
          label: 'å¹³å‡æˆæœ¬',
          data: costLine,
          borderColor: '#10b981',
          borderDash: [5, 5],
          fill: false,
          tension: 0.1,
          pointRadius: 0
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: { color: 'rgba(255,255,255,0.7)' }
        }
      },
      scales: {
        x: {
          grid: { color: 'rgba(255,255,255,0.05)' },
          ticks: { color: 'rgba(255,255,255,0.5)' }
        },
        y: {
          grid: { color: 'rgba(255,255,255,0.05)' },
          ticks: { color: 'rgba(255,255,255,0.5)' }
        }
      }
    }
  });
}

function generateConclusion(pattern, returnRate, years) {
  let html = '<h3>ğŸ’¡ æœ¬æ¬¡æ¨¡æ‹Ÿç»“è®º</h3>';
  
  const patternNames = {
    smile: 'å¾®ç¬‘æ›²çº¿ï¼ˆå…ˆè·Œåæ¶¨ï¼‰',
    frown: 'å“­æ³£æ›²çº¿ï¼ˆå…ˆæ¶¨åè·Œï¼‰',
    bull: 'æŒç»­ä¸Šæ¶¨',
    bear: 'æŒç»­ä¸‹è·Œ',
    volatile: 'å‰§çƒˆéœ‡è¡',
    flat: 'æ¨ªç›˜éœ‡è¡'
  };
  
  html += `<p>åœ¨ <strong>${patternNames[pattern]}</strong> çš„å¸‚åœºä¸­å®šæŠ• ${years} å¹´ï¼š</p>`;
  
  if (returnRate >= 20) {
    html += `<p>ğŸ‰ æ”¶ç›Šç‡ <strong style="color:#10b981">${returnRate.toFixed(2)}%</strong>ï¼Œè¡¨ç°ä¼˜ç§€ï¼</p>`;
  } else if (returnRate >= 0) {
    html += `<p>âœ… æ”¶ç›Šç‡ <strong style="color:#10b981">${returnRate.toFixed(2)}%</strong>ï¼Œå®ç°ç›ˆåˆ©ã€‚</p>`;
  } else if (returnRate >= -20) {
    html += `<p>âš ï¸ æ”¶ç›Šç‡ <strong style="color:#ef4444">${returnRate.toFixed(2)}%</strong>ï¼Œå°å¹…äºæŸã€‚</p>`;
  } else {
    html += `<p>âŒ æ”¶ç›Šç‡ <strong style="color:#ef4444">${returnRate.toFixed(2)}%</strong>ï¼ŒäºæŸè¾ƒå¤§ã€‚</p>`;
  }
  
  html += '<div class="key-point">';
  
  switch (pattern) {
    case 'smile':
      html += '<strong>å¾®ç¬‘æ›²çº¿æ˜¯å®šæŠ•çš„æœ€ä½³åœºæ™¯ï¼š</strong><br>ä¸‹è·Œæ—¶ç§¯ç´¯äº†å¤§é‡ä½æˆæœ¬ä»½é¢ï¼Œåå¼¹æ—¶æ”¶ç›Šæ”¾å¤§ã€‚è¿™å°±æ˜¯"åˆ«äººææƒ§æˆ‘è´ªå©ª"çš„æ•°å­¦åŸç†ã€‚';
      break;
    case 'frown':
      html += '<strong>å“­æ³£æ›²çº¿æ˜¯å®šæŠ•çš„å™©æ¢¦ï¼š</strong><br>ä¸Šæ¶¨æ—¶ä¹°å…¥æˆæœ¬é«˜ï¼Œä¸‹è·Œæ—¶å¸‚å€¼ç¼©æ°´ã€‚å¦‚æœä½ åœ¨ç‰›å¸‚é¡¶ç‚¹å¼€å§‹å®šæŠ•ï¼Œå¯èƒ½è¦ç­‰å¾ˆä¹…æ‰èƒ½å›æœ¬ã€‚';
      break;
    case 'bull':
      html += '<strong>æŒç»­ä¸Šæ¶¨æ—¶ï¼š</strong><br>å®šæŠ•èƒ½èµšé’±ï¼Œä½†ä¸å¦‚ä¸€æ¬¡æ€§ä¹°å…¥ã€‚å› ä¸ºä½ åé¢ä¹°çš„æˆæœ¬è¶Šæ¥è¶Šé«˜ï¼Œæ‹‰é«˜äº†å¹³å‡æˆæœ¬ã€‚';
      break;
    case 'bear':
      html += '<strong>æŒç»­ä¸‹è·Œæ—¶ï¼š</strong><br>å®šæŠ•ä¹Ÿæ•‘ä¸äº†ä½ ã€‚è™½ç„¶æˆæœ¬åœ¨é™ä½ï¼Œä½†å¦‚æœå¸‚åœºä¸åå¼¹ï¼Œä½ åªæ˜¯åœ¨"è¶Šè·Œè¶Šä¹°"ã€‚';
      break;
    case 'volatile':
      html += '<strong>å‰§çƒˆéœ‡è¡æ—¶ï¼š</strong><br>å®šæŠ•çš„ä¼˜åŠ¿ä½“ç°å‡ºæ¥äº†â€”â€”é«˜æŠ›ä½å¸è¢«åŠ¨å®ç°ã€‚ä½†æœ€ç»ˆç»“æœå–å†³äºä½ å–å‡ºæ—¶çš„ä½ç½®ã€‚';
      break;
    case 'flat':
      html += '<strong>æ¨ªç›˜éœ‡è¡æ—¶ï¼š</strong><br>å®šæŠ•æ”¶ç›Šæœ‰é™ï¼Œä½†è‡³å°‘ä¸ä¼šå¤§äºã€‚è¿™ç§è¡Œæƒ…è€ƒéªŒè€å¿ƒã€‚';
      break;
  }
  
  html += '</div>';
  
  document.getElementById('conclusion').innerHTML = html;
}

function formatMoney(num) {
  if (num >= 10000) {
    return (num / 10000).toFixed(2) + 'ä¸‡';
  }
  return num.toFixed(0) + 'å…ƒ';
}
</script>

</body>
</html>
