<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è–›å®šè°”çš„é’±ç®±ï¼š50%ç¿»å€oræ¶ˆå¤±ï¼Œæ€ä¹ˆç©æ‰èµšï¼Ÿ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="../components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', -apple-system, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      color: #e4e4e4;
      padding: 20px;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .header { text-align: center; margin: 20px 0 30px; }
    .header h1 {
      font-size: 1.8rem; font-weight: 700;
      background: linear-gradient(90deg, #4ade80, #feca57, #4ade80);
      background-size: 200% 100%;
      background-clip: text; -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s ease infinite;
    }
    @keyframes shimmer { 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%} }
    .header p { color: rgba(255,255,255,0.6); margin-top: 10px; font-size: 14px; }
    .card {
      background: rgba(255,255,255,0.03); border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.08); padding: 25px; margin-bottom: 20px;
    }
    .question-box {
      background: linear-gradient(135deg, rgba(74,222,128,0.1), rgba(254,202,87,0.05));
      border-left: 4px solid #4ade80; padding: 20px;
      border-radius: 0 12px 12px 0; margin-bottom: 20px; line-height: 1.9;
    }
    .question-box strong { color: #feca57; }
    .answer-box {
      text-align: center; padding: 30px 20px;
      background: linear-gradient(135deg, rgba(74,222,128,0.15), rgba(254,202,87,0.1));
      border: 2px solid #4ade80; border-radius: 16px; margin: 20px 0;
    }
    .big-answer { font-size: 2.2rem; font-weight: 800; color: #4ade80; line-height: 1.2; }
    .answer-desc { font-size: 1rem; color: rgba(255,255,255,0.8); margin-top: 15px; line-height: 1.6; }
    .formula-box { background: rgba(0,0,0,0.3); border-radius: 12px; padding: 20px; margin: 20px 0; text-align: center; }
    .formula { font-family: 'Times New Roman', serif; font-size: 1.4rem; color: #feca57; margin: 15px 0; }
    .formula-desc { color: rgba(255,255,255,0.6); font-size: 13px; line-height: 1.8; }
    .setup-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 15px; margin: 20px 0; }
    @media(max-width:600px){ .setup-grid{grid-template-columns:1fr} }
    .setup-item { background: rgba(0,0,0,0.2); border-radius: 10px; padding: 15px; text-align: center; }
    .setup-item label { display: block; color: rgba(255,255,255,0.5); font-size: 12px; margin-bottom: 8px; }
    .setup-item input, .setup-item select {
      width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px; padding: 10px; color: white; font-size: 16px; text-align: center;
    }
    .setup-item input:focus { outline: none; border-color: #4ade80; }
    .controls { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin: 20px 0; }
    .btn { padding: 12px 25px; font-size: 14px; font-weight: 600; border: none; border-radius: 25px; cursor: pointer; transition: all 0.2s; }
    .btn-primary { background: linear-gradient(135deg, #4ade80, #22c55e); color: #1a1a2e; }
    .btn-secondary { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); }
    .btn-gold { background: linear-gradient(135deg, #feca57, #f0b429); color: #1a1a2e; }
    .btn-danger { background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; }
    .btn:hover:not(:disabled) { transform: translateY(-2px); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .stats-row { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; margin: 20px 0; }
    @media(max-width:600px){ .stats-row{grid-template-columns:repeat(2,1fr)} }
    .stat-box { background: rgba(0,0,0,0.2); border-radius: 10px; padding: 15px; text-align: center; }
    .stat-value { font-size: 1.5rem; font-weight: 700; }
    .stat-value.green { color: #4ade80; } .stat-value.red { color: #ff6b6b; } .stat-value.gold { color: #feca57; }
    .stat-label { color: rgba(255,255,255,0.5); font-size: 11px; margin-top: 5px; }
    .chart-container { position: relative; height: 300px; margin: 20px 0; }
    .strategy-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 15px; margin: 20px 0; }
    @media(max-width:700px){ .strategy-grid{grid-template-columns:1fr} }
    .strategy-card { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; text-align: center; border: 2px solid transparent; transition: all 0.3s; cursor: pointer; }
    .strategy-card:hover { border-color: rgba(255,255,255,0.2); }
    .strategy-card.active { border-color: #4ade80; background: rgba(74,222,128,0.1); }
    .strategy-card.optimal { border-color: #feca57; }
    .strategy-card h4 { color: #feca57; margin-bottom: 10px; }
    .strategy-card .pct { font-size: 2rem; font-weight: 700; color: white; }
    .strategy-card .desc { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 8px; }
    .analysis { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 22px; margin-top: 20px; }
    .analysis h3 { color: #feca57; margin-bottom: 15px; font-size: 1.1rem; }
    .analysis p { color: rgba(255,255,255,0.85); line-height: 1.85; margin-bottom: 14px; font-size: 14px; }
    .analysis .highlight { color: #ff6b6b; font-weight: bold; }
    .analysis .safe { color: #4ade80; font-weight: bold; }
    .conclusion {
      background: linear-gradient(135deg, rgba(74,222,128,0.15), rgba(254,202,87,0.1));
      border: 2px solid #feca57; border-radius: 16px; padding: 25px; text-align: center;
    }
    .conclusion h3 { color: #4ade80; font-size: 1.3rem; margin-bottom: 15px; }
    .conclusion p { color: rgba(255,255,255,0.85); line-height: 1.8; font-size: 14px; }
    .conclusion .key-point { color: #feca57; font-weight: 600; }
    .result-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 15px; }
    @media(max-width:500px){ .result-grid{grid-template-columns:1fr} }
    .result-card { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 20px; text-align: center; }
    .result-card h4 { color: rgba(255,255,255,0.6); font-size: 0.85rem; margin-bottom: 10px; }
    .result-card .big-num { font-size: 2rem; font-weight: bold; }
    .result-card .big-num.red { color: #ff6b6b; }
    .result-card .big-num.green { color: #4ade80; }
    .result-card .big-num.gold { color: #feca57; }
    /* ç®±å­åŠ¨ç”» */
    .box-scene { text-align: center; margin: 20px 0; }
    .box-container { display: inline-block; position: relative; width: 120px; height: 120px; margin: 0 auto; }
    .box-emoji { font-size: 80px; line-height: 120px; transition: transform 0.3s; }
    .box-emoji.shake { animation: boxShake 0.5s ease; }
    @keyframes boxShake {
      0%,100%{transform:translateX(0) rotate(0)} 20%{transform:translateX(-8px) rotate(-5deg)}
      40%{transform:translateX(8px) rotate(5deg)} 60%{transform:translateX(-5px) rotate(-3deg)}
      80%{transform:translateX(5px) rotate(3deg)}
    }
    .box-result { font-size: 1.5rem; font-weight: 700; margin-top: 10px; min-height: 40px; }
    .box-result.win { color: #4ade80; } .box-result.lose { color: #ff6b6b; }
    .copy-btn {
      position: fixed; bottom: 20px; right: 20px; padding: 12px 20px;
      background: rgba(74,222,128,0.9); color: #1a1a2e; border: none; border-radius: 25px;
      font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(74,222,128,0.3); transition: all 0.2s;
    }
    .copy-btn:hover { transform: translateY(-2px); }
    .toast {
      position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px);
      background: rgba(0,0,0,0.8); color: white; padding: 12px 24px; border-radius: 25px;
      font-size: 14px; opacity: 0; transition: all 0.3s; z-index: 1000;
    }
    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    .tab-bar { display: flex; gap: 0; margin-bottom: 20px; border-radius: 12px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
    .tab-btn { flex: 1; padding: 12px; text-align: center; background: rgba(0,0,0,0.2); color: rgba(255,255,255,0.5); cursor: pointer; border: none; font-size: 13px; font-weight: 600; transition: all 0.2s; }
    .tab-btn.active { background: rgba(74,222,128,0.15); color: #4ade80; }
    .tab-btn:hover:not(.active) { background: rgba(255,255,255,0.05); }
    .tab-content { display: none; } .tab-content.active { display: block; }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1><i class="ti ti-box"></i> è–›å®šè°”çš„é’±ç®±ï¼š50%ç¿»å€oræ¶ˆå¤±</h1>
    <p>50%æ¦‚ç‡å˜åŒå€ï¼Œ50%æ¦‚ç‡æ¶ˆå¤±ã€‚æ”¾è¿˜æ˜¯ä¸æ”¾ï¼Ÿæ”¾å¤šå°‘ï¼Ÿæ•°å­¦å‘Šè¯‰ä½ æœ€ä¼˜è§£</p>
  </div>

  <!-- é—®é¢˜æè¿° -->
  <div class="card">
    <div class="question-box">
      <strong>é—®é¢˜ï¼š</strong>æœ‰ä¸€ä¸ªç¥å¥‡çš„ç›’å­ï¼š<br>
      <i class="ti ti-circle-check" style="color:#4ade80"></i> æŠŠé’±æ”¾è¿›å»ï¼Œ<strong>50%</strong> æ¦‚ç‡å˜æˆ <strong>2å€</strong>ï¼ˆç¿»å€ï¼‰<br>
      <i class="ti ti-circle-x" style="color:#ff6b6b"></i> ä¹Ÿæœ‰ <strong>50%</strong> æ¦‚ç‡é’±ä¼š <strong>æ¶ˆå¤±ä¸è§</strong><br><br>
      ä»æ¦‚ç‡å­¦å’Œç»æµå­¦çš„è§’åº¦ï¼Œä½ è¯¥æ€ä¹ˆåšæ‰èƒ½åˆ©ç›Šæœ€å¤§åŒ–ï¼Ÿ
    </div>
    <div class="answer-box">
      <div class="big-answer">æ”¾ï¼Œä½†åªæ”¾ä¸€éƒ¨åˆ†</div>
      <div class="answer-desc">
        æœŸæœ›å€¼ä¸ºæ­£ï¼ˆæ¯æ¬¡èµš25%ï¼‰ï¼Œä½†å…¨æŠ¼å¿…æ­»ã€‚<br>
        å‡¯åˆ©å…¬å¼æœ€ä¼˜è§£ï¼šæ¯æ¬¡æ”¾å…¥æ€»èµ„äº§çš„ <span style="color:#feca57;font-weight:700;">25%</span>
      </div>
    </div>
  </div>

  <!-- æ•°å­¦åˆ†æ -->
  <div class="card">
    <h2 style="color:#feca57;margin-bottom:15px;text-align:center;"><i class="ti ti-math-symbols"></i> æ•°å­¦åˆ†æï¼šä¸ºä»€ä¹ˆæœŸæœ›å€¼ä¼šéª—äºº</h2>
    <div class="formula-box">
      <div style="color:rgba(255,255,255,0.7);margin-bottom:10px;">ç®—æœ¯æœŸæœ›å€¼ï¼ˆçœ‹èµ·æ¥å¾ˆç¾ï¼‰</div>
      <div class="formula">E = 0.5 Ã— (+100%) + 0.5 Ã— (-100%) = 0%ï¼Ÿ</div>
      <div class="formula-desc">
        ç­‰ç­‰ï¼Œå¦‚æœèµ¢äº†æ˜¯"å˜æˆ2å€"ï¼Œå³æ”¶ç›Š+100%ï¼Œè¾“äº†æ˜¯"æ¶ˆå¤±"ï¼Œå³æ”¶ç›Š-100%ã€‚<br>
        ä½†å®é™…ä¸Šèµ¢äº†æ‹¿å›2å€æœ¬é‡‘ï¼Œæ‰€ä»¥æœŸæœ›å›æŠ¥ = 0.5 Ã— 2 + 0.5 Ã— 0 = <strong style="color:#4ade80;">1.0</strong>ï¼ˆä¸èµšä¸äºï¼Ÿï¼‰
      </div>
    </div>
    <div class="formula-box">
      <div style="color:rgba(255,255,255,0.7);margin-bottom:10px;">ä½†å¦‚æœ"ç¿»å€"æ˜¯å‡€èµšä¸€å€ï¼ˆæ”¾100æ‹¿å›200ï¼‰</div>
      <div class="formula">E = 0.5 Ã— 2x + 0.5 Ã— 0 = <span style="color:#4ade80;">x</span></div>
      <div class="formula-desc">
        æ”¾å…¥ x å…ƒï¼ŒæœŸæœ›æ‹¿å› x å…ƒã€‚æœŸæœ›å€¼ = æœ¬é‡‘ï¼Œè¿™æ˜¯å…¬å¹³æ¸¸æˆã€‚<br>
        ä½†å¦‚æœ"ç¿»å€"ç†è§£ä¸ºæ”¾100å˜200ï¼ˆå‡€èµš100ï¼‰ï¼Œé‚£æœŸæœ›å€¼ç¡®å®æ˜¯0ã€‚<br><br>
        <strong style="color:#feca57;">å…³é”®é—®é¢˜ï¼šå³ä½¿æœŸæœ›å€¼ä¸ºæ­£æˆ–æŒå¹³ï¼Œå…¨æŠ¼ä¹Ÿæ˜¯ç¾éš¾ã€‚</strong>
      </div>
    </div>
    <div class="formula-box">
      <div style="color:rgba(255,255,255,0.7);margin-bottom:10px;">å‡ ä½•æœŸæœ›å€¼ï¼ˆçœŸæ­£å†³å®šé•¿æœŸå‘½è¿ï¼‰</div>
      <div class="formula">G = (2)^0.5 Ã— (0)^0.5 = <span style="color:#ff6b6b;">0</span></div>
      <div class="formula-desc">
        å…¨æŠ¼çš„å‡ ä½•å¢é•¿ç‡ = 0ã€‚åªè¦è¾“ä¸€æ¬¡ï¼Œä¸€åˆ‡å½’é›¶ã€‚<br>
        <strong style="color:#ff6b6b;">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå…¨æŠ¼å¿…æ­»â€”â€”ä¸æ˜¯æ¦‚ç‡é—®é¢˜ï¼Œæ˜¯æ•°å­¦å¿…ç„¶ã€‚</strong>
      </div>
    </div>
  </div>

  <!-- å‡¯åˆ©å…¬å¼ -->
  <div class="card">
    <h2 style="color:#feca57;margin-bottom:15px;text-align:center;"><i class="ti ti-percentage"></i> å‡¯åˆ©å…¬å¼ï¼šæœ€ä¼˜ä¸‹æ³¨æ¯”ä¾‹</h2>
    <div class="formula-box">
      <div class="formula">f* = p - q/b</div>
      <div class="formula-desc">
        p = èµ¢çš„æ¦‚ç‡ = 0.5ï¼Œq = è¾“çš„æ¦‚ç‡ = 0.5ï¼Œb = èµ”ç‡ = 1ï¼ˆèµ¢äº†å‡€èµš1å€ï¼‰<br>
        f* = 0.5 - 0.5/1 = <strong style="color:#feca57;">0%</strong>ï¼ˆå…¬å¹³æ¸¸æˆï¼Œå‡¯åˆ©å»ºè®®ä¸ç©ï¼‰
      </div>
    </div>
    <div class="formula-box">
      <div style="color:rgba(255,255,255,0.7);margin-bottom:10px;">ä½†å¦‚æœèµ”ç‡æ›´å¥½å‘¢ï¼Ÿæ¯”å¦‚èµ¢äº†å˜3å€ï¼ˆå‡€èµš2å€ï¼‰</div>
      <div class="formula">f* = 0.5 - 0.5/2 = <span style="color:#4ade80;">25%</span></div>
      <div class="formula-desc">
        å¦‚æœèµ¢äº†æ‹¿å›3å€ï¼ˆæ”¾100æ‹¿å›300ï¼‰ï¼Œå‡¯åˆ©æœ€ä¼˜æ¯”ä¾‹æ˜¯25%ã€‚<br>
        ä¸‹é¢çš„æ¨¡æ‹Ÿå™¨é»˜è®¤ç”¨è¿™ä¸ªæ›´æœ‰è¶£çš„è®¾å®šï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‚æ•°ã€‚
      </div>
    </div>
  </div>

  <!-- äº¤äº’ä½“éªŒï¼šæ”¾é’±è¿›ç®±å­ -->
  <div class="card">
    <h2 style="color:#feca57;margin-bottom:15px;text-align:center;"><i class="ti ti-box"></i> äº²æ‰‹è¯•è¯•ï¼šæ”¾é’±è¿›ç®±å­</h2>
    <div class="box-scene">
      <div class="box-container">
        <div class="box-emoji" id="boxEmoji">ğŸ“¦</div>
      </div>
      <div class="box-result" id="boxResult"></div>
    </div>
    <div class="setup-grid" style="grid-template-columns: repeat(2,1fr);">
      <div class="setup-item">
        <label>ä½ çš„æ€»èµ„äº§</label>
        <div class="stat-value gold" id="playerMoney">Â¥10,000</div>
      </div>
      <div class="setup-item">
        <label>æœ¬æ¬¡æ”¾å…¥é‡‘é¢</label>
        <input type="number" id="putAmount" value="2500" min="1">
      </div>
    </div>
    <div style="text-align:center;margin:10px 0;">
      <span style="color:rgba(255,255,255,0.5);font-size:12px;">
        èµ¢äº†æ‹¿å› <span id="winPreview" style="color:#4ade80;">3å€</span>ï¼ˆå«æœ¬é‡‘ï¼‰ï¼Œè¾“äº†å…¨éƒ¨æ¶ˆå¤±
      </span>
    </div>
    <div class="controls">
      <button class="btn btn-primary" onclick="putMoneyInBox()"><i class="ti ti-box"></i> æ”¾è¿›ç®±å­</button>
      <button class="btn btn-gold" onclick="putKelly()"><i class="ti ti-percentage"></i> æŒ‰å‡¯åˆ©æ¯”ä¾‹æ”¾</button>
      <button class="btn btn-danger" onclick="putAll()"><i class="ti ti-flame"></i> å…¨æŠ¼</button>
      <button class="btn btn-secondary" onclick="resetPlayer()"><i class="ti ti-refresh"></i> é‡æ¥</button>
    </div>
    <div class="stats-row" style="grid-template-columns: repeat(3,1fr);">
      <div class="stat-box">
        <div class="stat-value gold" id="playRounds">0</div>
        <div class="stat-label">å·²ç©è½®æ•°</div>
      </div>
      <div class="stat-box">
        <div class="stat-value green" id="playWins">0</div>
        <div class="stat-label">ç¿»å€æ¬¡æ•°</div>
      </div>
      <div class="stat-box">
        <div class="stat-value red" id="playLosses">0</div>
        <div class="stat-label">æ¶ˆå¤±æ¬¡æ•°</div>
      </div>
    </div>
  </div>

  <!-- ç­–ç•¥å¯¹æ¯”æ¨¡æ‹Ÿå™¨ -->
  <div class="card">
    <h2 style="color:#feca57;margin-bottom:15px;text-align:center;"><i class="ti ti-chart-line"></i> ç­–ç•¥å¯¹æ¯”æ¨¡æ‹Ÿå™¨</h2>
    <p style="text-align:center;color:rgba(255,255,255,0.6);font-size:13px;margin-bottom:20px;">
      ä¸åŒä¸‹æ³¨æ¯”ä¾‹ï¼Œ1000è½®åçš„å‘½è¿å¤©å·®åœ°åˆ«
    </p>
    <div class="setup-grid">
      <div class="setup-item">
        <label>åˆå§‹èµ„é‡‘</label>
        <input type="number" id="simInitial" value="10000" min="100">
      </div>
      <div class="setup-item">
        <label>èµ¢äº†æ‹¿å›å‡ å€ï¼ˆå«æœ¬é‡‘ï¼‰</label>
        <input type="number" id="simMultiplier" value="3" min="1.1" step="0.1">
      </div>
      <div class="setup-item">
        <label>æ¨¡æ‹Ÿè½®æ•°</label>
        <input type="number" id="simRounds" value="1000" min="100" max="10000" step="100">
      </div>
    </div>
    <div style="text-align:center;margin:10px 0;">
      <span style="color:rgba(255,255,255,0.6);font-size:13px;">
        å‡¯åˆ©æœ€ä¼˜æ¯”ä¾‹ï¼š<span id="kellyDisplay" style="color:#4ade80;font-weight:bold;">25.0%</span>
      </span>
    </div>
    <div class="strategy-grid">
      <div class="strategy-card" onclick="selectStrat(10)">
        <h4>ä¿å®ˆç­–ç•¥</h4>
        <div class="pct">10%</div>
        <div class="desc">ä½äºå‡¯åˆ©å€¼ï¼Œå¢é•¿æ…¢ä½†ç¨³</div>
      </div>
      <div class="strategy-card optimal active" onclick="selectStrat(25)">
        <h4><i class="ti ti-star"></i> å‡¯åˆ©æœ€ä¼˜</h4>
        <div class="pct" id="kellyStratPct">25%</div>
        <div class="desc">æ•°å­¦æœ€ä¼˜ï¼Œé•¿æœŸå¢é•¿æœ€å¿«</div>
      </div>
      <div class="strategy-card" onclick="selectStrat(50)">
        <h4>æ¿€è¿›ç­–ç•¥</h4>
        <div class="pct">50%</div>
        <div class="desc">è¶…è¿‡å‡¯åˆ©å€¼ï¼Œé«˜æ³¢åŠ¨é«˜é£é™©</div>
      </div>
    </div>
    <div class="controls">
      <button class="btn btn-gold" onclick="runComparison()"><i class="ti ti-chart-bar"></i> ä¸‰ç­–ç•¥å¯¹æ¯”</button>
      <button class="btn btn-primary" onclick="runMassSim()"><i class="ti ti-rocket"></i> 1000äººæ‰¹é‡æ¨¡æ‹Ÿ</button>
    </div>
    <div class="chart-container"><canvas id="strategyChart"></canvas></div>
  </div>

  <!-- æ‰¹é‡æ¨¡æ‹Ÿç»“æœ -->
  <div class="card" id="batchCard" style="display:none;">
    <h2 style="color:#feca57;margin-bottom:15px;text-align:center;"><i class="ti ti-users"></i> 1000äºº Ã— 1000è½® ç»“æœ</h2>
    <div class="result-grid">
      <div class="result-card">
        <h4><i class="ti ti-skull"></i> ç ´äº§äººæ•°ï¼ˆå…¨æŠ¼ï¼‰</h4>
        <div class="big-num red" id="allInBankrupt">-</div>
      </div>
      <div class="result-card">
        <h4><i class="ti ti-skull"></i> ç ´äº§äººæ•°ï¼ˆå‡¯åˆ©ï¼‰</h4>
        <div class="big-num green" id="kellyBankrupt">-</div>
      </div>
      <div class="result-card">
        <h4><i class="ti ti-trending-up"></i> ä¸­ä½æ•°èµ„é‡‘ï¼ˆå‡¯åˆ©ï¼‰</h4>
        <div class="big-num green" id="kellyMedian">-</div>
      </div>
      <div class="result-card">
        <h4><i class="ti ti-trending-down"></i> ä¸­ä½æ•°èµ„é‡‘ï¼ˆå…¨æŠ¼ï¼‰</h4>
        <div class="big-num red" id="allInMedian">-</div>
      </div>
    </div>
    <div class="chart-container" style="height:250px;margin-top:20px;"><canvas id="distChart"></canvas></div>
  </div>

  <!-- åˆ†æ -->
  <div class="card analysis">
    <h3><i class="ti ti-bulb"></i> ä¸ºä»€ä¹ˆä¸èƒ½å…¨æŠ¼ï¼Ÿ</h3>
    <p><strong>1. æœŸæœ›å€¼é™·é˜±</strong></p>
    <p>
      å…¨æŠ¼çš„ç®—æœ¯æœŸæœ›å€¼çœ‹èµ·æ¥ä¸é”™ï¼šæ¯æ¬¡æœŸæœ›æ”¶ç›Š = 0.5 Ã— ç¿»å€ + 0.5 Ã— 0ã€‚<br>
      ä½†<span class="highlight">ç®—æœ¯æœŸæœ›å€¼ä¸ç­‰äºä½ å®é™…ä¼šå¾—åˆ°çš„ç»“æœ</span>ã€‚ä½ åªæ´»ä¸€æ¬¡ï¼Œä¸æ˜¯å¹³è¡Œå®‡å®™çš„å¹³å‡å€¼ã€‚
    </p>
    <p><strong>2. éå†æ€§é—®é¢˜</strong></p>
    <p>
      æ·ç¡¬å¸æ˜¯<span class="highlight">ééå†</span>çš„ï¼š1000ä¸ªäººå„ç©ä¸€æ¬¡çš„å¹³å‡å€¼ â‰  1ä¸ªäººç©1000æ¬¡çš„ç»“æœã€‚<br>
      å…¨æŠ¼ç©1000æ¬¡ï¼Œåªè¦è¾“ä¸€æ¬¡å°±å½’é›¶ã€‚è€Œä½ <span class="safe">ä¸€å®šä¼šè¾“</span>â€”â€”1000æ¬¡å…¨èµ¢çš„æ¦‚ç‡æ˜¯ 2^(-1000) â‰ˆ 0ã€‚
    </p>
    <p><strong>3. å‡ ä½•å¢é•¿ç‡æ‰æ˜¯çœŸç›¸</strong></p>
    <p>
      é•¿æœŸé‡å¤åšå¼ˆä¸­ï¼Œå†³å®šä½ å‘½è¿çš„æ˜¯<span class="safe">å‡ ä½•å¹³å‡æ”¶ç›Šç‡</span>ï¼Œä¸æ˜¯ç®—æœ¯å¹³å‡ã€‚<br>
      å…¨æŠ¼çš„å‡ ä½•å¢é•¿ç‡ = (2Ã—0)^0.5 = 0ã€‚å‡¯åˆ©æ¯”ä¾‹æœ€å¤§åŒ–çš„æ­£æ˜¯å‡ ä½•å¢é•¿ç‡ã€‚
    </p>
  </div>

  <div class="card analysis">
    <h3><i class="ti ti-coin"></i> å®é™…åº”ç”¨ï¼šæŠ•èµ„ä¸­çš„ä»“ä½ç®¡ç†</h3>
    <p>
      è¿™ä¸ªç®±å­é—®é¢˜æœ¬è´¨ä¸Šå°±æ˜¯<span class="safe">ä»“ä½ç®¡ç†</span>é—®é¢˜ã€‚åå°”è¡—çš„é‡åŒ–åŸºé‡‘ã€èŒä¸šå¾·å·æ‰‘å…‹ç©å®¶ï¼Œéƒ½åœ¨ç”¨å‡¯åˆ©å…¬å¼çš„å˜ä½“ã€‚
    </p>
    <p>
      <strong>å®æˆ˜å»ºè®®ï¼š</strong>ç”¨<span class="safe">åŠå‡¯åˆ©</span>ï¼ˆå‡¯åˆ©å€¼çš„ä¸€åŠï¼‰æ›´å®‰å…¨ã€‚å› ä¸ºç°å®ä¸­ä½ æ°¸è¿œä¸çŸ¥é“ç²¾ç¡®çš„èƒœç‡å’Œèµ”ç‡ï¼ŒåŠå‡¯åˆ©ç‰ºç‰²ä¸€ç‚¹å¢é•¿é€Ÿåº¦ï¼Œæ¢å–å¤§å¹…é™ä½çš„ç ´äº§é£é™©ã€‚
    </p>
    <p>
      <strong>æ ¸å¿ƒåŸåˆ™ï¼š</strong><span class="highlight">æ°¸è¿œä¸è¦æŠŠæ‰€æœ‰é¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œ</span>ã€‚ä¸æ˜¯å› ä¸ºé¸¡è›‹ä¼šç¢ï¼Œè€Œæ˜¯å› ä¸ºæ•°å­¦ä¸å…è®¸ã€‚
    </p>
  </div>

  <!-- ç»“è®º -->
  <div class="card conclusion">
    <h3><i class="ti ti-target"></i> ç»“è®º</h3>
    <p>
      50%ç¿»å€ã€50%æ¶ˆå¤±çš„ç®±å­ï¼Œ<span class="key-point">æ”¾é’±è¿›å»æ˜¯å¯¹çš„ï¼Œä½†ç»ä¸èƒ½å…¨æŠ¼</span>ã€‚<br><br>
      å¦‚æœèµ¢äº†æ‹¿å›3å€ï¼Œæœ€ä¼˜ç­–ç•¥æ˜¯æ¯æ¬¡æ”¾å…¥æ€»èµ„äº§çš„ <span class="key-point">25%</span>ã€‚<br>
      å¦‚æœèµ¢äº†åªæ‹¿å›2å€ï¼ˆå‡€èµš1å€ï¼‰ï¼Œè¿™æ˜¯å…¬å¹³æ¸¸æˆï¼Œå‡¯åˆ©å»ºè®® <span class="key-point">ä¸ç©</span>ã€‚<br><br>
      <span style="color:rgba(255,255,255,0.6);">
        åˆ©ç›Šæœ€å¤§åŒ–çš„å…³é”®ä¸æ˜¯"æ”¾ä¸æ”¾"ï¼Œè€Œæ˜¯"æ”¾å¤šå°‘"ã€‚<br>
        è¿™å°±æ˜¯å‡¯åˆ©å…¬å¼çš„æ™ºæ…§ï¼šåœ¨è´ªå©ªå’Œææƒ§ä¹‹é—´ï¼Œæ‰¾åˆ°æ•°å­¦ä¸Šçš„æœ€ä¼˜å¹³è¡¡ç‚¹ã€‚
      </span>
    </p>
  </div>
</div>

<button class="copy-btn" onclick="copyShareText()"><i class="ti ti-clipboard"></i> å¤åˆ¶åˆ†äº«</button>
<div class="toast" id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

<script>
// ========== æ ¸å¿ƒç®—æ³•ï¼ˆå¯ç‹¬ç«‹æµ‹è¯•ï¼‰ ==========
function calcKelly(p, b) {
  // p=èµ¢çš„æ¦‚ç‡, b=å‡€èµ”ç‡(èµ¢äº†å‡€èµšå‡ å€)
  return Math.max(0, p - (1 - p) / b);
}

function simulateRounds(initial, fraction, multiplier, rounds) {
  // multiplier = èµ¢äº†æ‹¿å›å‡ å€(å«æœ¬é‡‘), fraction = ä¸‹æ³¨æ¯”ä¾‹
  let money = initial;
  const history = [money];
  let wins = 0;
  for (let i = 0; i < rounds; i++) {
    if (money < 0.01) { money = 0; history.push(0); continue; }
    const bet = money * fraction;
    if (Math.random() < 0.5) {
      money = money - bet + bet * multiplier; // èµ¢ï¼šæ‹¿å› multiplier å€ä¸‹æ³¨
      wins++;
    } else {
      money = money - bet; // è¾“ï¼šå¤±å»ä¸‹æ³¨
    }
    if (i % 5 === 4 || i === rounds - 1) history.push(money);
  }
  return { finalMoney: money, history, wins };
}

function geometricMeanReturn(fraction, multiplier) {
  // å•æ¬¡çš„ä¸¤ç§ç»“æœï¼šèµ¢ => 1 + fraction*(multiplier-1), è¾“ => 1 - fraction
  const winResult = 1 + fraction * (multiplier - 1);
  const loseResult = 1 - fraction;
  if (loseResult <= 0) return 0;
  return Math.sqrt(winResult * loseResult);
}

// ========== æ‰‹åŠ¨æ”¾é’±ä½“éªŒ ==========
let playerMoney = 10000;
let playRounds = 0, playWins = 0, playLosses = 0;

function getMultiplier() {
  return parseFloat(document.getElementById('simMultiplier').value) || 3;
}

function updatePlayerDisplay() {
  document.getElementById('playerMoney').textContent = formatMoney(playerMoney);
  document.getElementById('playerMoney').className = 'stat-value ' + (playerMoney >= 10000 ? 'gold' : 'red');
  document.getElementById('playRounds').textContent = playRounds;
  document.getElementById('playWins').textContent = playWins;
  document.getElementById('playLosses').textContent = playLosses;
}

function putMoneyInBox() {
  const amount = parseFloat(document.getElementById('putAmount').value);
  if (!amount || amount <= 0 || amount > playerMoney) {
    showToast('é‡‘é¢æ— æ•ˆæˆ–è¶…è¿‡æ€»èµ„äº§'); return;
  }
  doBoxRound(amount);
}

function putKelly() {
  const mult = getMultiplier();
  const kelly = calcKelly(0.5, mult - 1);
  if (kelly <= 0) { showToast('å…¬å¹³æ¸¸æˆï¼Œå‡¯åˆ©å»ºè®®ä¸ç©'); return; }
  const amount = Math.floor(playerMoney * kelly);
  if (amount < 1) { showToast('èµ„é‡‘ä¸è¶³'); return; }
  document.getElementById('putAmount').value = amount;
  doBoxRound(amount);
}

function putAll() {
  doBoxRound(playerMoney);
}

function doBoxRound(amount) {
  const mult = getMultiplier();
  const box = document.getElementById('boxEmoji');
  const result = document.getElementById('boxResult');
  box.classList.add('shake');
  result.textContent = '';
  setTimeout(() => {
    box.classList.remove('shake');
    playRounds++;
    if (Math.random() < 0.5) {
      const winnings = amount * mult;
      playerMoney = playerMoney - amount + winnings;
      playWins++;
      result.className = 'box-result win';
      result.textContent = 'ç¿»å€ï¼æ”¾å…¥ ' + formatMoney(amount) + ' â†’ æ‹¿å› ' + formatMoney(winnings);
    } else {
      playerMoney -= amount;
      playLosses++;
      result.className = 'box-result lose';
      result.textContent = 'æ¶ˆå¤±äº†... ' + formatMoney(amount) + ' æ²¡äº†';
    }
    updatePlayerDisplay();
  }, 500);
}

function resetPlayer() {
  playerMoney = 10000; playRounds = 0; playWins = 0; playLosses = 0;
  document.getElementById('boxResult').textContent = '';
  document.getElementById('putAmount').value = 2500;
  updatePlayerDisplay();
}

// ========== ç­–ç•¥å¯¹æ¯” ==========
let stratChart = null, distChart = null;

function selectStrat(pct) {
  document.querySelectorAll('.strategy-card').forEach(c => c.classList.remove('active'));
  event.currentTarget.classList.add('active');
}

function updateKellyDisplay() {
  const mult = getMultiplier();
  const kelly = calcKelly(0.5, mult - 1);
  document.getElementById('kellyDisplay').textContent = (kelly * 100).toFixed(1) + '%';
  document.getElementById('kellyStratPct').textContent = (kelly * 100).toFixed(1) + '%';
  document.getElementById('winPreview').textContent = mult + 'å€';
}

function runComparison() {
  const initial = parseFloat(document.getElementById('simInitial').value) || 10000;
  const mult = getMultiplier();
  const rounds = parseInt(document.getElementById('simRounds').value) || 1000;
  const kelly = calcKelly(0.5, mult - 1);

  // ç”Ÿæˆå…±äº«éšæœºåºåˆ—
  const randoms = Array.from({length: rounds}, () => Math.random());

  const strategies = [
    { name: 'ä¿å®ˆ(10%)', frac: 0.10, color: '#60a5fa' },
    { name: 'å‡¯åˆ©(' + (kelly*100).toFixed(0) + '%)', frac: kelly, color: '#4ade80' },
    { name: 'æ¿€è¿›(50%)', frac: 0.50, color: '#ff6b6b' }
  ];

  const datasets = strategies.map(s => {
    let m = initial;
    const data = [m];
    for (let i = 0; i < rounds; i++) {
      if (m < 0.01) { m = 0; }
      else {
        const bet = m * s.frac;
        if (randoms[i] < 0.5) { m = m - bet + bet * mult; }
        else { m = m - bet; }
      }
      if (i % 5 === 4 || i === rounds - 1) data.push(m);
    }
    return { label: s.name, data, borderColor: s.color, backgroundColor: 'transparent', tension: 0.1, pointRadius: 0 };
  });

  const ctx = document.getElementById('strategyChart').getContext('2d');
  if (stratChart) stratChart.destroy();
  stratChart = new Chart(ctx, {
    type: 'line',
    data: { labels: datasets[0].data.map((_, i) => i * 5), datasets },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: true, labels: { color: 'rgba(255,255,255,0.7)' } } },
      scales: {
        x: { display: true, title: { display: true, text: 'è½®æ•°', color: 'rgba(255,255,255,0.5)' }, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: 'rgba(255,255,255,0.4)', maxTicksLimit: 10 } },
        y: { display: true, title: { display: true, text: 'èµ„é‡‘', color: 'rgba(255,255,255,0.5)' }, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: 'rgba(255,255,255,0.4)', callback: v => formatMoney(v) }, type: 'logarithmic' }
      }
    }
  });
}

function runMassSim() {
  const initial = parseFloat(document.getElementById('simInitial').value) || 10000;
  const mult = getMultiplier();
  const rounds = parseInt(document.getElementById('simRounds').value) || 1000;
  const kelly = calcKelly(0.5, mult - 1);

  const resultsKelly = [], resultsAllIn = [];
  for (let p = 0; p < 1000; p++) {
    let mk = initial, ma = initial;
    for (let r = 0; r < rounds; r++) {
      const win = Math.random() < 0.5;
      if (mk >= 0.01) { const bk = mk * kelly; mk = win ? mk - bk + bk * mult : mk - bk; }
      if (ma >= 0.01) { ma = win ? ma * mult : 0; }
    }
    resultsKelly.push(mk);
    resultsAllIn.push(ma);
  }

  const bankruptK = resultsKelly.filter(m => m < 1).length;
  const bankruptA = resultsAllIn.filter(m => m < 1).length;
  resultsKelly.sort((a, b) => a - b);
  resultsAllIn.sort((a, b) => a - b);

  document.getElementById('batchCard').style.display = 'block';
  document.getElementById('kellyBankrupt').textContent = bankruptK;
  document.getElementById('allInBankrupt').textContent = bankruptA;
  document.getElementById('kellyMedian').textContent = formatMoney(resultsKelly[500]);
  document.getElementById('allInMedian').textContent = formatMoney(resultsAllIn[500]);

  // åˆ†å¸ƒå›¾
  const ctx = document.getElementById('distChart').getContext('2d');
  if (distChart) distChart.destroy();
  const bucketsK = new Array(20).fill(0), bucketsA = new Array(20).fill(0);
  const labels = [];
  for (let i = 0; i < 20; i++) labels.push(formatMoney(Math.pow(10, i / 2)));
  resultsKelly.forEach(m => { bucketsK[Math.min(19, Math.floor(Math.log10(Math.max(1, m)) * 2))]++; });
  resultsAllIn.forEach(m => { bucketsA[Math.min(19, Math.floor(Math.log10(Math.max(1, m)) * 2))]++; });

  distChart = new Chart(ctx, {
    type: 'bar',
    data: { labels, datasets: [
      { label: 'å‡¯åˆ©ç­–ç•¥', data: bucketsK, backgroundColor: 'rgba(74,222,128,0.6)' },
      { label: 'å…¨æŠ¼ç­–ç•¥', data: bucketsA, backgroundColor: 'rgba(255,107,107,0.6)' }
    ]},
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: true, labels: { color: 'rgba(255,255,255,0.7)' } } },
      scales: {
        x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: 'rgba(255,255,255,0.4)', maxRotation: 45 } },
        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: 'rgba(255,255,255,0.4)' } }
      }
    }
  });
}

// ========== å·¥å…·å‡½æ•° ==========
function formatMoney(num) {
  if (num >= 1e9) return 'Â¥' + (num / 1e9).toFixed(2) + 'B';
  if (num >= 1e6) return 'Â¥' + (num / 1e6).toFixed(2) + 'M';
  if (num >= 1e3) return 'Â¥' + (num / 1e3).toFixed(1) + 'K';
  if (num < 0.01) return 'Â¥0';
  return 'Â¥' + num.toFixed(0);
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

function copyShareText() {
  const mult = getMultiplier();
  const kelly = calcKelly(0.5, mult - 1);
  const text = `ã€è–›å®šè°”çš„é’±ç®±ã€‘
50%æ¦‚ç‡ç¿»${mult}å€ï¼Œ50%æ¦‚ç‡æ¶ˆå¤±ã€‚ä½ ä¼šæ”¾é’±è¿›å»å—ï¼Ÿ

ç­”æ¡ˆï¼šæ”¾ï¼Œä½†åªæ”¾æ€»èµ„äº§çš„${(kelly*100).toFixed(0)}%ï¼ˆå‡¯åˆ©å…¬å¼æœ€ä¼˜è§£ï¼‰ã€‚

å…¨æŠ¼å¿…æ­»â€”â€”ä¸æ˜¯è¿æ°”é—®é¢˜ï¼Œæ˜¯æ•°å­¦å¿…ç„¶ã€‚
æ¥è¯•è¯•ä¸åŒç­–ç•¥çš„æ¨¡æ‹Ÿæ•ˆæœ ğŸ‘‰ ${window.location.href}`;
  navigator.clipboard.writeText(text).then(() => showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'));
}

// ç›‘å¬å‚æ•°å˜åŒ–
document.getElementById('simMultiplier').addEventListener('change', updateKellyDisplay);

// åˆå§‹åŒ–
updatePlayerDisplay();
updateKellyDisplay();
</script>
</body>
</html>
