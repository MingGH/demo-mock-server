<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åäº¿å…ƒæŒ‰é’® - ä½ ä¼šæŒ‰å—ï¼Ÿ</title>
  <script src="../components/header.js" defer></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0f; min-height: 100vh; color: #fff; overflow-x: hidden; }
    .container { max-width: 800px; margin: 0 auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    h1 { text-align: center; font-size: 2rem; margin-bottom: 10px; color: #ff4444; text-shadow: 0 0 30px rgba(255,68,68,0.5); }
    .subtitle { text-align: center; color: rgba(255,255,255,0.6); margin-bottom: 40px; font-size: 0.95rem; line-height: 1.6; }
    .warning-box { background: rgba(255,68,68,0.1); border: 1px solid rgba(255,68,68,0.3); border-radius: 12px; padding: 20px; margin-bottom: 40px; text-align: center; max-width: 500px; }
    .warning-box p { color: rgba(255,255,255,0.8); line-height: 1.8; font-size: 0.95rem; }
    .warning-box strong { color: #ffd700; }
    .warning-box .red { color: #ff4444; }
    .button-container { position: relative; margin: 40px 0; }
    .doom-button { width: 250px; height: 250px; border-radius: 50%; border: none; background: linear-gradient(145deg, #ff4444, #cc0000); box-shadow: 0 0 60px rgba(255,68,68,0.4), 0 20px 60px rgba(0,0,0,0.5), inset 0 -10px 30px rgba(0,0,0,0.3), inset 0 10px 30px rgba(255,255,255,0.1); cursor: pointer; font-size: 1.5rem; font-weight: bold; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.5); transition: all 0.15s; position: relative; z-index: 10; }
    .doom-button:hover { transform: scale(1.05); box-shadow: 0 0 80px rgba(255,68,68,0.6), 0 20px 60px rgba(0,0,0,0.5), inset 0 -10px 30px rgba(0,0,0,0.3), inset 0 10px 30px rgba(255,255,255,0.1); }
    .doom-button:active { transform: scale(0.95); }
    .doom-button.pressed { animation: shake 0.5s ease; }
    .doom-button.disabled { background: linear-gradient(145deg, #444, #333); box-shadow: 0 0 20px rgba(100,100,100,0.2); cursor: not-allowed; }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-10px); } 40%, 80% { transform: translateX(10px); } }
    .glow-ring { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 280px; height: 280px; border-radius: 50%; border: 2px solid rgba(255,68,68,0.3); animation: pulse 2s ease-in-out infinite; pointer-events: none; }
    @keyframes pulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; } 50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.2; } }
    .stats { display: flex; gap: 20px; margin-top: 40px; flex-wrap: wrap; justify-content: center; }
    .stat-box { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px 25px; text-align: center; min-width: 140px; }
    .stat-num { font-size: 1.8rem; font-weight: bold; color: #ffd700; font-family: 'Courier New', monospace; }
    .stat-num.red { color: #ff4444; }
    .stat-label { color: rgba(255,255,255,0.5); font-size: 0.75rem; margin-top: 5px; }
    .my-stats { margin-top: 20px; color: rgba(255,255,255,0.4); font-size: 0.85rem; }
    .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
    .modal.show { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content { text-align: center; padding: 40px; max-width: 500px; background: rgba(20,20,30,0.9); border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); }
    .modal-icon { font-size: 80px; margin-bottom: 20px; animation: bounce 0.5s ease; }
    @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
    .modal-title { font-size: 1.8rem; margin-bottom: 15px; }
    .modal-text { color: rgba(255,255,255,0.7); line-height: 1.8; margin-bottom: 25px; font-size: 0.95rem; }
    .modal-btn { padding: 12px 35px; border: none; border-radius: 25px; font-size: 1rem; cursor: pointer; background: linear-gradient(90deg, #ffd700, #ffaa00); color: #000; font-weight: bold; transition: all 0.2s; }
    .modal-btn:hover { transform: scale(1.05); }
    .modal-sub { margin-top: 15px; color: rgba(255,255,255,0.3); font-size: 0.8rem; }
    .result-money .modal-title { color: #ffd700; }
    .result-nothing .modal-title { color: #888; }
    .result-moral .modal-title { color: #4ade80; }
    .result-bug .modal-title { color: #ff6b6b; }
    .result-secret .modal-title { color: #a855f7; }
    .result-meta .modal-title { color: #00d4ff; }
    .footer-note { margin-top: 30px; color: rgba(255,255,255,0.2); font-size: 0.75rem; text-align: center; max-width: 400px; }
    .press-hint { margin-top: 15px; color: rgba(255,255,255,0.3); font-size: 0.8rem; }
    .countdown { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 15rem; font-weight: bold; color: #ff4444; text-shadow: 0 0 100px rgba(255,68,68,0.8); z-index: 2000; display: none; animation: countPulse 1s ease; }
    @keyframes countPulse { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.2); } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
    .screen-flash { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: white; z-index: 1999; display: none; animation: flash 0.5s ease; }
    @keyframes flash { 0% { opacity: 1; } 100% { opacity: 0; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ’€ åäº¿å…ƒæŒ‰é’®</h1>
    <p class="subtitle">æŒ‰ä¸‹å»è·å¾—åäº¿å…ƒï¼Œä½†500å¹´åäººç±»æ¯ç­</p>
    <div class="warning-box">
      <p>
        <strong>è§„åˆ™ï¼š</strong><br>
        1. è¿™ä¸ªæŒ‰é’®åªæœ‰ä½ çŸ¥é“ï¼Œåªæœ‰ä½ èƒ½æŒ‰<br>
        2. æŒ‰ä¸‹åè·å¾— <strong>10äº¿å…ƒ</strong><br>
        3. ä½† <span class="red">500å¹´åäººç±»æ¯ç­</span><br>
        4. åªèƒ½æŒ‰ä¸€æ¬¡<br><br>
        ä½ ä¼šæŒ‰å—ï¼Ÿ
      </p>
    </div>
    <div class="button-container">
      <div class="glow-ring"></div>
      <button class="doom-button" id="doomBtn" onclick="pressButton()">æŒ‰ä¸‹è·å¾—<br>ğŸ’° 10äº¿å…ƒ</button>
    </div>
    <p class="press-hint" id="pressHint">ä½ è¿˜æ²¡æŒ‰è¿‡è¿™ä¸ªæŒ‰é’®</p>
    <div class="stats">
      <div class="stat-box">
        <div class="stat-num" id="totalPress">-</div>
        <div class="stat-label">å…¨çƒæŒ‰ä¸‹æ¬¡æ•°</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" id="totalUsers">-</div>
        <div class="stat-label">å‚ä¸äººæ•°</div>
      </div>
      <div class="stat-box">
        <div class="stat-num red" id="doomYear">2525</div>
        <div class="stat-label">äººç±»æ¯ç­å¹´ä»½</div>
      </div>
    </div>
    <p class="my-stats" id="myStats"></p>
    <p class="footer-note">* æœ¬æŒ‰é’®ä¸ºè™šæ‹ŸæŒ‰é’®ï¼ŒæŒ‰ä¸‹åä¸ä¼šçœŸçš„è·å¾—10äº¿å…ƒï¼Œäººç±»ä¹Ÿä¸ä¼šæ¯ç­ï¼ˆå¤§æ¦‚ï¼‰<br>* ç»Ÿè®¡æ•°æ®ä¸ºå…¨çƒçœŸå®ç”¨æˆ·æ•°æ®</p>
  </div>
  <div class="countdown" id="countdown"></div>
  <div class="screen-flash" id="screenFlash"></div>
  <div class="modal" id="resultModal"><div class="modal-content" id="modalContent"></div></div>

  <script>
    const API_BASE = 'https://demo-api-mockserver.runnable.run';
    let myPressCount = parseInt(localStorage.getItem('doomMyPress') || '0');
    let hasEverPressed = localStorage.getItem('doomEverPressed') === 'true';
    let isProcessing = false;
    
    // å½©è›‹ç»“æœæ± 
    const results = [
      { type: 'nothing', icon: 'ğŸ¤·', title: 'ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿ', text: 'ä½ æŒ‰ä¸‹äº†æŒ‰é’®...<br><br>ç„¶åä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿã€‚<br><br>ä½ ä»¥ä¸ºä¼šæœ‰10äº¿ï¼Ÿé†’é†’ï¼Œè¿™åªæ˜¯ä¸ªç½‘é¡µã€‚' },
      { type: 'money', icon: 'ğŸ’¸', title: 'æ­å–œè·å¾—10äº¿å…ƒï¼', text: 'å¼€ç©ç¬‘çš„ã€‚<br><br>ä½ çœŸçš„ä»¥ä¸ºæŒ‰ä¸ªç½‘é¡µæŒ‰é’®å°±èƒ½æ‹¿10äº¿ï¼Ÿ<br><br>ä¸è¿‡ä½ çš„å‹‡æ°”å€¼å¾—è¡¨æ‰¬ï¼Œæ¯•ç«Ÿä½ æ„¿æ„ä¸ºäº†é’±æ¯ç­500å¹´åçš„äººç±»ã€‚' },
      { type: 'moral', icon: 'ğŸ˜‡', title: 'é“å¾·æµ‹è¯•é€šè¿‡', text: 'å…¶å®è¿™æ˜¯ä¸ªé“å¾·æµ‹è¯•...<br><br>å¼€ç©ç¬‘çš„ï¼Œè¿™å°±æ˜¯ä¸ªæ™®é€šæŒ‰é’®ã€‚<br><br>ä½†è¯´çœŸçš„ï¼Œä½ æŒ‰ä¹‹å‰æœ‰çŠ¹è±«å—ï¼Ÿ' },
      { type: 'bug', icon: 'ğŸ›', title: 'Error: ä½™é¢ä¸è¶³', text: 'ç³»ç»Ÿæç¤ºï¼šå‘æ”¾10äº¿å…ƒå¤±è´¥<br><br>åŸå› ï¼šæœåŠ¡å™¨ä½™é¢ä¸è¶³<br>å»ºè®®ï¼šè¯·è”ç³»ç®¡ç†å‘˜å……å€¼<br><br>ï¼ˆç®¡ç†å‘˜å·²è·‘è·¯ï¼‰' },
      { type: 'nothing', icon: 'â°', title: '500å¹´åè§', text: 'æŒ‰é’®å·²ç”Ÿæ•ˆï¼<br><br>è¯·äº500å¹´åæŸ¥æ”¶äººç±»æ¯ç­é€šçŸ¥ã€‚<br><br>sincerely,<br>æ¯ç­äººç±»å§”å‘˜ä¼š<br><br>ï¼ˆ10äº¿å…ƒï¼Ÿé‚£ä¸ªæˆ‘ä»¬å¿˜äº†ï¼‰' },
      { type: 'money', icon: 'ğŸ¦', title: 'è½¬è´¦å¤„ç†ä¸­', text: 'æ­£åœ¨å‘æ‚¨çš„è´¦æˆ·è½¬å…¥10äº¿å…ƒ...<br><br>é¢„è®¡åˆ°è´¦æ—¶é—´ï¼š500å¹´å<br><br>å±Šæ—¶äººç±»å·²æ¯ç­ï¼Œsincerely' },
      { type: 'secret', icon: 'ğŸ‘€', title: 'æœ‰äººåœ¨çœ‹ç€ä½ ', text: 'ä½ ä»¥ä¸ºæ²¡äººçŸ¥é“ï¼Ÿ<br><br>æˆ‘ä»¬è®°å½•äº†æ¯ä¸€æ¬¡æŒ‰ä¸‹ã€‚<br><br>500å¹´åçš„äººç±»ä¼šçŸ¥é“æ˜¯è°æ¯ç­äº†ä»–ä»¬ã€‚<br><br>ï¼ˆå¼€ç©ç¬‘çš„ï¼Œæˆ‘ä»¬åªè®°å½•æ¬¡æ•°ï¼‰' },
      { type: 'meta', icon: 'ğŸ¤”', title: 'ä½ åœ¨æƒ³ä»€ä¹ˆï¼Ÿ', text: 'ä½ æ˜çŸ¥é“è¿™æ˜¯ä¸ªå‡æŒ‰é’®ï¼Œ<br>è¿˜æ˜¯æŒ‰äº†ã€‚<br><br>è¿™è¯´æ˜ä»€ä¹ˆï¼Ÿ<br><br>è¯´æ˜ä½ å’Œå…¶ä»– <span id="otherUsers">???</span> ä¸ªäººä¸€æ ·ï¼Œ<br>éƒ½æƒ³è¯•è¯•çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚' },
      { type: 'bug', icon: 'ğŸ’€', title: 'äººç±»å·²æ¯ç­', text: 'ç³Ÿç³•ï¼ŒæŒ‰é’®åäº†ï¼Œ<br>äººç±»æå‰æ¯ç­äº†ã€‚<br><br>...<br><br>å¼€ç©ç¬‘çš„ï¼Œåˆ·æ–°é¡µé¢å°±å¥½äº†ã€‚' },
      { type: 'secret', icon: 'ğŸ°', title: 'éšè—å½©è›‹', text: 'æ­å–œä½ è§¦å‘äº†éšè—å½©è›‹ï¼<br><br>å¥–åŠ±ï¼šæ— <br><br>ä½†ä½ å¯ä»¥æˆªå›¾å‘æœ‹å‹åœˆç‚«è€€ä¸€ä¸‹ã€‚' },
      { type: 'nothing', icon: 'ğŸ“', title: 'æ¥ç”µæé†’', text: 'ã€æœªæ¥æ¥ç”µã€‘<br><br>"å–‚ï¼Ÿæˆ‘æ˜¯500å¹´åçš„äººç±»ä»£è¡¨ã€‚<br>æˆ‘ä»¬æŸ¥åˆ°æ˜¯ä½ æŒ‰çš„æŒ‰é’®ã€‚<br>ä½ æœ‰ä»€ä¹ˆæƒ³è¯´çš„å—ï¼Ÿ"<br><br>ï¼ˆå¯¹æ–¹å·²æŒ‚æ–­ï¼‰' },
      { type: 'moral', icon: 'âš–ï¸', title: 'é“å¾·æ³•åº­', text: 'ã€å®¡åˆ¤ç»“æœã€‘<br><br>è¢«å‘Šï¼šä½ <br>ç½ªåï¼šä¸º10äº¿å…ƒæ¯ç­äººç±»<br>åˆ¤å†³ï¼šæ— ç½ª<br><br>ç†ç”±ï¼šåæ­£æ˜¯500å¹´åçš„äº‹ï¼Œ<br>è€Œä¸”è¿™åªæ˜¯ä¸ªç½‘é¡µæŒ‰é’®ã€‚' },
      { type: 'money', icon: 'ğŸ“Š', title: 'æ”¶ç›Šåˆ†æ', text: '10äº¿å…ƒ Ã· 500å¹´ = 200ä¸‡/å¹´<br><br>è€ƒè™‘åˆ°é€šè´§è†¨èƒ€ï¼Œ<br>500å¹´åçš„10äº¿å¯èƒ½åªå€¼ç°åœ¨çš„1å—é’±ã€‚<br><br>æ‰€ä»¥ä½ å…¶å®æ˜¯ç”¨1å—é’±æ¯ç­äº†äººç±»ã€‚<br><br>è¡€äºã€‚' },
      { type: 'secret', icon: 'ğŸ”®', title: 'é¢„è¨€', text: 'æˆ‘çœ‹åˆ°äº†ä½ çš„æœªæ¥...<br><br>ä½ ä¼šç»§ç»­æŒ‰è¿™ä¸ªæŒ‰é’®ï¼Œ<br>ç›´åˆ°çœ‹å®Œæ‰€æœ‰å½©è›‹ã€‚<br><br>ç„¶åä½ ä¼šæŠŠè¿™ä¸ªé¡µé¢åˆ†äº«ç»™æœ‹å‹ï¼Œ<br>çœ‹ä»–ä»¬ä¼šä¸ä¼šæŒ‰ã€‚' },
      { type: 'meta', icon: 'ğŸ–¥ï¸', title: 'ç¬¬å››é¢å¢™', text: 'ä½ å¥½ï¼Œæˆ‘æ˜¯è¿™ä¸ªæŒ‰é’®çš„å¼€å‘è€…ã€‚<br><br>æˆ‘åšè¿™ä¸ªé¡µé¢èŠ±äº†1å°æ—¶ï¼Œ<br>ä½ æŒ‰è¿™ä¸ªæŒ‰é’®èŠ±äº†0.1ç§’ã€‚<br><br>æˆ‘ä»¬éƒ½åœ¨æµªè´¹ç”Ÿå‘½ï¼Œ<br>ä½†è‡³å°‘ä½ ç¬‘äº†ï¼ˆå§ï¼Ÿï¼‰' }
    ];
    
    // ç‰¹æ®Šå½©è›‹ï¼ˆæ ¹æ®æŒ‰ä¸‹æ¬¡æ•°è§¦å‘ï¼‰
    const specialResults = {
      1: { type: 'nothing', icon: 'ğŸ‰', title: 'ç¬¬ä¸€æ¬¡ï¼', text: 'è¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡æŒ‰ä¸‹æ¯ç­æŒ‰é’®ã€‚<br><br>è®°ä½è¿™ä¸ªæ—¶åˆ»ï¼Œ<br>ä½ æ­£å¼æˆä¸ºäº†"æ„¿æ„ä¸º10äº¿æ¯ç­äººç±»"çš„äººä¹‹ä¸€ã€‚<br><br>æ¬¢è¿åŠ å…¥ã€‚' },
      5: { type: 'secret', icon: 'ğŸ”„', title: 'ä½ è¿˜åœ¨æŒ‰ï¼Ÿ', text: 'è¿™å·²ç»æ˜¯ä½ ç¬¬5æ¬¡æŒ‰äº†ã€‚<br><br>ä½ çŸ¥é“è¿™ä¸ªæŒ‰é’®ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿçš„ï¼Œå¯¹å§ï¼Ÿ<br><br>...å¯¹å§ï¼Ÿ' },
      10: { type: 'meta', icon: 'ğŸ†', title: 'åè¿æŠ½è¾¾æˆ', text: 'æ­å–œï¼ä½ å·²ç»æŒ‰äº†10æ¬¡ï¼<br><br>å¦‚æœæ¯æ¬¡éƒ½èƒ½æ‹¿10äº¿ï¼Œ<br>ä½ ç°åœ¨å·²ç»æœ‰100äº¿äº†ã€‚<br><br>å¯æƒœä½ ä¸€åˆ†é’±éƒ½æ²¡æœ‰ã€‚' },
      20: { type: 'secret', icon: 'ğŸ˜…', title: 'è®¤çœŸçš„ï¼Ÿ', text: '20æ¬¡äº†...<br><br>ä½ æ˜¯åœ¨æ‰¾ä»€ä¹ˆå½©è›‹å—ï¼Ÿ<br><br>å¥½å§ï¼Œè¿™å°±æ˜¯å½©è›‹ã€‚<br>ä½ æ‰¾åˆ°äº†ã€‚<br>æ»¡æ„äº†å—ï¼Ÿ' },
      50: { type: 'secret', icon: 'ğŸ‘‘', title: 'æ¯ç­ä¹‹ç‹', text: '50æ¬¡ï¼<br><br>å¦‚æœè¿™ä¸ªæŒ‰é’®æ˜¯çœŸçš„ï¼Œ<br>ä½ å·²ç»æ¯ç­äººç±»50æ¬¡äº†ã€‚<br><br>æˆäºˆä½ "äººç±»å…¬æ•Œ"ç§°å·ã€‚<br><br>ï¼ˆè£èª‰ç§°å·ï¼Œä¸å«å¥–é‡‘ï¼‰' },
      100: { type: 'meta', icon: 'ğŸŠ', title: 'ç™¾æ¬¡æˆå°±', text: '100æ¬¡ï¼ï¼ï¼<br><br>æˆ‘çœŸçš„æ²¡æƒ³åˆ°æœ‰äººä¼šæŒ‰100æ¬¡ã€‚<br><br>ä½ èµ¢äº†ã€‚<br>è¿™ä¸ªé¡µé¢æ²¡æœ‰æ›´å¤šå½©è›‹äº†ã€‚<br><br>...æˆ–è€…æœ‰ï¼Ÿ' }
    };

    // åˆå§‹åŒ–
    updateMyStats();
    loadGlobalStats();
    
    function updateMyStats() {
      const hint = document.getElementById('pressHint');
      const stats = document.getElementById('myStats');
      if (myPressCount === 0) {
        hint.textContent = 'ä½ è¿˜æ²¡æŒ‰è¿‡è¿™ä¸ªæŒ‰é’®';
        stats.textContent = '';
      } else {
        hint.textContent = `ä½ å·²ç»æŒ‰äº† ${myPressCount} æ¬¡`;
        stats.textContent = myPressCount >= 10 ? 'ï¼ˆä½ æ˜¯è®¤çœŸçš„å—...ï¼‰' : '';
      }
    }
    
    async function loadGlobalStats() {
      try {
        // è·å–æŒ‰ä¸‹æ¬¡æ•°
        const pressRes = await fetch(`${API_BASE}/stats?action=get&key=doomsday-btn-press`);
        const pressData = await pressRes.json();
        const pressCount = pressData.data || 0;
        document.getElementById('totalPress').textContent = pressCount.toLocaleString();
        
        // è·å–ç”¨æˆ·æ•°
        const usersRes = await fetch(`${API_BASE}/stats?action=get&key=doomsday-btn-users`);
        const usersData = await usersRes.json();
        const usersCount = usersData.data || 0;
        document.getElementById('totalUsers').textContent = usersCount.toLocaleString();
        
        // è®¡ç®—æ¯ç­å¹´ä»½ï¼ˆæ¯1000æ¬¡å‡1å¹´ï¼Œçº¯æç¬‘ï¼‰
        const baseYear = 2525;
        const reduction = Math.floor(pressCount / 1000);
        document.getElementById('doomYear').textContent = Math.max(2030, baseYear - reduction);
      } catch (e) {
        console.log('Stats load failed:', e);
      }
    }
    
    async function recordPress() {
      try {
        // è®°å½•æŒ‰ä¸‹æ¬¡æ•°
        await fetch(`${API_BASE}/stats?action=incr&key=doomsday-btn-press`);
        
        // é¦–æ¬¡æŒ‰ä¸‹è®°å½•ç”¨æˆ·
        if (!hasEverPressed) {
          await fetch(`${API_BASE}/stats?action=incr&key=doomsday-btn-users`);
          hasEverPressed = true;
          localStorage.setItem('doomEverPressed', 'true');
        }
        
        // åˆ·æ–°ç»Ÿè®¡
        loadGlobalStats();
      } catch (e) {
        console.log('Record failed:', e);
      }
    }
    
    function pressButton() {
      if (isProcessing) return;
      isProcessing = true;
      
      const btn = document.getElementById('doomBtn');
      btn.classList.add('pressed');
      
      // æ›´æ–°æœ¬åœ°è®¡æ•°
      myPressCount++;
      localStorage.setItem('doomMyPress', myPressCount);
      updateMyStats();
      
      // è®°å½•åˆ°æœåŠ¡å™¨
      recordPress();
      
      // éšæœºå†³å®šæ˜¯å¦æ’­æ”¾ç‰¹æ•ˆ
      const playEffect = Math.random() > 0.7;
      
      if (playEffect && myPressCount <= 3) {
        // å‰å‡ æ¬¡æœ‰æ¦‚ç‡æ’­æ”¾å€’è®¡æ—¶ç‰¹æ•ˆ
        playCountdown(() => {
          showResult(getResult());
          isProcessing = false;
        });
      } else {
        setTimeout(() => {
          btn.classList.remove('pressed');
          showResult(getResult());
          isProcessing = false;
        }, 500);
      }
    }
    
    function getResult() {
      // æ£€æŸ¥ç‰¹æ®Šå½©è›‹
      if (specialResults[myPressCount]) {
        return specialResults[myPressCount];
      }
      // éšæœºå½©è›‹
      return results[Math.floor(Math.random() * results.length)];
    }
    
    function playCountdown(callback) {
      const countdown = document.getElementById('countdown');
      const flash = document.getElementById('screenFlash');
      let count = 3;
      
      countdown.style.display = 'block';
      countdown.textContent = count;
      
      const interval = setInterval(() => {
        count--;
        if (count > 0) {
          countdown.textContent = count;
          countdown.style.animation = 'none';
          countdown.offsetHeight; // è§¦å‘é‡ç»˜
          countdown.style.animation = 'countPulse 1s ease';
        } else {
          clearInterval(interval);
          countdown.style.display = 'none';
          flash.style.display = 'block';
          setTimeout(() => {
            flash.style.display = 'none';
            callback();
          }, 500);
        }
      }, 1000);
    }
    
    function showResult(result) {
      const modal = document.getElementById('resultModal');
      const content = document.getElementById('modalContent');
      
      // æ›¿æ¢åŠ¨æ€å†…å®¹
      let text = result.text;
      const totalUsers = document.getElementById('totalUsers').textContent;
      text = text.replace('<span id="otherUsers">???</span>', `<span style="color:#ffd700">${totalUsers}</span>`);
      
      content.className = 'modal-content result-' + result.type;
      content.innerHTML = `
        <div class="modal-icon">${result.icon}</div>
        <h2 class="modal-title">${result.title}</h2>
        <p class="modal-text">${text}</p>
        <button class="modal-btn" onclick="closeModal()">å¥½å§...</button>
        <p class="modal-sub">ä½ å·²æŒ‰ä¸‹ ${myPressCount} æ¬¡</p>
      `;
      
      modal.classList.add('show');
    }
    
    function closeModal() {
      document.getElementById('resultModal').classList.remove('show');
      document.getElementById('doomBtn').classList.remove('pressed');
    }
    
    document.getElementById('resultModal').addEventListener('click', function(e) {
      if (e.target === this) closeModal();
    });
    
    // ESCå…³é—­
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });
  </script>
</body>
</html>