<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›šå¾’å›°å¢ƒ - ä¸ºä»€ä¹ˆç†æ€§å¯¼è‡´åŒè¾“</title>
  <script src="../components/header.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      padding: 20px;
      color: #fff;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .back-link {
      display: inline-block;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      margin-bottom: 15px;
      font-size: 0.9rem;
    }
    .back-link:hover { text-decoration: underline; }
    h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1.8rem;
      background: linear-gradient(135deg, #ff6b6b, #4ade80);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle {
      text-align: center;
      color: rgba(255,255,255,0.7);
      margin-bottom: 25px;
      font-size: 0.95rem;
    }
    .card {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .question-box {
      background: linear-gradient(135deg, rgba(255,107,107,0.2), rgba(74,222,128,0.1));
      border-left: 4px solid #ff6b6b;
      padding: 15px 20px;
      border-radius: 0 12px 12px 0;
      margin-bottom: 20px;
      font-size: 1rem;
      line-height: 1.8;
    }
    .question-box strong { color: #ffd93d; }
    
    /* æ”¶ç›ŠçŸ©é˜µ */
    .matrix-container {
      overflow-x: auto;
      margin: 20px 0;
    }
    .payoff-matrix {
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
      border-collapse: collapse;
      font-size: 0.95rem;
    }
    .payoff-matrix th, .payoff-matrix td {
      padding: 15px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .payoff-matrix th {
      background: rgba(255,255,255,0.1);
      color: #ffd93d;
    }
    .payoff-matrix .corner {
      background: transparent;
      border: none;
    }
    .payoff-matrix .header-row th {
      background: rgba(74,222,128,0.2);
    }
    .payoff-matrix .header-col {
      background: rgba(255,107,107,0.2);
      color: #ff6b6b;
    }
    .payoff-matrix td {
      background: rgba(0,0,0,0.2);
    }
    .payoff-matrix .nash {
      background: rgba(255,107,107,0.3);
      border: 2px solid #ff6b6b;
    }
    .payoff-matrix .optimal {
      background: rgba(74,222,128,0.2);
    }
    .payoff {
      display: flex;
      justify-content: center;
      gap: 8px;
    }
    .payoff .a { color: #ff6b6b; }
    .payoff .b { color: #4ade80; }
    
    /* æ¸¸æˆåŒºåŸŸ */
    .game-area {
      text-align: center;
      padding: 20px 0;
    }
    .prisoners {
      display: flex;
      justify-content: center;
      gap: 60px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    .prisoner {
      text-align: center;
    }
    .prisoner-icon {
      font-size: 80px;
      margin-bottom: 10px;
      transition: transform 0.3s;
    }
    .prisoner.betrayed .prisoner-icon {
      filter: grayscale(1);
    }
    .prisoner-name {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .prisoner-name.you { color: #ff6b6b; }
    .prisoner-name.opponent { color: #4ade80; }
    .prisoner-sentence {
      font-size: 0.9rem;
      color: rgba(255,255,255,0.6);
    }
    
    /* é€‰æ‹©æŒ‰é’® */
    .choice-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    .choice-btn {
      padding: 20px 40px;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 160px;
    }
    .choice-btn.cooperate {
      background: linear-gradient(135deg, #4ade80, #22c55e);
      color: white;
    }
    .choice-btn.betray {
      background: linear-gradient(135deg, #ff6b6b, #ef4444);
      color: white;
    }
    .choice-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .choice-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    /* ç»“æœæ˜¾ç¤º */
    .result-display {
      display: none;
      margin: 30px 0;
      padding: 25px;
      background: rgba(0,0,0,0.3);
      border-radius: 16px;
    }
    .result-display.show { display: block; }
    .result-title {
      font-size: 1.5rem;
      margin-bottom: 15px;
    }
    .result-title.win { color: #4ade80; }
    .result-title.lose { color: #ff6b6b; }
    .result-title.draw { color: #ffd93d; }
    .result-detail {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .result-card {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
    }
    .result-card h4 {
      color: rgba(255,255,255,0.6);
      font-size: 0.85rem;
      margin-bottom: 8px;
    }
    .result-card .value {
      font-size: 1.8rem;
      font-weight: bold;
    }
    .result-card .value.you { color: #ff6b6b; }
    .result-card .value.opponent { color: #4ade80; }
    
    /* ç»Ÿè®¡ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    @media (max-width: 600px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }
    .stat-box {
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
    }
    .stat-box .label {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.5);
      margin-bottom: 5px;
    }
    .stat-box .value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #ffd93d;
    }
    
    /* ç­–ç•¥é€‰æ‹© */
    .strategy-section {
      margin: 20px 0;
    }
    .strategy-section h3 {
      color: #ffd93d;
      margin-bottom: 15px;
    }
    .strategy-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    @media (max-width: 500px) {
      .strategy-grid { grid-template-columns: 1fr; }
    }
    .strategy-option {
      background: rgba(255,255,255,0.05);
      border: 2px solid transparent;
      border-radius: 10px;
      padding: 12px 15px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
    }
    .strategy-option:hover {
      background: rgba(255,255,255,0.1);
    }
    .strategy-option.selected {
      border-color: #4ade80;
      background: rgba(74,222,128,0.1);
    }
    .strategy-option .name {
      font-weight: bold;
      margin-bottom: 4px;
    }
    .strategy-option .desc {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
    }
    
    /* æ¸¸æˆæŒ‰é’® */
    .game-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .game-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }
    .game-btn.primary {
      background: linear-gradient(135deg, #ffd93d, #f0c000);
      color: #333;
    }
    .game-btn.secondary {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .game-btn:hover {
      transform: translateY(-2px);
    }
    
    /* å›¾è¡¨ */
    .chart-container {
      position: relative;
      height: 250px;
      margin-top: 20px;
    }
    
    /* åˆ†æåŒº */
    .analysis {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 22px;
      margin-top: 20px;
    }
    .analysis h3 {
      color: #ffd93d;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .analysis p {
      color: rgba(255,255,255,0.85);
      line-height: 1.85;
      margin-bottom: 14px;
    }
    .analysis .highlight { color: #ff6b6b; font-weight: bold; }
    .analysis .safe { color: #4ade80; font-weight: bold; }
    .analysis .formula {
      background: rgba(255,255,255,0.08);
      padding: 12px 16px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      margin: 14px 0;
      overflow-x: auto;
    }
    
    /* ç»“è®º */
    .conclusion {
      background: linear-gradient(135deg, rgba(255,107,107,0.15), rgba(74,222,128,0.1));
      border: 2px solid #ffd93d;
      border-radius: 16px;
      padding: 25px;
      text-align: center;
      margin-top: 20px;
    }
    .conclusion h3 {
      font-size: 1.4rem;
      margin-bottom: 15px;
      color: #ffd93d;
    }
    .conclusion p {
      color: rgba(255,255,255,0.9);
      line-height: 1.85;
    }
    
    /* å†å²è®°å½• */
    .history-section {
      margin-top: 20px;
    }
    .history-section h4 {
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    .history-list {
      max-height: 200px;
      overflow-y: auto;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 10px;
    }
    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      font-size: 0.85rem;
    }
    .history-item:last-child { border-bottom: none; }
    .history-choices {
      display: flex;
      gap: 15px;
    }
    .history-choice {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    .history-choice.cooperate { background: rgba(74,222,128,0.3); color: #4ade80; }
    .history-choice.betray { background: rgba(255,107,107,0.3); color: #ff6b6b; }
    .history-result {
      font-weight: bold;
    }
    .history-result.win { color: #4ade80; }
    .history-result.lose { color: #ff6b6b; }
    .history-result.draw { color: #ffd93d; }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
    <h1>ğŸ”’ å›šå¾’å›°å¢ƒ</h1>
    <p class="subtitle">ä¸ºä»€ä¹ˆã€Œç†æ€§ã€çš„é€‰æ‹©ï¼Œåè€Œå¯¼è‡´åŒè¾“ï¼Ÿ</p>
    
    <div class="card">
      <div class="question-box">
        <strong>ç»å…¸åœºæ™¯ï¼š</strong>ä½ å’ŒåŒä¼™è¢«è­¦å¯ŸæŠ“äº†ï¼Œåˆ†å¼€å®¡è®¯ã€‚<br>
        å¦‚æœä½ ä»¬éƒ½<strong>æ²‰é»˜</strong>ï¼ˆåˆä½œï¼‰ï¼Œå„åˆ¤1å¹´ï¼›<br>
        å¦‚æœä½ <strong>æ­å‘</strong>å¯¹æ–¹è€Œä»–æ²‰é»˜ï¼Œä½ æ— ç½ªé‡Šæ”¾ï¼Œä»–åˆ¤10å¹´ï¼›<br>
        å¦‚æœä½ ä»¬éƒ½<strong>æ­å‘</strong>å¯¹æ–¹ï¼Œå„åˆ¤5å¹´ã€‚<br><br>
        <span style="color: #ffd93d;">é—®é¢˜ï¼šä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ</span>
      </div>
      
      <!-- æ”¶ç›ŠçŸ©é˜µ -->
      <div class="matrix-container">
        <table class="payoff-matrix">
          <tr>
            <th class="corner"></th>
            <th class="corner"></th>
            <th colspan="2" style="background: rgba(74,222,128,0.2); color: #4ade80;">å¯¹æ–¹çš„é€‰æ‹©</th>
          </tr>
          <tr class="header-row">
            <th class="corner"></th>
            <th class="corner"></th>
            <th>æ²‰é»˜ï¼ˆåˆä½œï¼‰</th>
            <th>æ­å‘ï¼ˆèƒŒå›ï¼‰</th>
          </tr>
          <tr>
            <th rowspan="2" class="header-col" style="writing-mode: vertical-lr; transform: rotate(180deg);">ä½ çš„é€‰æ‹©</th>
            <th class="header-col">æ²‰é»˜ï¼ˆåˆä½œï¼‰</th>
            <td class="optimal">
              <div class="payoff"><span class="a">-1å¹´</span> / <span class="b">-1å¹´</span></div>
              <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 5px;">åŒèµ¢</div>
            </td>
            <td>
              <div class="payoff"><span class="a">-10å¹´</span> / <span class="b">0å¹´</span></div>
              <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 5px;">ä½ è¢«å‘</div>
            </td>
          </tr>
          <tr>
            <th class="header-col">æ­å‘ï¼ˆèƒŒå›ï¼‰</th>
            <td>
              <div class="payoff"><span class="a">0å¹´</span> / <span class="b">-10å¹´</span></div>
              <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 5px;">ä½ å‘ä»–</div>
            </td>
            <td class="nash">
              <div class="payoff"><span class="a">-5å¹´</span> / <span class="b">-5å¹´</span></div>
              <div style="font-size: 0.75rem; color: #ff6b6b; margin-top: 5px;">çº³ä»€å‡è¡¡ âš ï¸</div>
            </td>
          </tr>
        </table>
      </div>
      <p style="text-align: center; color: rgba(255,255,255,0.5); font-size: 0.85rem;">
        <span style="color: #ff6b6b;">çº¢è‰²</span> = ä½ çš„åˆ‘æœŸ | <span style="color: #4ade80;">ç»¿è‰²</span> = å¯¹æ–¹åˆ‘æœŸ
      </p>
    </div>
    
    <!-- å•å±€æ¸¸æˆ -->
    <div class="card">
      <h2 style="margin-bottom: 20px; color: #ffd93d;">ğŸ® å•å±€åšå¼ˆï¼šä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ</h2>
      
      <div class="game-area">
        <div class="prisoners">
          <div class="prisoner" id="playerPrisoner">
            <div class="prisoner-icon">ğŸ‘¤</div>
            <div class="prisoner-name you">ä½ </div>
            <div class="prisoner-sentence" id="playerSentence">ç­‰å¾…é€‰æ‹©...</div>
          </div>
          <div class="prisoner" id="opponentPrisoner">
            <div class="prisoner-icon">ğŸ¤–</div>
            <div class="prisoner-name opponent">å¯¹æ–¹</div>
            <div class="prisoner-sentence" id="opponentSentence">ç­‰å¾…é€‰æ‹©...</div>
          </div>
        </div>
        
        <div class="choice-buttons">
          <button class="choice-btn cooperate" id="cooperateBtn" onclick="makeChoice('cooperate')">
            ğŸ¤ æ²‰é»˜ï¼ˆåˆä½œï¼‰
          </button>
          <button class="choice-btn betray" id="betrayBtn" onclick="makeChoice('betray')">
            ğŸ—£ï¸ æ­å‘ï¼ˆèƒŒå›ï¼‰
          </button>
        </div>
        
        <div class="result-display" id="resultDisplay">
          <div class="result-title" id="resultTitle">ç»“æœ</div>
          <div class="result-detail">
            <div class="result-card">
              <h4>ä½ çš„é€‰æ‹©</h4>
              <div class="value you" id="yourChoice">-</div>
            </div>
            <div class="result-card">
              <h4>å¯¹æ–¹é€‰æ‹©</h4>
              <div class="value opponent" id="opponentChoice">-</div>
            </div>
          </div>
          <p id="resultExplanation" style="text-align: center; color: rgba(255,255,255,0.7); margin-top: 15px;"></p>
        </div>
        
        <div class="game-buttons">
          <button class="game-btn secondary" onclick="resetSingleGame()">ğŸ”„ å†æ¥ä¸€å±€</button>
        </div>
      </div>
    </div>
    
    <!-- é‡å¤åšå¼ˆ -->
    <div class="card">
      <h2 style="margin-bottom: 15px; color: #ffd93d;">ğŸ”„ é‡å¤åšå¼ˆï¼šç­–ç•¥å¯¹å†³</h2>
      <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
        å¦‚æœè¿™ä¸ªæ¸¸æˆè¦ç©å¾ˆå¤šè½®å‘¢ï¼Ÿé€‰æ‹©ä¸€ä¸ªç­–ç•¥ï¼Œå’Œç”µè„‘å¯¹æˆ˜100è½®ï¼Œçœ‹çœ‹è°çš„æ€»åˆ‘æœŸæ›´çŸ­ã€‚
      </p>
      
      <div class="strategy-section">
        <h3>é€‰æ‹©ä½ çš„ç­–ç•¥</h3>
        <div class="strategy-grid">
          <div class="strategy-option selected" data-strategy="tit-for-tat" onclick="selectStrategy(this)">
            <div class="name">ğŸ‘ï¸ ä»¥ç‰™è¿˜ç‰™ (Tit for Tat)</div>
            <div class="desc">ç¬¬ä¸€è½®åˆä½œï¼Œä¹‹åæ¨¡ä»¿å¯¹æ–¹ä¸Šä¸€è½®çš„é€‰æ‹©</div>
          </div>
          <div class="strategy-option" data-strategy="always-cooperate" onclick="selectStrategy(this)">
            <div class="name">ğŸ˜‡ æ°¸è¿œåˆä½œ</div>
            <div class="desc">æ— è®ºå¯¹æ–¹æ€ä¹ˆé€‰ï¼Œæˆ‘éƒ½é€‰æ‹©åˆä½œ</div>
          </div>
          <div class="strategy-option" data-strategy="always-betray" onclick="selectStrategy(this)">
            <div class="name">ğŸ˜ˆ æ°¸è¿œèƒŒå›</div>
            <div class="desc">æ— è®ºå¯¹æ–¹æ€ä¹ˆé€‰ï¼Œæˆ‘éƒ½é€‰æ‹©èƒŒå›</div>
          </div>
          <div class="strategy-option" data-strategy="random" onclick="selectStrategy(this)">
            <div class="name">ğŸ² éšæœºé€‰æ‹©</div>
            <div class="desc">50%æ¦‚ç‡åˆä½œï¼Œ50%æ¦‚ç‡èƒŒå›</div>
          </div>
          <div class="strategy-option" data-strategy="grudger" onclick="selectStrategy(this)">
            <div class="name">ğŸ˜¤ è®°ä»‡è€…</div>
            <div class="desc">ä¸€å¼€å§‹åˆä½œï¼Œä¸€æ—¦è¢«èƒŒå›å°±æ°¸è¿œèƒŒå›</div>
          </div>
          <div class="strategy-option" data-strategy="pavlov" onclick="selectStrategy(this)">
            <div class="name">ğŸ• å·´ç”«æ´›å¤«</div>
            <div class="desc">ä¸Šè½®ç»“æœå¥½å°±é‡å¤ï¼Œç»“æœå·®å°±æ”¹å˜</div>
          </div>
        </div>
      </div>
      
      <div class="strategy-section">
        <h3>å¯¹æ‰‹ç­–ç•¥</h3>
        <div class="strategy-grid">
          <div class="strategy-option selected" data-opponent="tit-for-tat" onclick="selectOpponent(this)">
            <div class="name">ğŸ‘ï¸ ä»¥ç‰™è¿˜ç‰™</div>
            <div class="desc">ç»å…¸ç­–ç•¥</div>
          </div>
          <div class="strategy-option" data-opponent="always-betray" onclick="selectOpponent(this)">
            <div class="name">ğŸ˜ˆ æ°¸è¿œèƒŒå›</div>
            <div class="desc">æœ€è‡ªç§çš„å¯¹æ‰‹</div>
          </div>
          <div class="strategy-option" data-opponent="random" onclick="selectOpponent(this)">
            <div class="name">ğŸ² éšæœºé€‰æ‹©</div>
            <div class="desc">ä¸å¯é¢„æµ‹</div>
          </div>
          <div class="strategy-option" data-opponent="grudger" onclick="selectOpponent(this)">
            <div class="name">ğŸ˜¤ è®°ä»‡è€…</div>
            <div class="desc">åˆ«æƒ¹ä»–</div>
          </div>
        </div>
      </div>
      
      <div class="game-buttons">
        <button class="game-btn primary" onclick="runTournament()">ğŸš€ å¼€å§‹100è½®å¯¹å†³</button>
        <button class="game-btn secondary" onclick="resetTournament()">ğŸ”„ é‡ç½®</button>
      </div>
      
      <div class="stats-grid" id="tournamentStats" style="display: none;">
        <div class="stat-box">
          <div class="label">ä½ çš„æ€»åˆ‘æœŸ</div>
          <div class="value" id="yourTotal">0</div>
        </div>
        <div class="stat-box">
          <div class="label">å¯¹æ–¹æ€»åˆ‘æœŸ</div>
          <div class="value" id="opponentTotal">0</div>
        </div>
        <div class="stat-box">
          <div class="label">ä½ çš„åˆä½œç‡</div>
          <div class="value" id="yourCoopRate">0%</div>
        </div>
        <div class="stat-box">
          <div class="label">å¯¹æ–¹åˆä½œç‡</div>
          <div class="value" id="opponentCoopRate">0%</div>
        </div>
      </div>
      
      <div class="chart-container" id="chartContainer" style="display: none;">
        <canvas id="tournamentChart"></canvas>
      </div>
      
      <div class="history-section" id="historySection" style="display: none;">
        <h4>ğŸ“œ å¯¹å±€è®°å½•ï¼ˆæœ€è¿‘20è½®ï¼‰</h4>
        <div class="history-list" id="historyList"></div>
      </div>
    </div>

    <!-- æ•°å­¦åˆ†æ -->
    <div class="card analysis">
      <h3>ğŸ“ ä¸ºä»€ä¹ˆã€Œç†æ€§ã€å¯¼è‡´åŒè¾“ï¼Ÿ</h3>
      
      <p><strong>1. å ä¼˜ç­–ç•¥åˆ†æ</strong></p>
      <p>
        ä¸ç®¡å¯¹æ–¹æ€ä¹ˆé€‰ï¼Œã€ŒèƒŒå›ã€å¯¹ä½ æ¥è¯´éƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š
      </p>
      <div class="formula">
        å¦‚æœå¯¹æ–¹åˆä½œï¼šèƒŒå›å¾—0å¹´ > åˆä½œå¾—1å¹´<br>
        å¦‚æœå¯¹æ–¹èƒŒå›ï¼šèƒŒå›å¾—5å¹´ > åˆä½œå¾—10å¹´
      </div>
      <p>
        æ‰€ä»¥ã€ŒèƒŒå›ã€æ˜¯ä½ çš„<span class="highlight">å ä¼˜ç­–ç•¥</span>ã€‚<br>
        é—®é¢˜æ˜¯ï¼šå¯¹æ–¹ä¹Ÿä¼šè¿™ä¹ˆæƒ³ã€‚äºæ˜¯ä½ ä»¬éƒ½é€‰æ‹©èƒŒå›ï¼Œå„åˆ¤5å¹´ã€‚
      </p>
      
      <p><strong>2. çº³ä»€å‡è¡¡ â‰  æœ€ä¼˜è§£</strong></p>
      <p>
        ã€ŒåŒæ–¹éƒ½èƒŒå›ã€æ˜¯<span class="highlight">çº³ä»€å‡è¡¡</span>â€”â€”æ²¡æœ‰äººèƒ½é€šè¿‡å•æ–¹é¢æ”¹å˜ç­–ç•¥è·ç›Šã€‚<br>
        ä½†è¿™ä¸æ˜¯<span class="safe">å¸•ç´¯æ‰˜æœ€ä¼˜</span>â€”â€”æ˜æ˜åŒæ–¹éƒ½åˆä½œåªéœ€å„åˆ¤1å¹´ã€‚
      </p>
      <p>
        è¿™å°±æ˜¯å›šå¾’å›°å¢ƒçš„æ ¸å¿ƒçŸ›ç›¾ï¼š<br>
        <span class="highlight">ä¸ªä½“ç†æ€§ â†’ é›†ä½“éç†æ€§</span>
      </p>
      
      <p><strong>3. é‡å¤åšå¼ˆæ”¹å˜ä¸€åˆ‡</strong></p>
      <p>
        å¦‚æœåªç©ä¸€æ¬¡ï¼ŒèƒŒå›æ˜¯ç†æ€§é€‰æ‹©ã€‚<br>
        ä½†å¦‚æœè¦ç©å¾ˆå¤šæ¬¡ï¼Œæƒ…å†µå°±ä¸åŒäº†â€”â€”ä½ çš„é€‰æ‹©ä¼šå½±å“å¯¹æ–¹æœªæ¥çš„è¡Œä¸ºã€‚
      </p>
      <p>
        1984å¹´ï¼Œæ”¿æ²»å­¦å®¶ Robert Axelrod ä¸¾åŠäº†ä¸€åœºè®¡ç®—æœºé”¦æ ‡èµ›ï¼Œ<br>
        è®©å„ç§ç­–ç•¥äº’ç›¸å¯¹æˆ˜ã€‚ç»“æœæœ€ç®€å•çš„ç­–ç•¥ã€Œä»¥ç‰™è¿˜ç‰™ã€èµ¢äº†ï¼š
      </p>
      <div class="formula">
        ä»¥ç‰™è¿˜ç‰™ (Tit for Tat)ï¼š<br>
        ç¬¬ä¸€è½®åˆä½œï¼Œä¹‹åæ¨¡ä»¿å¯¹æ–¹ä¸Šä¸€è½®çš„é€‰æ‹©
      </div>
      <p>
        è¿™ä¸ªç­–ç•¥æœ‰å››ä¸ªç‰¹ç‚¹ï¼š<span class="safe">å–„è‰¯</span>ï¼ˆå…ˆåˆä½œï¼‰ã€<span class="safe">å¯æ¿€æ€’</span>ï¼ˆè¢«èƒŒå›å°±æŠ¥å¤ï¼‰ã€<span class="safe">å®½å®¹</span>ï¼ˆå¯¹æ–¹æ”¹è¿‡å°±åŸè°…ï¼‰ã€<span class="safe">ç®€å•</span>ï¼ˆå¯¹æ–¹èƒ½ç†è§£ä½ çš„é€»è¾‘ï¼‰ã€‚
      </p>
    </div>
    
    <!-- ç°å®æ¡ˆä¾‹ -->
    <div class="card analysis">
      <h3>ğŸŒ ç°å®ä¸­çš„å›šå¾’å›°å¢ƒ</h3>
      
      <p><strong>1. å†›å¤‡ç«èµ›</strong></p>
      <p>
        ä¸¤ä¸ªå›½å®¶éƒ½çŸ¥é“è£å†›å¯¹åŒæ–¹éƒ½å¥½ï¼ˆçœé’±ã€æ›´å®‰å…¨ï¼‰ã€‚<br>
        ä½†æ¯ä¸ªå›½å®¶éƒ½æ‹…å¿ƒï¼šå¦‚æœæˆ‘è£å†›ï¼Œå¯¹æ–¹ä¸è£ï¼Œæˆ‘å°±å±é™©äº†ã€‚<br>
        ç»“æœï¼šåŒæ–¹éƒ½ç–¯ç‹‚æ‰©å†›ï¼Œé™·å…¥<span class="highlight">å®‰å…¨å›°å¢ƒ</span>ã€‚
      </p>
      
      <p><strong>2. ä»·æ ¼æˆ˜</strong></p>
      <p>
        ä¸¤å®¶å…¬å¸éƒ½çŸ¥é“ç»´æŒé«˜ä»·å¯¹åŒæ–¹éƒ½æœ‰åˆ©ã€‚<br>
        ä½†æ¯å®¶éƒ½æƒ³ï¼šå¦‚æœæˆ‘é™ä»·æŠ¢å¸‚åœºï¼Œå¯¹æ–¹ä¸é™ï¼Œæˆ‘å°±èµ¢äº†ã€‚<br>
        ç»“æœï¼šåŒæ–¹éƒ½é™ä»·ï¼Œåˆ©æ¶¦éƒ½ä¸‹é™ã€‚
      </p>
      
      <p><strong>3. å…¬åœ°æ‚²å‰§</strong></p>
      <p>
        æ¯ä¸ªç‰§æ°‘éƒ½çŸ¥é“è¿‡åº¦æ”¾ç‰§ä¼šæ¯æ‰è‰åœ°ã€‚<br>
        ä½†æ¯ä¸ªäººéƒ½æƒ³ï¼šå¦‚æœæˆ‘ä¸å¤šæ”¾ï¼Œåˆ«äººå¤šæ”¾ï¼Œæˆ‘å°±äºäº†ã€‚<br>
        ç»“æœï¼šè‰åœ°è¢«æ¯ï¼Œæ‰€æœ‰äººéƒ½å—æŸã€‚
      </p>
      
      <p><strong>4. æ°”å€™å˜åŒ–</strong></p>
      <p>
        æ¯ä¸ªå›½å®¶éƒ½çŸ¥é“å‡æ’å¯¹å…¨çƒæœ‰åˆ©ã€‚<br>
        ä½†æ¯ä¸ªå›½å®¶éƒ½æƒ³ï¼šå¦‚æœæˆ‘å‡æ’ï¼Œåˆ«äººä¸å‡ï¼Œæˆ‘å°±åƒäºäº†ã€‚<br>
        ç»“æœï¼šå…¨çƒå˜æš–åŠ å‰§ã€‚
      </p>
    </div>
    
    <!-- ç»“è®º -->
    <div class="card conclusion">
      <h3>ğŸ’¡ å›šå¾’å›°å¢ƒçš„å¯ç¤º</h3>
      <p>
        å›šå¾’å›°å¢ƒæ­ç¤ºäº†ä¸€ä¸ªæ®‹é…·çš„çœŸç›¸ï¼š<br>
        <span style="color: #ff6b6b;">ä¸ªä½“çš„ã€Œç†æ€§ã€é€‰æ‹©ï¼Œå¯èƒ½å¯¼è‡´é›†ä½“çš„ã€Œéç†æ€§ã€ç»“æœã€‚</span><br><br>
        
        ä½†å®ƒä¹Ÿå‘Šè¯‰æˆ‘ä»¬è§£å†³ä¹‹é“ï¼š<br>
        <span style="color: #4ade80;">å»ºç«‹ä¿¡ä»»ã€é‡å¤åšå¼ˆã€åˆ¶åº¦çº¦æŸã€‚</span><br><br>
        
        å½“åšå¼ˆä»ã€Œä¸€æ¬¡æ€§ã€å˜æˆã€Œé‡å¤ã€ï¼Œ<br>
        å½“ã€ŒèƒŒå›ã€ä¼šè¢«è®°ä½å’Œæƒ©ç½šï¼Œ<br>
        åˆä½œå°±å˜å¾—å¯èƒ½ã€‚<br><br>
        
        <span style="color: #ffd93d;">
          è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¤¾ä¼šéœ€è¦æ³•å¾‹ã€å¥‘çº¦ã€å£°èª‰ç³»ç»Ÿâ€”â€”<br>
          å®ƒä»¬æŠŠã€Œä¸€æ¬¡æ€§åšå¼ˆã€å˜æˆã€Œé‡å¤åšå¼ˆã€ï¼Œè®©åˆä½œæˆä¸ºç†æ€§é€‰æ‹©ã€‚
        </span>
      </p>
    </div>
  </div>

  <script>
    // æ”¶ç›ŠçŸ©é˜µï¼š[ä½ çš„åˆ‘æœŸ, å¯¹æ–¹åˆ‘æœŸ]
    const PAYOFFS = {
      'cooperate-cooperate': [-1, -1],
      'cooperate-betray': [-10, 0],
      'betray-cooperate': [0, -10],
      'betray-betray': [-5, -5]
    };
    
    let selectedStrategy = 'tit-for-tat';
    let selectedOpponent = 'tit-for-tat';
    let tournamentChart = null;
    
    // å•å±€æ¸¸æˆ
    function makeChoice(choice) {
      const opponentChoice = Math.random() < 0.5 ? 'cooperate' : 'betray';
      const key = `${choice}-${opponentChoice}`;
      const [yourPenalty, opponentPenalty] = PAYOFFS[key];
      
      // ç¦ç”¨æŒ‰é’®
      document.getElementById('cooperateBtn').disabled = true;
      document.getElementById('betrayBtn').disabled = true;
      
      // æ›´æ–°æ˜¾ç¤º
      document.getElementById('playerSentence').textContent = `${yourPenalty}å¹´`;
      document.getElementById('opponentSentence').textContent = `${opponentPenalty}å¹´`;
      
      // æ˜¾ç¤ºç»“æœ
      const resultDisplay = document.getElementById('resultDisplay');
      const resultTitle = document.getElementById('resultTitle');
      
      document.getElementById('yourChoice').textContent = choice === 'cooperate' ? 'æ²‰é»˜' : 'æ­å‘';
      document.getElementById('opponentChoice').textContent = opponentChoice === 'cooperate' ? 'æ²‰é»˜' : 'æ­å‘';
      
      let explanation = '';
      if (choice === 'cooperate' && opponentChoice === 'cooperate') {
        resultTitle.textContent = 'ğŸ¤ åŒèµ¢ï¼';
        resultTitle.className = 'result-title win';
        explanation = 'ä½ ä»¬éƒ½é€‰æ‹©äº†ä¿¡ä»»å¯¹æ–¹ï¼Œå„åˆ¤1å¹´ã€‚è¿™æ˜¯æœ€å¥½çš„é›†ä½“ç»“æœã€‚';
      } else if (choice === 'betray' && opponentChoice === 'betray') {
        resultTitle.textContent = 'ğŸ’€ åŒè¾“ï¼';
        resultTitle.className = 'result-title lose';
        explanation = 'ä½ ä»¬éƒ½é€‰æ‹©äº†èƒŒå›ï¼Œå„åˆ¤5å¹´ã€‚è¿™å°±æ˜¯ã€Œçº³ä»€å‡è¡¡ã€çš„é™·é˜±ã€‚';
      } else if (choice === 'cooperate') {
        resultTitle.textContent = 'ğŸ˜¢ ä½ è¢«å‘äº†';
        resultTitle.className = 'result-title lose';
        explanation = 'ä½ é€‰æ‹©ä¿¡ä»»ï¼Œå¯¹æ–¹å´èƒŒå›äº†ä½ ã€‚ä½ åˆ¤10å¹´ï¼Œå¯¹æ–¹æ— ç½ªé‡Šæ”¾ã€‚';
      } else {
        resultTitle.textContent = 'ğŸ˜ˆ ä½ èµ¢äº†';
        resultTitle.className = 'result-title win';
        explanation = 'ä½ èƒŒå›äº†ä¿¡ä»»ä½ çš„äººã€‚ä½ æ— ç½ªé‡Šæ”¾ï¼Œå¯¹æ–¹åˆ¤10å¹´ã€‚ä½†è¿™çœŸçš„æ˜¯ã€Œèµ¢ã€å—ï¼Ÿ';
      }
      
      document.getElementById('resultExplanation').textContent = explanation;
      resultDisplay.classList.add('show');
    }
    
    function resetSingleGame() {
      document.getElementById('cooperateBtn').disabled = false;
      document.getElementById('betrayBtn').disabled = false;
      document.getElementById('playerSentence').textContent = 'ç­‰å¾…é€‰æ‹©...';
      document.getElementById('opponentSentence').textContent = 'ç­‰å¾…é€‰æ‹©...';
      document.getElementById('resultDisplay').classList.remove('show');
    }
    
    // ç­–ç•¥é€‰æ‹©
    function selectStrategy(el) {
      document.querySelectorAll('.strategy-option[data-strategy]').forEach(opt => {
        opt.classList.remove('selected');
      });
      el.classList.add('selected');
      selectedStrategy = el.dataset.strategy;
    }
    
    function selectOpponent(el) {
      document.querySelectorAll('.strategy-option[data-opponent]').forEach(opt => {
        opt.classList.remove('selected');
      });
      el.classList.add('selected');
      selectedOpponent = el.dataset.opponent;
    }
    
    // ç­–ç•¥å®ç°
    function getStrategyChoice(strategy, history, isPlayer) {
      const myHistory = isPlayer ? history.map(h => h.player) : history.map(h => h.opponent);
      const theirHistory = isPlayer ? history.map(h => h.opponent) : history.map(h => h.player);
      
      switch (strategy) {
        case 'always-cooperate':
          return 'cooperate';
        case 'always-betray':
          return 'betray';
        case 'random':
          return Math.random() < 0.5 ? 'cooperate' : 'betray';
        case 'tit-for-tat':
          if (theirHistory.length === 0) return 'cooperate';
          return theirHistory[theirHistory.length - 1];
        case 'grudger':
          if (theirHistory.includes('betray')) return 'betray';
          return 'cooperate';
        case 'pavlov':
          if (history.length === 0) return 'cooperate';
          const lastRound = history[history.length - 1];
          const myLast = isPlayer ? lastRound.player : lastRound.opponent;
          const theirLast = isPlayer ? lastRound.opponent : lastRound.player;
          // å¦‚æœä¸Šè½®ç»“æœå¥½ï¼ˆåŒæ–¹åˆä½œæˆ–æˆ‘èƒŒå›ä»–åˆä½œï¼‰ï¼Œé‡å¤ï¼›å¦åˆ™æ”¹å˜
          if ((myLast === 'cooperate' && theirLast === 'cooperate') || 
              (myLast === 'betray' && theirLast === 'cooperate')) {
            return myLast;
          }
          return myLast === 'cooperate' ? 'betray' : 'cooperate';
        default:
          return 'cooperate';
      }
    }
    
    // è¿è¡Œé”¦æ ‡èµ›
    function runTournament() {
      const rounds = 100;
      const history = [];
      let yourTotal = 0;
      let opponentTotal = 0;
      let yourCoops = 0;
      let opponentCoops = 0;
      
      const yourScores = [0];
      const opponentScores = [0];
      
      for (let i = 0; i < rounds; i++) {
        const yourChoice = getStrategyChoice(selectedStrategy, history, true);
        const opponentChoice = getStrategyChoice(selectedOpponent, history, false);
        
        const key = `${yourChoice}-${opponentChoice}`;
        const [yourPenalty, opponentPenalty] = PAYOFFS[key];
        
        yourTotal += yourPenalty;
        opponentTotal += opponentPenalty;
        
        if (yourChoice === 'cooperate') yourCoops++;
        if (opponentChoice === 'cooperate') opponentCoops++;
        
        history.push({ player: yourChoice, opponent: opponentChoice, yourPenalty, opponentPenalty });
        
        yourScores.push(yourTotal);
        opponentScores.push(opponentTotal);
      }
      
      // æ˜¾ç¤ºç»Ÿè®¡
      document.getElementById('tournamentStats').style.display = 'grid';
      document.getElementById('yourTotal').textContent = yourTotal + 'å¹´';
      document.getElementById('opponentTotal').textContent = opponentTotal + 'å¹´';
      document.getElementById('yourCoopRate').textContent = (yourCoops / rounds * 100).toFixed(0) + '%';
      document.getElementById('opponentCoopRate').textContent = (opponentCoops / rounds * 100).toFixed(0) + '%';
      
      // æ˜¾ç¤ºå›¾è¡¨
      document.getElementById('chartContainer').style.display = 'block';
      renderChart(yourScores, opponentScores);
      
      // æ˜¾ç¤ºå†å²
      document.getElementById('historySection').style.display = 'block';
      renderHistory(history.slice(-20).reverse());
    }
    
    function renderChart(yourScores, opponentScores) {
      const ctx = document.getElementById('tournamentChart').getContext('2d');
      
      if (tournamentChart) {
        tournamentChart.destroy();
      }
      
      tournamentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: Array.from({ length: yourScores.length }, (_, i) => i),
          datasets: [
            {
              label: 'ä½ çš„ç´¯è®¡åˆ‘æœŸ',
              data: yourScores,
              borderColor: '#ff6b6b',
              backgroundColor: 'rgba(255, 107, 107, 0.1)',
              fill: true,
              tension: 0.1
            },
            {
              label: 'å¯¹æ–¹ç´¯è®¡åˆ‘æœŸ',
              data: opponentScores,
              borderColor: '#4ade80',
              backgroundColor: 'rgba(74, 222, 128, 0.1)',
              fill: true,
              tension: 0.1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: { color: 'rgba(255,255,255,0.8)' }
            }
          },
          scales: {
            x: {
              title: { display: true, text: 'è½®æ¬¡', color: 'rgba(255,255,255,0.6)' },
              ticks: { color: 'rgba(255,255,255,0.6)' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            },
            y: {
              title: { display: true, text: 'ç´¯è®¡åˆ‘æœŸï¼ˆå¹´ï¼‰', color: 'rgba(255,255,255,0.6)' },
              ticks: { color: 'rgba(255,255,255,0.6)' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            }
          }
        }
      });
    }
    
    function renderHistory(history) {
      const container = document.getElementById('historyList');
      container.innerHTML = history.map((h, i) => {
        const round = history.length - i;
        let resultClass = 'draw';
        let resultText = 'å¹³';
        if (h.yourPenalty > h.opponentPenalty) {
          resultClass = 'lose';
          resultText = 'è¾“';
        } else if (h.yourPenalty < h.opponentPenalty) {
          resultClass = 'win';
          resultText = 'èµ¢';
        }
        
        return `
          <div class="history-item">
            <span>ç¬¬${round}è½®</span>
            <div class="history-choices">
              <span class="history-choice ${h.player}">ä½ : ${h.player === 'cooperate' ? 'åˆä½œ' : 'èƒŒå›'}</span>
              <span class="history-choice ${h.opponent}">å¯¹æ–¹: ${h.opponent === 'cooperate' ? 'åˆä½œ' : 'èƒŒå›'}</span>
            </div>
            <span class="history-result ${resultClass}">${h.yourPenalty}/${h.opponentPenalty}</span>
          </div>
        `;
      }).join('');
    }
    
    function resetTournament() {
      document.getElementById('tournamentStats').style.display = 'none';
      document.getElementById('chartContainer').style.display = 'none';
      document.getElementById('historySection').style.display = 'none';
      if (tournamentChart) {
        tournamentChart.destroy();
        tournamentChart = null;
      }
    }
  </script>
</body>
</html>
